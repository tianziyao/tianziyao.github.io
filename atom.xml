<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>iSTian&#39;notes</title>
  <subtitle>Quick notes</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-01-24T15:25:46.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>iSTian</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>iOSå¼€å‘ - åˆ©ç”¨Runtimeä¼˜åŒ–å½’è§£æ¡£ </title>
    <link href="http://yoursite.com/2017/01/24/iOS%E5%BC%80%E5%8F%91%20-%20%E5%88%A9%E7%94%A8Runtime%E4%BC%98%E5%8C%96%E5%BD%92%E8%A7%A3%E6%A1%A3%20/"/>
    <id>http://yoursite.com/2017/01/24/iOSå¼€å‘ - åˆ©ç”¨Runtimeä¼˜åŒ–å½’è§£æ¡£ /</id>
    <published>2017-01-23T20:43:00.000Z</published>
    <updated>2017-01-24T15:25:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>Runtime æ˜¯ iOS å¼€å‘ä¸­çš„çŸ¥åé»‘é­”æ³•ï¼Œå……åˆ†ä½“ç°äº† Objective - C çš„åŠ¨æ€è¿è¡Œæ—¶ç‰¹æ€§ï¼ŒSwift æ˜¯ä¸€é—¨é™æ€è¯­è¨€ï¼Œè¿™æ„å‘³ç€ä»£ç ç¼–è¯‘æ—¶å³ç¡®å®šäº†å…¶å®é™…è°ƒç”¨çš„æ–¹æ³•å’Œç±»å‹ï¼Œæ‰€ä»¥çº¯ç²¹çš„ Swift ç±»å’Œå¯¹è±¡æ²¡æœ‰åŠæ³•ä½¿ç”¨ Runtimeï¼Œæ›´ä¸å­˜åœ¨ Method swizzlingï¼Œä½†æ˜¯å‘¢ï¼ŒSwift æ˜¯å…¼å®¹ Objective - C çš„ï¼Œç»§æ‰¿è‡ª NSObject çš„ç±»ï¼Œä¹Ÿå°±å…·æœ‰äº†è¿è¡Œæ—¶çš„æ¶ˆæ¯æœºåˆ¶ã€‚</p>
<p>çº¯ç²¹çš„ Swift ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ  <code>@objc</code> ä¿®é¥°ç¬¦ï¼Œ <code>@objc</code> å…³é”®å­—åªéœ€è¦å¯¹é‚£äº›ä¸æ˜¯ç»§æ‰¿è‡ª <code>NSObject</code> çš„ç±»å‹è¿›è¡Œï¼Œå¦‚æœ class æ˜¯ç»§æ‰¿è‡ª <code>NSObject</code> çš„è¯ï¼ŒSwift ä¼šé»˜è®¤è‡ªåŠ¨ä¸ºæ‰€æœ‰çš„é private çš„ç±»å’Œæˆå‘˜åŠ ä¸Š <code>@objc</code>ã€‚</p>
<p> <code>@objc</code> ä¿®é¥°ç¬¦ä¸»è¦ç”¨äºéœ€è¦æš´éœ²ç»™ Objective-C ä½¿ç”¨çš„ä»»ä½•åœ°æ–¹ (åŒ…æ‹¬ç±»ï¼Œå±æ€§å’Œæ–¹æ³•ç­‰) ï¼Œä»¥æ”¯æŒå…¶åŠ¨æ€æ´¾å‘å’Œè¿è¡Œæ—¶æœºåˆ¶ã€‚</p>
<p>æ·»åŠ  <code>@objc</code> ä¿®é¥°ç¬¦å¹¶ä¸æ„å‘³ç€è¿™ä¸ªæ–¹æ³•æˆ–è€…å±æ€§ä¼šå˜æˆåŠ¨æ€æ´¾å‘ï¼ŒSwift ä¾ç„¶å¯èƒ½ä¼šå°†å…¶ä¼˜åŒ–ä¸ºé™æ€è°ƒç”¨ã€‚å¦‚æœéœ€è¦æ–½å±•ä¸€äº›åƒ Method swizzling æˆ–è€…è¿è¡Œæ—¶å†å†³å®šå®ç°è¿™æ ·çš„ â€œé»‘é­”æ³•â€ çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç”¨åˆ° <code>dynamic</code> ä¿®é¥°ç¬¦äº†ã€‚ <code>dynamic</code> ä¿®é¥°ç¬¦ä¼šéšå¼çš„æ·»åŠ  <code>@objc</code> è¿›è¡Œä¿®é¥°ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦ Swift å’Œ Objective æ··åˆå¼€å‘æ—¶ï¼Œä½¿ç”¨ <code>@objc</code> å°±å¯ä»¥äº†ï¼Œéœ€è¦ Swift å®Œå…¨å®ç°è¿è¡Œæ—¶æœºåˆ¶æ—¶ï¼Œé‚£ä¹ˆå¿…é¡»è¦æ·»åŠ  <code>dynamic</code> ä¿®é¥°ç¬¦ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¼˜åŒ–å½’è§£æ¡£ï¼Œæ¥äº†è§£ Runtime åœ¨ Swift ä¸­çš„åº”ç”¨ï¼š</p>
<a id="more"></a>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span>, <span class="title">NSCoding</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> name = <span class="string">""</span></div><div class="line">    <span class="keyword">var</span> age = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, age: <span class="type">Int</span>) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.name = name</div><div class="line">        <span class="keyword">self</span>.age = age</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(with aCoder: NSCoder)</span></span> &#123;</div><div class="line">        </div><div class="line">        <span class="comment">//å±æ€§çš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="comment">//è·å–å±æ€§åˆ—è¡¨ï¼Œinoutå±æ€§çš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;<span class="built_in">count</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; <span class="built_in">count</span> &#123;</div><div class="line">            <span class="comment">//å–å‡ºå±æ€§</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="comment">//è·å–å±æ€§å</span></div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(utf8String: ivar_getName(ivar))</div><div class="line">                <span class="comment">//ä½¿ç”¨KVCè·å–å±æ€§å€¼ï¼Œå¹¶å½’æ¡£</span></div><div class="line">                aCoder.encode(<span class="keyword">self</span>.value(forKey: key!), forKey: key!)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//é‡Šæ”¾ivars</span></div><div class="line">        free(ivars)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">        </div><div class="line">        <span class="comment">//å±æ€§çš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="comment">//è·å–å±æ€§åˆ—è¡¨ï¼Œinoutå±æ€§çš„ä¸ªæ•°</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;<span class="built_in">count</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; <span class="built_in">count</span> &#123;</div><div class="line">            <span class="comment">//å–å‡ºå±æ€§</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="comment">//è·å–å±æ€§å</span></div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(utf8String: ivar_getName(ivar))</div><div class="line">                <span class="comment">//è§£æ¡£</span></div><div class="line">                <span class="keyword">let</span> value = aDecoder.decodeObject(forKey: key!)</div><div class="line">                <span class="comment">//ä½¿ç”¨KVCä¼ å€¼</span></div><div class="line">                <span class="keyword">self</span>.setValue(value, forKey: key!)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//é‡Šæ”¾ivars</span></div><div class="line">        free(ivars)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬ä½¿ç”¨å½’è§£æ¡£ï¼Œå±æ€§å¾ˆå¤šæˆ–è€…ç»“æ„å¾ˆå¤æ‚æ—¶ï¼Œä¼šäº§ç”Ÿå¾ˆå¤šçš„é‡å¤ä»£ç ï¼Œè¿™æ—¶å°±å¯ä»¥é€šè¿‡ Runtime æ¥è·å–ç±»çš„å±æ€§åˆ—è¡¨ï¼Œå±æ€§åï¼Œå±æ€§æ•°é‡ç­‰ï¼Œå†é€šè¿‡ KVC å®Œæˆå–å€¼å’Œèµ‹å€¼ï¼Œå¤§å¤§ç®€åŒ–äº†è¿™ä¸€æ­¥éª¤ã€‚</p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">save</span><span class="params">(<span class="number">_</span> sender: AnyObject)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> <span class="built_in">max</span> = <span class="type">Person</span>(name: <span class="string">"Max"</span>, age: <span class="number">100</span>)</div><div class="line">    <span class="keyword">let</span> <span class="built_in">min</span> = <span class="type">Person</span>(name: <span class="string">"Min"</span>, age: <span class="number">0</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> result = <span class="type">NSKeyedArchiver</span>.archiveRootObject([<span class="built_in">max</span>, <span class="built_in">min</span>], toFile: filePath!)</div><div class="line">    <span class="built_in">print</span>(<span class="string">"result:"</span>, result, <span class="string">"filePath:"</span>, filePath)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">read</span><span class="params">(<span class="number">_</span> sender: AnyObject)</span></span> &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> arr = <span class="type">NSKeyedUnarchiver</span>.unarchiveObject(withFile: filePath!) <span class="keyword">as</span>! [<span class="type">Person</span>]</div><div class="line">    <span class="keyword">let</span> <span class="built_in">max</span> = arr.first</div><div class="line">    <span class="keyword">let</span> <span class="built_in">min</span> = arr.last</div><div class="line">    </div><div class="line">    <span class="built_in">print</span>(<span class="built_in">max</span>?.name, <span class="built_in">min</span>?.name)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Runtime è¿˜æœ‰å¾ˆå¤šå¼ºå¤§çš„æ–¹æ³•ï¼Œä¸ä»…ä»…æ˜¯é’ˆå¯¹ Classï¼Œè¿˜æœ‰ Methodã€SELã€Protocolç­‰ï¼Œæˆ‘ä»¬ä»¥åå†è®²ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Runtime æ˜¯ iOS å¼€å‘ä¸­çš„çŸ¥åé»‘é­”æ³•ï¼Œå……åˆ†ä½“ç°äº† Objective - C çš„åŠ¨æ€è¿è¡Œæ—¶ç‰¹æ€§ï¼ŒSwift æ˜¯ä¸€é—¨é™æ€è¯­è¨€ï¼Œè¿™æ„å‘³ç€ä»£ç ç¼–è¯‘æ—¶å³ç¡®å®šäº†å…¶å®é™…è°ƒç”¨çš„æ–¹æ³•å’Œç±»å‹ï¼Œæ‰€ä»¥çº¯ç²¹çš„ Swift ç±»å’Œå¯¹è±¡æ²¡æœ‰åŠæ³•ä½¿ç”¨ Runtimeï¼Œæ›´ä¸å­˜åœ¨ Method swizzlingï¼Œä½†æ˜¯å‘¢ï¼ŒSwift æ˜¯å…¼å®¹ Objective - C çš„ï¼Œç»§æ‰¿è‡ª NSObject çš„ç±»ï¼Œä¹Ÿå°±å…·æœ‰äº†è¿è¡Œæ—¶çš„æ¶ˆæ¯æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;çº¯ç²¹çš„ Swift ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ  &lt;code&gt;@objc&lt;/code&gt; ä¿®é¥°ç¬¦ï¼Œ &lt;code&gt;@objc&lt;/code&gt; å…³é”®å­—åªéœ€è¦å¯¹é‚£äº›ä¸æ˜¯ç»§æ‰¿è‡ª &lt;code&gt;NSObject&lt;/code&gt; çš„ç±»å‹è¿›è¡Œï¼Œå¦‚æœ class æ˜¯ç»§æ‰¿è‡ª &lt;code&gt;NSObject&lt;/code&gt; çš„è¯ï¼ŒSwift ä¼šé»˜è®¤è‡ªåŠ¨ä¸ºæ‰€æœ‰çš„é private çš„ç±»å’Œæˆå‘˜åŠ ä¸Š &lt;code&gt;@objc&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt; &lt;code&gt;@objc&lt;/code&gt; ä¿®é¥°ç¬¦ä¸»è¦ç”¨äºéœ€è¦æš´éœ²ç»™ Objective-C ä½¿ç”¨çš„ä»»ä½•åœ°æ–¹ (åŒ…æ‹¬ç±»ï¼Œå±æ€§å’Œæ–¹æ³•ç­‰) ï¼Œä»¥æ”¯æŒå…¶åŠ¨æ€æ´¾å‘å’Œè¿è¡Œæ—¶æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;æ·»åŠ  &lt;code&gt;@objc&lt;/code&gt; ä¿®é¥°ç¬¦å¹¶ä¸æ„å‘³ç€è¿™ä¸ªæ–¹æ³•æˆ–è€…å±æ€§ä¼šå˜æˆåŠ¨æ€æ´¾å‘ï¼ŒSwift ä¾ç„¶å¯èƒ½ä¼šå°†å…¶ä¼˜åŒ–ä¸ºé™æ€è°ƒç”¨ã€‚å¦‚æœéœ€è¦æ–½å±•ä¸€äº›åƒ Method swizzling æˆ–è€…è¿è¡Œæ—¶å†å†³å®šå®ç°è¿™æ ·çš„ â€œé»‘é­”æ³•â€ çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç”¨åˆ° &lt;code&gt;dynamic&lt;/code&gt; ä¿®é¥°ç¬¦äº†ã€‚ &lt;code&gt;dynamic&lt;/code&gt; ä¿®é¥°ç¬¦ä¼šéšå¼çš„æ·»åŠ  &lt;code&gt;@objc&lt;/code&gt; è¿›è¡Œä¿®é¥°ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦ Swift å’Œ Objective æ··åˆå¼€å‘æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;@objc&lt;/code&gt; å°±å¯ä»¥äº†ï¼Œéœ€è¦ Swift å®Œå…¨å®ç°è¿è¡Œæ—¶æœºåˆ¶æ—¶ï¼Œé‚£ä¹ˆå¿…é¡»è¦æ·»åŠ  &lt;code&gt;dynamic&lt;/code&gt; ä¿®é¥°ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¼˜åŒ–å½’è§£æ¡£ï¼Œæ¥äº†è§£ Runtime åœ¨ Swift ä¸­çš„åº”ç”¨ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="Runtime" scheme="http://yoursite.com/categories/Runtime/"/>
    
    
      <category term="Runtime" scheme="http://yoursite.com/tags/Runtime/"/>
    
  </entry>
  
  <entry>
    <title>iOSè®¾è®¡æ¨¡å¼ - KVCå†…éƒ¨æœºåˆ¶&amp;ä½¿ç”¨åœºæ™¯</title>
    <link href="http://yoursite.com/2016/12/21/iOS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20KVC%E5%86%85%E9%83%A8%E6%9C%BA%E5%88%B6/"/>
    <id>http://yoursite.com/2016/12/21/iOSè®¾è®¡æ¨¡å¼ - KVCå†…éƒ¨æœºåˆ¶/</id>
    <published>2016-12-20T18:24:00.000Z</published>
    <updated>2017-01-24T15:46:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ä¸¤å¤©é¢è¯•åœ¨KVCçš„é—®é¢˜ä¸Šæœ‰æ‰€æ¬ ç¼ºï¼Œå¯¹äºåº•å±‚äº†è§£ä¸å¤Ÿï¼Œå› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä½¿ç”¨KVCå¯¹Keyçš„æœç´¢åŸç†ï¼Œè‡ªå·±å†™ä»£ç æ¥å®ç°KVCã€‚</p>
<p>å…³äºAppleæ˜¯å¦‚ä½•å®ç°KVCè¿™ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>ğŸ™ƒ ğŸ™ƒ æˆ‘ä¹Ÿä¸çŸ¥é“â€¦â€¦ </p>
</blockquote>
<p>å› ä¸ºæ²¡æœ‰åŠæ³•æ‰“å°å‡ºè°ƒç”¨è¿‡çš„å‡½æ•°ï¼Œæ‰€ä»¥KVCèƒŒåçš„ä¸€åˆ‡è¿˜æ˜¯å¾ˆç¥ç§˜çš„ï¼Œåªèƒ½é€šè¿‡å‡ ä¸ªæœ‰é™çš„APIæ¥çŒœæƒ³ï¼Œ</p>
<p>å¯¹äº<code>setValue:forKey:</code> ï¼Œåœ¨setterå­˜åœ¨çš„æƒ…å†µï¼ŒKVC ä¼šç›´æ¥å‘é€<code>set&lt;Key&gt;:</code> æ¶ˆæ¯èµ‹å€¼ï¼›</p>
<p>åœ¨setterä¸åœ¨çš„æƒ…å†µä¸‹ï¼Œä¸”<code>accessInstanceVariablesDirectly</code>æ–¹æ³•æ˜¯trueçš„æƒ…å†µä¸‹ï¼Œä¼šæŒ‰<code>ï¼ˆ_&lt;key&gt;, _&lt;isKey&gt;, &lt;key&gt;, is&lt;Key&gt;ï¼‰</code>çš„é¡ºåºå»æŸ¥æ‰¾å®ä¾‹å˜é‡ï¼Œæ£€æŸ¥å…¶æ˜¯å¦å­˜åœ¨ä¹‹åé€šè¿‡<code>object_setIvar</code>ç»™å®ƒèµ‹å€¼ã€‚</p>
<p>å¦‚æœéƒ½æ²¡æœ‰å°±è°ƒç”¨<code>setValue:forUNdefinedKey:</code>æŠ›å‡ºé”™è¯¯ã€‚</p>
<p>å¯¹äº<code>setValue:forKeyPath:</code>ï¼Œé€’å½’åœ°æ£€æŸ¥keyPathä¸­çš„å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œåˆ°è¾¾ç›®æ ‡è·¯å¾„æ—¶å†è°ƒç”¨<code>setValue:forKey:</code> å®Œæˆèµ‹å€¼ã€‚</p>
<p>å¤§è‡´ä¸Šæˆ‘å‡†å¤‡æŒ‰ä¸Šé¢çš„æ‰§è¡Œé¡ºåºè¿›è¡Œå®ç°ï¼Œç”±äºé›†åˆã€å­—å…¸å’Œæ¨¡å‹ã€KeyPathçš„æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘åªå®ç°äº†æœ€æ™®é€šçš„å­˜å€¼å’Œå–å€¼ï¼Œä¸‹é¢è¿›å…¥æ­£é¢˜ï¼š</p>
   <a id="more"></a>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">MyError</span>: <span class="title">ErrorType</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">NotExist</span></div><div class="line">    <span class="keyword">case</span> <span class="type">NotNSObjectType</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NSObject</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setMyValue</span><span class="params">(value value: AnyObject?, forKey key: String?)</span></span> <span class="keyword">throws</span> &#123;</div><div class="line">        </div><div class="line">        <span class="comment">/**åˆ¤æ–­Keyæ˜¯å¦æ˜¯ç©ºå€¼*/</span></div><div class="line">        <span class="keyword">if</span> key!.isEmpty &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">MyError</span>.<span class="type">NotExist</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">/**åˆ¤æ–­Valueæ˜¯å¦æ˜¯ç©ºå€¼*/</span></div><div class="line">        <span class="keyword">if</span> value == <span class="literal">nil</span>  &#123;</div><div class="line">            <span class="keyword">self</span>.setMyNilValue(key!)</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">/**åˆ¤æ–­Valueæ˜¯å¦æ˜¯NSObjectç±»å‹*/</span></div><div class="line">        <span class="keyword">if</span> !(value <span class="keyword">is</span> <span class="type">NSObject</span>) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">MyError</span>.<span class="type">NotNSObjectType</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">/**åˆ¤æ–­æ˜¯å¦å­˜åœ¨setKeyæ–¹æ³•ï¼Œå¦‚æœæœ‰æ‰§è¡Œè¿™ä¸ªæ–¹æ³•*/</span></div><div class="line">        <span class="keyword">let</span> funcName = <span class="string">"set"</span> + (key?.capitalizedString)! + <span class="string">":"</span></div><div class="line">        </div><div class="line">        <span class="keyword">let</span> selector = <span class="type">NSSelectorFromString</span>(funcName)</div><div class="line">        <span class="comment">//let selector = Selector.init(funcName)</span></div><div class="line">        <span class="comment">//let selector = #selector(Address.setCity(_:))</span></div><div class="line">        <span class="comment">//print(self.respondsToSelector(selector))</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.respondsToSelector(selector)&#123;</div><div class="line">            <span class="keyword">self</span>.performSelector((selector), withObject: value)</div><div class="line">            <span class="comment">//print("æ‰§è¡ŒsetKeyæ–¹æ³•")</span></div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">/**åˆ¤æ–­è¯¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ keyã€_keyã€iskeyæˆå‘˜ï¼Œå¦‚æœæœ‰ç»™è¿™ä¸ªæˆå‘˜èµ‹å€¼*/</span></div><div class="line">        <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">var</span> flag: <span class="type">Bool</span> = <span class="literal">false</span></div><div class="line">        <span class="keyword">let</span> iVars = class_copyIvarList(<span class="keyword">self</span>.<span class="keyword">dynamicType</span>, &amp;<span class="built_in">count</span>)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="built_in">count</span> &#123;</div><div class="line">            <span class="keyword">let</span> iVar = iVars[<span class="type">Int</span>(i)]</div><div class="line">            <span class="keyword">let</span> keyName = <span class="type">NSString</span>(<span class="type">CString</span>: ivar_getName(iVar), encoding: <span class="type">NSUTF8StringEncoding</span>)</div><div class="line">            <span class="keyword">if</span> keyName == key! || keyName == <span class="string">"_"</span> + key! || keyName == <span class="string">"is"</span> + key!&#123;</div><div class="line">                flag = <span class="literal">true</span></div><div class="line">                </div><div class="line">                object_setIvar(<span class="keyword">self</span>, iVar, value)</div><div class="line">                <span class="comment">//print("\(self) \(iVar) \(value)")</span></div><div class="line">                <span class="comment">//print("ç»™\(keyName)èµ‹å€¼")</span></div><div class="line">                <span class="keyword">break</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">/**å¦‚æœä»¥ä¸Šçš„æˆå‘˜å’Œæ–¹æ³•éƒ½ä¸å­˜åœ¨ï¼Œè°ƒç”¨æœªæ‰¾åˆ°keyçš„æ–¹æ³•*/</span></div><div class="line">        <span class="keyword">if</span> !flag &#123;</div><div class="line">            <span class="keyword">self</span>.setMyValue(value!, forUndefinedKey: key!)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setMyNilValue</span><span class="params">(key: String?)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"æ— æ³•ä¿®æ”¹<span class="subst">\(key)</span>çš„å€¼ï¼Œå› ä¸ºä¼ å…¥çš„æ˜¯ç©ºå€¼"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setMyValue</span><span class="params">(value: AnyObject, forUndefinedKey key: String)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"æ— æ³•å°†<span class="subst">\(key)</span>çš„å€¼ä¿®æ”¹ä¸ºï¼Œå› ä¸ºä¼ å…¥çš„æ˜¯ç©ºå€¼"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">myValueForKey</span><span class="params">(key: String?)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">AnyObject</span>? &#123;</div><div class="line">        </div><div class="line">        <span class="comment">/**åˆ¤æ–­Keyæ˜¯å¦æ˜¯ç©ºå€¼*/</span></div><div class="line">        <span class="keyword">if</span> key!.isEmpty &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">MyError</span>.<span class="type">NotExist</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">/**åˆ¤æ–­æ˜¯å¦å­˜åœ¨getKeyæ–¹æ³•ï¼Œå¦‚æœæœ‰æ‰§è¡Œè¿™ä¸ªæ–¹æ³•*/</span></div><div class="line">        <span class="keyword">let</span> funcName = <span class="string">"get"</span> + (key?.capitalizedString)! + <span class="string">":"</span></div><div class="line">        <span class="keyword">let</span> selector = <span class="type">NSSelectorFromString</span>(funcName)</div><div class="line">        <span class="comment">//let selector = Selector.init(funcName)</span></div><div class="line">        <span class="comment">//let selector = #selector(Address.setCity(_:))</span></div><div class="line">        <span class="comment">//print(self.respondsToSelector(selector))</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.respondsToSelector(selector)&#123;</div><div class="line">            <span class="keyword">let</span> result =  <span class="keyword">self</span>.performSelector(selector)</div><div class="line">            <span class="comment">//print("æ‰§è¡ŒgetKeyæ–¹æ³•")</span></div><div class="line">            <span class="keyword">return</span> result <span class="keyword">as</span>? <span class="type">AnyObject</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">/**åˆ¤æ–­è¯¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ keyã€_keyã€iskeyæˆå‘˜ï¼Œå¦‚æœæœ‰ç»™è¿™ä¸ªæˆå‘˜èµ‹å€¼*/</span></div><div class="line">        <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">var</span> flag: <span class="type">Bool</span> = <span class="literal">false</span></div><div class="line">        <span class="keyword">let</span> iVars = class_copyIvarList(<span class="keyword">self</span>.<span class="keyword">dynamicType</span>, &amp;<span class="built_in">count</span>)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="built_in">count</span> &#123;</div><div class="line">            <span class="keyword">let</span> iVar = iVars[<span class="type">Int</span>(i)]</div><div class="line">            <span class="keyword">let</span> keyName = <span class="type">NSString</span>(<span class="type">CString</span>: ivar_getName(iVar), encoding: <span class="type">NSUTF8StringEncoding</span>)</div><div class="line">            <span class="keyword">if</span> keyName == key! || keyName == <span class="string">"_"</span> + key! || keyName == <span class="string">"is"</span> + key!&#123;</div><div class="line">                flag = <span class="literal">true</span></div><div class="line">                <span class="built_in">print</span>(<span class="string">"å–å‡º<span class="subst">\(keyName)</span>çš„å€¼"</span>)</div><div class="line">                <span class="comment">//print("\(self) \(iVar) \(value)")</span></div><div class="line">                <span class="keyword">return</span> object_getIvar(<span class="keyword">self</span>, iVar)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">/**å¦‚æœä»¥ä¸Šçš„æˆå‘˜å’Œæ–¹æ³•éƒ½ä¸å­˜åœ¨ï¼Œè°ƒç”¨æœªæ‰¾åˆ°keyçš„æ–¹æ³•*/</span></div><div class="line">        <span class="keyword">if</span> !flag &#123;</div><div class="line">            <span class="keyword">self</span>.myValueForUndefinedKey(key!)</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">myValueForUndefinedKey</span><span class="params">(key: String)</span></span> -&gt; <span class="type">AnyObject</span>?&#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"æ— æ³•å–å‡º<span class="subst">\(key)</span>çš„å€¼ï¼Œå› ä¸ºå±æ€§ä¸å­˜åœ¨"</span>)</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**æ‰§è¡Œ*/</span></div><div class="line"><span class="keyword">let</span> add = <span class="type">Address</span>()</div><div class="line"></div><div class="line">add._country = <span class="string">"China"</span></div><div class="line">add._province = <span class="string">"HeBei"</span></div><div class="line">add._city = <span class="string">"ShiJiaZhuang"</span></div><div class="line">add._province = <span class="string">"ChangAnQu"</span></div><div class="line"></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="keyword">try</span> add.setMyValue(value: <span class="string">"BeiJing"</span>, forKey: <span class="string">"city"</span>)</div><div class="line">    <span class="keyword">try</span> add.setMyValue(value: <span class="string">"USA"</span>, forKey: <span class="string">"country"</span>)</div><div class="line">    <span class="keyword">try</span> add.setMyValue(value: <span class="string">"South"</span>, forKey: <span class="string">""</span>)</div><div class="line">    <span class="keyword">try</span> add.setMyValue(value: <span class="string">"300169"</span>, forKey: <span class="string">"postCode"</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="string">"country:<span class="subst">\(add._country)</span> city:<span class="subst">\(add._city)</span> province:<span class="subst">\(add._province)</span> district<span class="subst">\(add._district)</span>"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> <span class="type">MyError</span>.<span class="type">NotExist</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"keyæ˜¯ç©ºçš„"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> <span class="type">MyError</span>.<span class="type">NotNSObjectType</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"valueä¸æ˜¯NSObjectç±»å‹"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"ä¼ å€¼å‡ºé”™"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="keyword">let</span> country = <span class="keyword">try</span> add.myValueForKey(<span class="string">"country"</span>)</div><div class="line">    <span class="keyword">let</span> city = <span class="keyword">try</span> add.myValueForKey(<span class="string">"city"</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="string">"----------------/n <span class="subst">\(country)</span> <span class="subst">\(city)</span>"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> <span class="type">MyError</span>.<span class="type">NotExist</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"keyæ˜¯ç©ºçš„"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"å–å€¼å‡ºé”™"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯æ ¹æ®KVCæ‰§è¡Œé¡ºåºè‡ªå®šä¹‰çš„ä¸€æ®µä»£ç ï¼Œå½“ç„¶ä¹Ÿçœç•¥äº†ä¸€äº›åŠŸèƒ½ï¼Œæ€»ä½“ä¸Šçš„é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œåœ¨ä½¿ç”¨<code>object_setIvar</code>å’Œ<code>object_getIvar</code>è¿™ä¸¤ä¸ªruntimeå‡½æ•°æ—¶ï¼Œç¨‹åºä¼šé¢‘ç¹å´©æºƒï¼Œè€Œè‡ªå·±å¯¹runtimeè®¤è¯†ä¸è¶³ï¼Œä»¥åå†å®Œæ•´è¿™æ®µä»£ç å§ã€‚</p>
<p>å…³äºKVCï¼Œé™¤å»å­˜å–æ–¹æ³•ï¼Œåº•å±‚æ‰§è¡Œé¡ºåºï¼Œé”™è¯¯å¤„ç†ä»¥å¤–ï¼Œè¿˜æœ‰å‡ ç‚¹éœ€è¦äº†è§£ï¼š</p>
<h2 id="Valueåˆæ³•æ€§æ ¡éªŒ"><a href="#Valueåˆæ³•æ€§æ ¡éªŒ" class="headerlink" title="Valueåˆæ³•æ€§æ ¡éªŒ"></a>Valueåˆæ³•æ€§æ ¡éªŒ</h2><p>KVCæä¾›äº†æ ¡éªŒkeyå¯¹åº”çš„valueæ˜¯å¦åˆæ³•çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">validateValue</span><span class="params">(ioValue: AutoreleasingUnsafeMutablePointer&lt;AnyObject?&gt;, forKey inKey: String)</span></span> <span class="keyword">throws</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">validateValue</span><span class="params">(ioValue: AutoreleasingUnsafeMutablePointer&lt;AnyObject?&gt;, forKeyPath inKeyPath: String)</span></span> <span class="keyword">throws</span></div></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œéœ€è¦è¿›è¡Œé‡å†™ï¼Œå®ƒçš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Address</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> _country: <span class="type">String</span>?</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">validateValue</span><span class="params">(ioValue: AutoreleasingUnsafeMutablePointer&lt;AnyObject?&gt;, forKey inKey: String)</span></span> <span class="keyword">throws</span> &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> country = ioValue.memory <span class="keyword">as</span>! <span class="type">String</span></div><div class="line">        <span class="keyword">if</span> country == <span class="string">"Janpan"</span> &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="type">MyError</span>.<span class="type">NotExist</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">throw</span> <span class="type">MyError</span>.<span class="type">Nothing</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**æ‰§è¡Œ*/</span></div><div class="line"><span class="keyword">let</span> add = <span class="type">Address</span>()</div><div class="line"><span class="keyword">var</span> value: <span class="type">AnyObject</span>? = <span class="string">"Janpan"</span></div><div class="line"></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="keyword">try</span> add.validateValue(&amp;value, forKey: <span class="string">"_country"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> <span class="type">MyError</span>.<span class="type">NotExist</span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> <span class="type">MyError</span>.<span class="type">Nothing</span> &#123;</div><div class="line">    add.setValue(value, forKey: <span class="string">"_country"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span> &#123;&#125;</div><div class="line"><span class="built_in">print</span>(add._country)</div><div class="line"></div><div class="line"><span class="comment">/**å½“ var value: AnyObject? = "Janpan" æ—¶è¾“å‡º*/</span></div><div class="line">è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥</div><div class="line"><span class="literal">nil</span></div><div class="line"><span class="comment">/**å½“ var value: AnyObject? = "Chain" æ—¶è¾“å‡º*/</span></div><div class="line"><span class="type">Optional</span>(<span class="string">"China"</span>)</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å®ç°äº†å…ˆå¯¹ä¼ å…¥å€¼çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒï¼Œæ— è¯¯åå†è¿›è¡Œèµ‹å€¼ï¼Œå¦‚ä¸Šé¢çš„ä»£ç ï¼Œå½“æˆ‘ä»¬éœ€è¦éªŒè¯èƒ½ä¸èƒ½ç”¨KVCè®¾å®šæŸä¸ªå€¼æ—¶ï¼Œå¯ä»¥å°†å…¶é‡å†™åè°ƒç”¨</p>
<blockquote>
<p><code>validateValue: forKey:</code></p>
</blockquote>
<p>è¿™ä¸ªæ–¹æ³•æ¥éªŒè¯ï¼Œé‚£ä¹ˆKVCå°±ä¼šç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è¿”å›ã€‚<strong>éœ€è¦æ³¨æ„çš„æ˜¯å³ä½¿é‡å†™äº†è¯¥æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸»åŠ¨è¿›è¡Œè°ƒç”¨ï¼ŒKVCä¹Ÿä¸ä¼šä¸»åŠ¨å»åšéªŒè¯ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•éœ€è¦æ‰‹åŠ¨è°ƒç”¨ã€‚</strong></p>
<h2 id="KVCçš„åº”ç”¨åœºæ™¯"><a href="#KVCçš„åº”ç”¨åœºæ™¯" class="headerlink" title="KVCçš„åº”ç”¨åœºæ™¯"></a>KVCçš„åº”ç”¨åœºæ™¯</h2><p>ä½œä¸ºiOSå¹³å°çš„çŸ¥åé»‘é­”æ³•ï¼ŒKVCæœ‰å¾ˆå¤šå¥‡ç‰¹çš„ä½œç”¨ï¼ŒKVCåœ¨iOSå¼€å‘ä¸­æ˜¯ç»ä¸å¯å°‘çš„åˆ©å™¨ï¼Œè¿™ç§åŸºäºè¿è¡Œæ—¶çš„ç¼–ç¨‹æ–¹å¼æå¤§åœ°æé«˜äº†çµæ´»æ€§ï¼Œç®€åŒ–äº†ä»£ç ï¼Œå®ƒçš„å¸¸è§ä½œç”¨æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<h2 id="åŠ¨æ€çš„å­˜å€¼å’Œå–å€¼"><a href="#åŠ¨æ€çš„å­˜å€¼å’Œå–å€¼" class="headerlink" title="åŠ¨æ€çš„å­˜å€¼å’Œå–å€¼"></a>åŠ¨æ€çš„å­˜å€¼å’Œå–å€¼</h2><p>ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ ğŸ™ƒ </p>
<h2 id="è®¿é—®å’Œä¿®æ”¹ç§æœ‰çš„æˆå‘˜"><a href="#è®¿é—®å’Œä¿®æ”¹ç§æœ‰çš„æˆå‘˜" class="headerlink" title="è®¿é—®å’Œä¿®æ”¹ç§æœ‰çš„æˆå‘˜"></a>è®¿é—®å’Œä¿®æ”¹ç§æœ‰çš„æˆå‘˜</h2><p>å¯¹äºç±»é‡Œçš„ç§æœ‰å±æ€§ï¼Œæ— è®ºSwiftè¿˜æ˜¯Objective-Céƒ½æ˜¯æ— æ³•ç›´æ¥è®¿é—®çš„ï¼Œä½†æ˜¯KVCæ˜¯å¯ä»¥çš„ã€‚</p>
<h2 id="Modelå’Œå­—å…¸çš„äº’ç›¸è½¬æ¢"><a href="#Modelå’Œå­—å…¸çš„äº’ç›¸è½¬æ¢" class="headerlink" title="Modelå’Œå­—å…¸çš„äº’ç›¸è½¬æ¢"></a>Modelå’Œå­—å…¸çš„äº’ç›¸è½¬æ¢</h2><p>è¿™æ˜¯KVCåˆä¸€ä¸ªå¼ºå¤§ä¹‹å¤„ï¼Œåªéœ€è¦å¾ˆå°‘çš„ä»£ç é‡å³å¯å®Œæˆå¾ˆå¤šåŠŸèƒ½ã€‚</p>
<h2 id="ä¿®æ”¹æ§ä»¶çš„å†…éƒ¨å±æ€§"><a href="#ä¿®æ”¹æ§ä»¶çš„å†…éƒ¨å±æ€§" class="headerlink" title="ä¿®æ”¹æ§ä»¶çš„å†…éƒ¨å±æ€§"></a>ä¿®æ”¹æ§ä»¶çš„å†…éƒ¨å±æ€§</h2><p>è¿™ä¹Ÿæ˜¯iOSå¼€å‘ä¸­å¿…ä¸å¯å°‘çš„å°æŠ€å·§ã€‚ä¼—æ‰€å‘¨çŸ¥å¾ˆå¤šUIæ§ä»¶éƒ½ç”±å¾ˆå¤šå†…éƒ¨UIæ§ä»¶ç»„åˆè€Œæˆçš„ï¼Œä½†æ˜¯Appleæ²¡æœ‰æä¾›è¿™è®¿é—®è¿™äº›æ§ä»¶çš„APIï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•æ­£å¸¸åœ°è®¿é—®å’Œä¿®æ”¹è¿™äº›æ§ä»¶çš„æ ·å¼ã€‚</p>
<p>è€ŒKVCåœ¨å¤§å¤šæ•°æƒ…å†µå¯ä¸‹å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ¯”å¦‚ä¸ªæ€§åŒ–UITextFieldä¸­çš„placeHolderTextï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥è¿ç”¨runtimeæ¥è·å–Appleä¸æƒ³å¼€æ”¾çš„å±æ€§åï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**æ‰§è¡Œ*/</span></div><div class="line"><span class="keyword">let</span> <span class="built_in">count</span>:<span class="type">UnsafeMutablePointer</span>&lt;<span class="type">UInt32</span>&gt; =  <span class="literal">nil</span></div><div class="line"><span class="keyword">var</span> properties = class_copyIvarList(<span class="type">UITextField</span>.<span class="keyword">self</span>, <span class="built_in">count</span>)</div><div class="line"></div><div class="line"><span class="keyword">while</span> properties.memory.debugDescription !=  <span class="string">"0x0000000000000000"</span>&#123;</div><div class="line">    <span class="keyword">let</span> t = ivar_getName(properties.memory)</div><div class="line">    <span class="keyword">let</span> n = <span class="type">NSString</span>(<span class="type">CString</span>: t, encoding: <span class="type">NSUTF8StringEncoding</span>)</div><div class="line">    <span class="built_in">print</span>(n)</div><div class="line">    properties = properties.successor()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**è¾“å‡º*/</span></div><div class="line">......</div><div class="line"><span class="type">Optional</span>(_background)</div><div class="line"><span class="type">Optional</span>(_disabledBackground)</div><div class="line"><span class="type">Optional</span>(_clearButtonMode)</div><div class="line"><span class="type">Optional</span>(_leftView)</div><div class="line"><span class="type">Optional</span>(_leftViewMode)</div><div class="line"><span class="type">Optional</span>(_rightView)</div><div class="line"><span class="type">Optional</span>(_rightViewMode)</div><div class="line"><span class="type">Optional</span>(_traits)</div><div class="line"><span class="type">Optional</span>(_nonAtomTraits)</div><div class="line"><span class="type">Optional</span>(_fullFontSize)</div><div class="line"><span class="type">Optional</span>(_padding)</div><div class="line"><span class="type">Optional</span>(_selectionRangeWhenNotEditing)</div><div class="line">......</div></pre></td></tr></table></figure>
<p>å¯ä»¥ä»é‡Œé¢çœ‹åˆ°å…¶ä»–è¿˜æœ‰å¾ˆå¤šä¸œè¥¿å¯ä»¥ä¿®æ”¹ï¼Œè¿ç”¨KVCè®¾å€¼å¯ä»¥è·å¾—è‡ªå·±æƒ³è¦çš„æ•ˆæœã€‚</p>
<h2 id="KVCæ“ä½œé›†åˆ"><a href="#KVCæ“ä½œé›†åˆ" class="headerlink" title="KVCæ“ä½œé›†åˆ"></a>KVCæ“ä½œé›†åˆ</h2><p>Appleå¯¹KVCçš„<code>valueForKey:</code>æ–¹æ³•ä½œäº†ä¸€äº›ç‰¹æ®Šçš„å®ç°ï¼Œæ¯”å¦‚è¯´NSArrayå’ŒNSSetè¿™æ ·çš„å®¹å™¨ç±»å°±å®ç°äº†è¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ç”¨KVCå¾ˆæ–¹ä¾¿åœ°æ“ä½œé›†åˆã€‚</p>
<h3 id="é«˜é˜¶ä¿¡æ¯ä¼ é€’"><a href="#é«˜é˜¶ä¿¡æ¯ä¼ é€’" class="headerlink" title="é«˜é˜¶ä¿¡æ¯ä¼ é€’"></a>é«˜é˜¶ä¿¡æ¯ä¼ é€’</h3><p>å½“å¯¹å®¹å™¨ç±»ä½¿ç”¨KVCæ—¶ï¼Œ<code>valueForKey:</code>å°†ä¼šè¢«ä¼ é€’ç»™å®¹å™¨ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯å®¹å™¨æœ¬èº«è¿›è¡Œæ“ä½œã€‚ç»“æœä¼šè¢«æ·»åŠ è¿›è¿”å›çš„å®¹å™¨ä¸­ï¼Œè¿™æ ·ï¼Œå¼€å‘è€…å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ“ä½œé›†åˆæ¥è¿”å›å¦ä¸€ä¸ªé›†åˆï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**æ‰§è¡Œ*/</span></div><div class="line"><span class="keyword">let</span> arrStr: <span class="type">NSArray</span> = [<span class="string">"english"</span>, <span class="string">"franch"</span>, <span class="string">"chinese"</span>]</div><div class="line"><span class="keyword">let</span> arrCapStr = arrStr.value(forKey: <span class="string">"capitalizedString"</span>)</div><div class="line"><span class="built_in">print</span>(arrCapStr <span class="keyword">as</span>! <span class="type">NSArray</span>)</div><div class="line"></div><div class="line"><span class="keyword">let</span> arrStrLength = arrStr.value(forKeyPath: <span class="string">"capitalizedString.length"</span>)</div><div class="line"><span class="built_in">print</span>(arrStrLength! <span class="keyword">as</span>! <span class="type">NSArray</span>)</div><div class="line"></div><div class="line"><span class="comment">/**è¾“å‡º*/</span></div><div class="line">(</div><div class="line">    <span class="type">English</span>,</div><div class="line">    <span class="type">Franch</span>,</div><div class="line">    <span class="type">Chinese</span></div><div class="line">)</div><div class="line">(</div><div class="line">    <span class="number">7</span>,</div><div class="line">    <span class="number">6</span>,</div><div class="line">    <span class="number">7</span></div><div class="line">)</div></pre></td></tr></table></figure>
<p>æ–¹æ³•<code>capitalizedString</code>è¢«ä¼ é€’åˆ°NSArrayä¸­çš„æ¯ä¸€é¡¹ï¼Œè¿™æ ·ï¼ŒNSArrayçš„æ¯ä¸€å‘˜éƒ½ä¼šæ‰§è¡Œ<code>capitalizedString</code>å¹¶è¿”å›ä¸€ä¸ªåŒ…å«ç»“æœçš„æ–°çš„NSArrayã€‚ä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰Stringéƒ½æˆåŠŸä»¥è½¬æˆäº†å¤§å†™ã€‚<br>åŒæ ·å¦‚æœè¦æ‰§è¡Œå¤šä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥ç”¨<code>valueForKeyPath:</code>æ–¹æ³•ã€‚å®ƒå…ˆä¼šå¯¹æ¯ä¸€ä¸ªæˆå‘˜è°ƒç”¨ <code>capitalizedString</code>æ–¹æ³•ï¼Œç„¶åå†è°ƒç”¨lengthï¼Œå› ä¸ºlenthæ–¹æ³•è¿”å›æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ‰€ä»¥è¿”å›ç»“æœä»¥NSNumberçš„å½¢å¼ä¿å­˜åœ¨æ–°æ•°ç»„é‡Œã€‚</p>
<h2 id="KVO"><a href="#KVO" class="headerlink" title="KVO"></a>KVO</h2><p>å½“ç„¶äº†ï¼ŒKVCé™¤äº†ä¼ å€¼å–å€¼ï¼Œè®¿é—®å’Œä¿®æ”¹ç§æœ‰å˜é‡ï¼Œä¿®æ”¹æ§ä»¶å±æ€§ï¼Œæ“ä½œé›†åˆã€å­—å…¸å’Œæ¨¡å‹ï¼Œæ›´é‡è¦çš„å°±æ˜¯KVOäº†ã€‚</p>
<h2 id="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"><a href="#Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ" class="headerlink" title="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"></a>Demoä¸‹è½½è¯·<a href="https://github.com/tianziyao/MyCustomKVC" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a></h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰ä¸¤å¤©é¢è¯•åœ¨KVCçš„é—®é¢˜ä¸Šæœ‰æ‰€æ¬ ç¼ºï¼Œå¯¹äºåº•å±‚äº†è§£ä¸å¤Ÿï¼Œå› æ­¤å†™ä¸‹è¿™ç¯‡æ–‡ç« ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä½¿ç”¨KVCå¯¹Keyçš„æœç´¢åŸç†ï¼Œè‡ªå·±å†™ä»£ç æ¥å®ç°KVCã€‚&lt;/p&gt;
&lt;p&gt;å…³äºAppleæ˜¯å¦‚ä½•å®ç°KVCè¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ™ƒ ğŸ™ƒ æˆ‘ä¹Ÿä¸çŸ¥é“â€¦â€¦ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å› ä¸ºæ²¡æœ‰åŠæ³•æ‰“å°å‡ºè°ƒç”¨è¿‡çš„å‡½æ•°ï¼Œæ‰€ä»¥KVCèƒŒåçš„ä¸€åˆ‡è¿˜æ˜¯å¾ˆç¥ç§˜çš„ï¼Œåªèƒ½é€šè¿‡å‡ ä¸ªæœ‰é™çš„APIæ¥çŒœæƒ³ï¼Œ&lt;/p&gt;
&lt;p&gt;å¯¹äº&lt;code&gt;setValue:forKey:&lt;/code&gt; ï¼Œåœ¨setterå­˜åœ¨çš„æƒ…å†µï¼ŒKVC ä¼šç›´æ¥å‘é€&lt;code&gt;set&amp;lt;Key&amp;gt;:&lt;/code&gt; æ¶ˆæ¯èµ‹å€¼ï¼›&lt;/p&gt;
&lt;p&gt;åœ¨setterä¸åœ¨çš„æƒ…å†µä¸‹ï¼Œä¸”&lt;code&gt;accessInstanceVariablesDirectly&lt;/code&gt;æ–¹æ³•æ˜¯trueçš„æƒ…å†µä¸‹ï¼Œä¼šæŒ‰&lt;code&gt;ï¼ˆ_&amp;lt;key&amp;gt;, _&amp;lt;isKey&amp;gt;, &amp;lt;key&amp;gt;, is&amp;lt;Key&amp;gt;ï¼‰&lt;/code&gt;çš„é¡ºåºå»æŸ¥æ‰¾å®ä¾‹å˜é‡ï¼Œæ£€æŸ¥å…¶æ˜¯å¦å­˜åœ¨ä¹‹åé€šè¿‡&lt;code&gt;object_setIvar&lt;/code&gt;ç»™å®ƒèµ‹å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéƒ½æ²¡æœ‰å°±è°ƒç”¨&lt;code&gt;setValue:forUNdefinedKey:&lt;/code&gt;æŠ›å‡ºé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº&lt;code&gt;setValue:forKeyPath:&lt;/code&gt;ï¼Œé€’å½’åœ°æ£€æŸ¥keyPathä¸­çš„å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œåˆ°è¾¾ç›®æ ‡è·¯å¾„æ—¶å†è°ƒç”¨&lt;code&gt;setValue:forKey:&lt;/code&gt; å®Œæˆèµ‹å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å¤§è‡´ä¸Šæˆ‘å‡†å¤‡æŒ‰ä¸Šé¢çš„æ‰§è¡Œé¡ºåºè¿›è¡Œå®ç°ï¼Œç”±äºé›†åˆã€å­—å…¸å’Œæ¨¡å‹ã€KeyPathçš„æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘åªå®ç°äº†æœ€æ™®é€šçš„å­˜å€¼å’Œå–å€¼ï¼Œä¸‹é¢è¿›å…¥æ­£é¢˜ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="KVC" scheme="http://yoursite.com/tags/KVC/"/>
    
  </entry>
  
  <entry>
    <title>Xcodeé”™è¯¯ - Plistå’Œè½¬ä¹‰ç¬¦ã€Œ/ã€</title>
    <link href="http://yoursite.com/2016/11/26/Plist%20%E5%92%8C%E8%BD%AC%E4%B9%89%E7%AC%A6/"/>
    <id>http://yoursite.com/2016/11/26/Plist å’Œè½¬ä¹‰ç¬¦/</id>
    <published>2016-11-25T18:24:00.000Z</published>
    <updated>2017-01-24T15:58:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ä¸¤å¤©é‡åˆ°ä¸€ä¸ª Plist å’Œè½¬ä¹‰ç¬¦çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ç¿»äº† Google åå‡ é¡µï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰¾åˆ°è§£å†³çš„æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°å…³äºè¿™ä¸ªé—®é¢˜çš„æè¿°ï¼Œå› æ­¤æˆ‘æƒ³å…ˆè®°å½•ä¸‹æ¥ï¼Œå¦‚æœæœ‰äººå’Œæˆ‘é‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œå¯ä»¥çŸ¥é“ç»“æœæ˜¯æ€æ ·çš„ã€‚</p>
<p>å½“ç„¶ï¼Œç”±äºæˆ‘çš„æ‰ç–å­¦æµ…ï¼Œæˆ‘æ²¡èƒ½è§£å†³ä¸ä¸€å®šå¤§å®¶éƒ½ä¸èƒ½è§£å†³ï¼Œå¦‚æœä½ æœ‰è§£å†³çš„æ€è·¯ï¼Œæ¬¢è¿é‚®ä»¶æˆ‘å•Šï¼</p>
<p><strong>å¦‚æœä¸æƒ³çœ‹è¿‡ç¨‹ï¼Œå¯ä»¥ç›´æ¥ç¿»åˆ°æœ€ä¸‹é¢çœ‹éªŒè¯çš„ç»“æœ</strong>ã€‚</p>
<p>é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª Plist æ–‡ä»¶ï¼Œå¸Œæœ›ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„è®¾ç½®é€‰é¡¹ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªå‘æ˜¯ KVC ä¸æ”¯æŒ Bool ç±»å‹ï¼Œè¿™ä¸ªæ˜¯æˆ‘æ²¡æƒ³èµ·äº†ï¼Œä½¿ç”¨ 0 å’Œ 1 æ¥æ›¿ä»£è§£å†³äº†ï¼Œç°åœ¨è¦è®²çš„æ˜¯ç¬¬äºŒä¸ªå‘ã€‚</p>
<p>å› ä¸ºæˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†å­—ä½“å›¾æ ‡ï¼Œå®ƒç±»ä¼¼ Emoji è¡¨æƒ…ï¼šä½¿ç”¨ Unicode ç¼–ç ï¼Œè·å–ç‰¹å®šçš„å›¾æ ‡ã€‚åœ¨å…¶ä»–çš„é¡µé¢ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†å…¨å±€å˜é‡ + UILabel è½¬ UIImage çš„æ–¹å¼ï¼Œè·å–å¹¶ä½¿ç”¨å­—ä½“å›¾æ ‡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
   <a id="more"></a>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> settingIconCode = <span class="string">"\u&#123;e702&#125;"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">image</span>(<span class="title">withIconCode</span> <span class="title">iconCode</span>: <span class="title">String</span>, <span class="title">fontName</span>: <span class="title">String</span>, <span class="title">size</span>: <span class="title">CGFloat</span>, <span class="title">color</span>: <span class="title">UIColor</span>?) -&gt; <span class="title">UIImage</span>? </span>&#123;</div><div class="line">                </div><div class="line">        <span class="keyword">let</span> imageSize = <span class="type">CGSize</span>(width: size, height: size)</div><div class="line">        <span class="type">UIGraphicsBeginImageContextWithOptions</span>(imageSize, <span class="literal">false</span>, <span class="type">UIScreen</span>.main.scale)</div><div class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: size, height: size))</div><div class="line">        label.font = <span class="type">UIFont</span>(name: fontName, size: size)</div><div class="line">        label.text = iconCode</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (color != <span class="literal">nil</span>) &#123;</div><div class="line">            label.textColor = color</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            label.textColor = <span class="type">UIColor</span>.white</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        label.layer.render(<span class="keyword">in</span>: <span class="type">UIGraphicsGetCurrentContext</span>()!)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> image = <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>() &#123;</div><div class="line">            <span class="keyword">return</span> image</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"ç»˜åˆ¶å¤±è´¥"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“æˆ‘å†™åˆ°è®¾ç½®é¡µé¢æ—¶ï¼Œå†³å®šç”¨ Plist ä½œä¸ºæœ¬åœ°åŒ–å­˜å‚¨çš„æ–¹æ¡ˆï¼Œå› æ­¤æˆ‘åˆ›å»ºäº†ä¸€ä¸ª Plist æ–‡ä»¶ï¼Œç„¶åæ¯ä¸ª Item åŒ…å«ä»¥ä¸‹ 4 ä¸ªå±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// è®¾ç½®é¡¹åç§°</span></div><div class="line"><span class="keyword">var</span> name: <span class="type">String</span>!</div><div class="line"><span class="comment">/// è®¾ç½®é¡¹å›¾æ ‡</span></div><div class="line"><span class="keyword">var</span> iconCode: <span class="type">String</span>!</div><div class="line"><span class="comment">/// æ˜¯å¦æ˜¾ç¤º Switch æ§ä»¶</span></div><div class="line"><span class="keyword">var</span> switchHide: <span class="type">String</span>!</div><div class="line"><span class="comment">/// è®¾ç½®é¡¹çŠ¶æ€</span></div><div class="line"><span class="keyword">var</span> state: <span class="type">String</span>!</div></pre></td></tr></table></figure>
<p>è®²é“ç†è¿™æ—¶æˆ‘å·²ç»å¯ä»¥è½¬æ¨¡å‹ç„¶ååœ¨ Cell é‡Œé¢ä½¿ç”¨äº†ï¼Œä½†æ˜¯åœ¨æˆ‘ä½¿ç”¨ä¸Šé¢å†™çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">image</span>(<span class="title">withIconCode</span> <span class="title">iconCode</span>: <span class="title">String</span>, <span class="title">fontName</span>: <span class="title">String</span>, <span class="title">size</span>: <span class="title">CGFloat</span>, <span class="title">color</span>: <span class="title">UIColor</span>?) -&gt; <span class="title">UIImage</span>?</span></div></pre></td></tr></table></figure>
<p>å‘ç°è¿™ä¸ªæ–¹æ³•å¤±æ•ˆäº†ï¼Œè¿”å›çš„æ˜¯ <code>â€¦</code> å›¾ç‰‡ï¼Œè€Œä¸æ˜¯åº”è¯¥è·å–çš„å­—ä½“å›¾æ ‡ï¼Œè¿™ä¸ªçœç•¥å·è‡ªç„¶æ˜¯å› ä¸ºè¶…å‡º <code>UILabel</code> çš„æ˜¾ç¤ºèŒƒå›´å½¢æˆçš„ï¼Œä¸‹é¢ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ç”¨ <code>\u{e702}</code> æ¥ä»£å…¥ã€‚</p>
<p>ä¹‹å‰æˆ‘çš„å…¨å±€å˜é‡ <code>settingIconCode</code> ï¼Œä¼ å…¥åˆ° <code>imageWithIconCode</code> æ–¹æ³•æ—¶æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å°† <code>\u{e702}</code> å†™åœ¨ Plist ä¸­èµ‹å€¼ç»™ <code>iconCode</code>ï¼Œå†è½¬ä¸ºæ¨¡å‹åå‡ºé”™ï¼Œäºæ˜¯æˆ‘æ‰“å°äº† <code>iconCode</code> å‚æ•°ï¼Œç»“æœå’Œæˆ‘é¢„æœŸæ˜¯ä¸€æ ·çš„ <code>\u{e702}</code>ï¼Œç„¶åæˆ‘å°† <code>iconCode</code> å’Œ <code>\u{e702}</code> ä¸€èµ·æ‰“å°ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">print</span>(<span class="string">"\u&#123;e702&#125;"</span>, iconCode)		<span class="comment">//ï¼Ÿîœ¶ \u&#123;e702&#125;</span></div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜ä¸¤è€…è™½ç„¶éƒ½æ˜¯ String ç±»å‹ï¼ŒValue çœ‹èµ·æ¥ä¹Ÿä¸€æ ·ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œäºæ˜¯æˆ‘æƒ³åˆ°<strong>ä¼šä¸ä¼šæ˜¯å› ä¸º <code>\u{e702}</code> æ˜¯ç»è¿‡è½¬æ¢çš„ Stringï¼Œè€Œ <code>iconCode</code> æ˜¯å•çº¯çš„ Stringï¼Ÿ</strong></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>\u{e702}</code> ç­‰åŒäº <code>U+\e702</code> ï¼Œä¹Ÿå°±æ˜¯ 16 è¿›åˆ¶çš„ <code>e702</code> ï¼Œå› æ­¤æˆ‘åœ¨ Plist ä¸­ï¼Œå°† <code>iconCode</code> ä¿®æ”¹ä¸º 16 è¿›åˆ¶çš„ <code>0x1E702</code> ï¼Œç„¶åæˆ‘é€šè¿‡ <code>\u{\(iconCode)}</code> è¿›è¡Œè½¬æ¢ï¼Œä½†æ˜¯å‡ºé”™äº†ï¼Œ <strong>è¿™é‡Œçš„<code>{}</code> ä¸­ä¸å…è®¸ä½¿ç”¨ <code>\()</code>ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥</strong>ã€‚</p>
<p>äºæ˜¯æˆ‘æ”¾å¼ƒäº†è¿™ä¸ªæ–¹æ³•ï¼Œå›æƒ³æ˜¯ä¸æ˜¯<strong>å¯¹è±¡æ˜¯ä¸æ˜¯è¢«ä¿®æ”¹äº†</strong>ï¼Œå› æ­¤æˆ‘æ‰¾åˆ°æœ€åˆè¯»å–åˆ° Plist çš„åœ°æ–¹ï¼Œæ‰“å°è·å–çš„ Plist æ•°ç»„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> settingDicts = <span class="type">NSArray</span>(contentsOfFile: <span class="type">Bundle</span>.main.path(forResource: <span class="string">"Setting.plist"</span>, ofType: <span class="literal">nil</span>)!)</div><div class="line"><span class="built_in">print</span>(settingDicts?.firstObject)</div></pre></td></tr></table></figure>
<p>æˆ‘å¾—åˆ°çš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="type">Optional</span>(&#123;</div><div class="line">    iconCode = <span class="string">"\\u&#123;e702&#125;"</span>;</div><div class="line">    name = <span class="string">"\U81ea\U52a8\U5b9a\U4f4d\U5230\U6700\U8fd1\U7ad9\U70b9"</span>;</div><div class="line">    state = <span class="number">0</span>;</div><div class="line">    switchHide = <span class="number">1</span>;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæ‰“å°ç»“æœå¤šå‡ºäº†ä¸€ä¸ª  <code>\</code>ï¼Œå› æ­¤æˆ‘çŒœæƒ³ï¼ŒPlist å¹¶ä¸èƒ½ç†è§£è½¬ä¹‰ç¬¦ï¼Œå› æ­¤å°† <code>\</code> å½“åšå­—ç¬¦æ¥å¤„ç†ï¼Œæ‰€ä»¥  <code>\ = \\</code>ï¼Œä¸ºäº†éªŒè¯è¿™ä¸ªçŒœæƒ³ï¼Œæˆ‘åˆä¿®æ”¹äº† Value å¹¶æ‰“å°ï¼Œå¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">iconCode = \(iconCode)		<span class="comment">//iconCode = "\\(iconCode)";</span></div><div class="line">iconCode = (iconCode)		<span class="comment">//iconCode = "(iconCode)";</span></div><div class="line">iconCode = \\(iconCode)		<span class="comment">//iconCode = "\\\\(iconCode)";</span></div></pre></td></tr></table></figure>
<p> <strong>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒPlist å¹¶ä¸èƒ½ç†è§£è½¬ä¹‰ç¬¦ï¼Œå› æ­¤ä¼šå°† <code>\</code> å½“åšå­—ç¬¦æ¥å¤„ç†ï¼Œè€Œä¸æ˜¯å½“åšè½¬ä¹‰ç¬¦æ¥å¤„ç†</strong>ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰ä¸¤å¤©é‡åˆ°ä¸€ä¸ª Plist å’Œè½¬ä¹‰ç¬¦çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ç¿»äº† Google åå‡ é¡µï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰¾åˆ°è§£å†³çš„æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°å…³äºè¿™ä¸ªé—®é¢˜çš„æè¿°ï¼Œå› æ­¤æˆ‘æƒ³å…ˆè®°å½•ä¸‹æ¥ï¼Œå¦‚æœæœ‰äººå’Œæˆ‘é‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œå¯ä»¥çŸ¥é“ç»“æœæ˜¯æ€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œç”±äºæˆ‘çš„æ‰ç–å­¦æµ…ï¼Œæˆ‘æ²¡èƒ½è§£å†³ä¸ä¸€å®šå¤§å®¶éƒ½ä¸èƒ½è§£å†³ï¼Œå¦‚æœä½ æœ‰è§£å†³çš„æ€è·¯ï¼Œæ¬¢è¿é‚®ä»¶æˆ‘å•Šï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœä¸æƒ³çœ‹è¿‡ç¨‹ï¼Œå¯ä»¥ç›´æ¥ç¿»åˆ°æœ€ä¸‹é¢çœ‹éªŒè¯çš„ç»“æœ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª Plist æ–‡ä»¶ï¼Œå¸Œæœ›ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„è®¾ç½®é€‰é¡¹ï¼Œé‡åˆ°çš„ç¬¬ä¸€ä¸ªå‘æ˜¯ KVC ä¸æ”¯æŒ Bool ç±»å‹ï¼Œè¿™ä¸ªæ˜¯æˆ‘æ²¡æƒ³èµ·äº†ï¼Œä½¿ç”¨ 0 å’Œ 1 æ¥æ›¿ä»£è§£å†³äº†ï¼Œç°åœ¨è¦è®²çš„æ˜¯ç¬¬äºŒä¸ªå‘ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†å­—ä½“å›¾æ ‡ï¼Œå®ƒç±»ä¼¼ Emoji è¡¨æƒ…ï¼šä½¿ç”¨ Unicode ç¼–ç ï¼Œè·å–ç‰¹å®šçš„å›¾æ ‡ã€‚åœ¨å…¶ä»–çš„é¡µé¢ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†å…¨å±€å˜é‡ + UILabel è½¬ UIImage çš„æ–¹å¼ï¼Œè·å–å¹¶ä½¿ç”¨å­—ä½“å›¾æ ‡ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/categories/Xcode%E9%94%99%E8%AF%AF/"/>
    
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/tags/Xcode%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>iOSè®¾è®¡æ¨¡å¼ - Notification</title>
    <link href="http://yoursite.com/2016/11/24/iOS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20Notification/"/>
    <id>http://yoursite.com/2016/11/24/iOSè®¾è®¡æ¨¡å¼ - Notification/</id>
    <published>2016-11-23T18:24:00.000Z</published>
    <updated>2017-01-24T15:46:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>iOS ä¸­çš„è§‚å¯Ÿè€… Observer æ¨¡å¼åŒ…å«äº†é€šçŸ¥æœºåˆ¶ï¼ˆNotificationï¼‰å’ŒKVOï¼ˆKey-Value-Observingï¼‰æœºåˆ¶ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹è±¡ä¹‹é—´çš„é€šè®¯æœ‰ä»¥ä¸‹å‡ ç§å¸¸è§çš„æ–¹å¼ï¼š</p>
<blockquote>
<p>Delegateã€Blockã€KVOã€Notificationï¼›</p>
</blockquote>
<p>å…¶ä¸­ Delegate ä½¿ç”¨çš„æ˜¯å§”æ‰˜æœºåˆ¶ï¼Œæ˜¯ä¸€å¯¹ä¸€çš„å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼›è€Œ KVO å’Œ Notification é€šçŸ¥æœºåˆ¶æ˜¯å¹¿æ’­ï¼Œä¹Ÿå°±æ˜¯ä¸€å¯¹å¤šçš„å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚é‚£ä¹ˆå¯¹è±¡ä¹‹é—´çš„é€šè®¯åˆæ˜¯åšä»€ä¹ˆå‘¢ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯åœ¨ A ç±»ä¸­åˆ›å»ºçš„æ–¹æ³•ï¼Œåœ¨ B ç±»ä¸­æ‰§è¡Œï¼Œä¸” A ç±»å¯ä»¥ä¼ é€’æ•°æ®ç»™ B ç±»ï¼Œæˆ‘ä»¬çŸ¥é“å½“è¯´èµ·é€šçŸ¥æ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<blockquote>
<p>æœ¬åœ°é€šçŸ¥ã€æ¨é€é€šçŸ¥ã€å¹¿æ’­é€šçŸ¥ï¼›</p>
</blockquote>
<p>è¿™ä¸‰ç§é€šçŸ¥æ˜¯ä¸åŒçš„ï¼Œæœ¬åœ°é€šçŸ¥ä½¿ç”¨çš„æ˜¯ <code>UILocalNotification</code> å®ç°ï¼Œæ˜¯æˆ‘ä»¬çš„ APP è¿è¡Œæ—¶ï¼Œç»™ç”¨æˆ·çš„é€šçŸ¥ï¼›æ¨é€é€šçŸ¥æ˜¯ä½¿ç”¨ <code>UIUserNotification</code> å®ç°ï¼Œæ˜¯ç”¨æˆ·åŒæ„æ¨é€åï¼Œç”±æˆ‘ä»¬çš„æœåŠ¡å™¨æäº¤ç»™ APNSï¼Œå†ç”± APNS è½¬å‘ç»™ç”¨æˆ·çš„ã€‚</p>
<p>è€Œæˆ‘ä»¬æœ¬æ–‡è¦æ¢è®¨çš„æ˜¯ï¼Œç¨‹åºä¸­çš„å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„é€šçŸ¥ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€é¡¹ï¼Œå¹¿æ’­é€šçŸ¥ã€‚</p>
   <a id="more"></a>
<h2 id="Notificationçš„æ¦‚å¿µ"><a href="#Notificationçš„æ¦‚å¿µ" class="headerlink" title="Notificationçš„æ¦‚å¿µ"></a>Notificationçš„æ¦‚å¿µ</h2><p>Notification æ˜¯ iOS æä¾›çš„ä¸€ç§åŒæ­¥çš„æ¶ˆæ¯é€šçŸ¥æœºåˆ¶ï¼Œè§‚å¯Ÿè€…åªè¦å‘æ¶ˆæ¯ä¸­å¿ƒæ³¨å†Œï¼Œå³å¯æ¥å—å…¶ä»–å¯¹è±¡å‘é€æ¥çš„æ¶ˆæ¯ï¼Œæ¶ˆæ¯å‘é€è€…å’Œæ¥æ”¶è€…ä¸¤è€…å¯ä»¥äº’ç›¸ä¸€æ— æ‰€çŸ¥ï¼Œå®Œå…¨è§£è€¦ã€‚</p>
<p>å®ƒæ˜¯ Foundation æ¡†æ¶çš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œå®ƒå‘åº”ç”¨ç¨‹åºä¸­æ³¨å†Œä¸ºæŸä¸ªäº‹ä»¶è§‚å¯Ÿè€…çš„æ‰€æœ‰å¯¹è±¡å¹¿æ’­æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯é€šçŸ¥ã€‚è¯¥äº‹ä»¶å¯ä»¥æ˜¯å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•äº‹æƒ…ï¼Œä¾‹å¦‚è¿›å…¥åå°çŠ¶æ€ï¼Œæˆ–è€…ç”¨æˆ·å¼€å§‹åœ¨æ–‡æœ¬æ ä¸­é”®å…¥ã€‚Notification å‘Šè¯‰è§‚å¯Ÿè€…ï¼Œäº‹ä»¶å·²ç»å‘ç”Ÿæˆ–å³å°†å‘ç”Ÿï¼Œå› æ­¤è®©è§‚å¯Ÿè€…æœ‰æœºä¼šä»¥åˆé€‚çš„æ–¹å¼å“åº”ã€‚é€šè¿‡é€šçŸ¥ä¸­å¿ƒæ¥ä¼ æ’­é€šçŸ¥ï¼Œæ˜¯å¢åŠ åº”ç”¨ç¨‹åºå¯¹è±¡é—´åˆä½œå’Œå†…èšåŠ›çš„ä¸€ç§é€”å¾„ã€‚</p>
<p>è™½ç„¶ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è§‚å¯Ÿé€šçŸ¥ï¼Œä½†è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯¥å¯¹è±¡å¿…é¡»æ³¨å†Œï¼Œä»¥æ¥æ”¶é€šçŸ¥ã€‚åœ¨æ³¨å†Œæ—¶ï¼Œå®ƒå¿…é¡»æŒ‡å®šé€‰æ‹©å™¨ï¼Œä»¥ç¡®å®šç”±é€šçŸ¥ä¼ é€æ‰€è°ƒç”¨çš„æ–¹æ³•ï¼Œæ–¹æ³•ç­¾åå¿…é¡»åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯é€šçŸ¥å¯¹è±¡ï¼›æ³¨å†Œåï¼Œè§‚å¯Ÿè€…ä¹Ÿå¯ä»¥æŒ‡å®šå‘å¸ƒå¯¹è±¡ã€‚Notification å¯ä»¥åº”ç”¨äºä»»ä½•å¯¹è±¡ï¼Œè§‚å¯Ÿè€…å¯ä»¥æœ‰å¤šä¸ªï¼Œæ‰€ä»¥æ¶ˆæ¯å…·æœ‰å¹¿æ’­çš„æ€§è´¨ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè§‚å¯Ÿè€…å‘æ¶ˆæ¯ä¸­å¿ƒæ³¨å†Œä»¥åï¼Œåœ¨ä¸éœ€è¦æ¥æ”¶æ¶ˆæ¯æ—¶éœ€è¦ä»æ¶ˆæ¯ä¸­å¿ƒç§»é™¤ï¼Œè¿™ç§æ¶ˆæ¯ä¼ é€’æœºåˆ¶æ˜¯å…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p>
<p>æ¯ä¸€ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªé€šçŸ¥ä¸­å¿ƒï¼ˆNotificationï¼‰å®ä¾‹ã€‚å½“åº”ç”¨å‘ç”ŸæŸä¸€äº‹ä»¶æ—¶ï¼Œä»»ä½•å¯¹è±¡éƒ½å¯ä»¥å‘é€šçŸ¥ä¸­å¿ƒå‘å¸ƒé€šçŸ¥ï¼›åŒæ—¶ï¼Œé€šçŸ¥çš„ç›‘å¬è€…ç›‘å¬åˆ°è¯¥é€šçŸ¥çš„å‘å¸ƒåï¼Œæ ¹æ®é€šçŸ¥ä¼ å…¥çš„ä¿¡æ¯ï¼ˆUserInfoï¼‰ï¼Œè¿›è¡Œå¯¹åº”çš„æ“ä½œæˆ–å¤„ç†ã€‚</p>
<h2 id="NotificationCenterçš„ä½¿ç”¨"><a href="#NotificationCenterçš„ä½¿ç”¨" class="headerlink" title="NotificationCenterçš„ä½¿ç”¨"></a>NotificationCenterçš„ä½¿ç”¨</h2><p>ä½¿ç”¨é€šçŸ¥æ¨¡å¼ä¸»è¦æ˜¯ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>è·å–é€šçŸ¥ä¸­å¿ƒçš„å®ä¾‹å¹¶æŒ‡å®šå‘å¸ƒè€…ï¼›</li>
<li>æ³¨å†Œæˆä¸ºè§‚å¯Ÿè€…ä»¥æ¥æ”¶å‘å¸ƒè€…é€šçŸ¥çš„ä¿¡æ¯ï¼›</li>
<li>å½“è§‚å¯Ÿè€…ä¸å†å…³æ³¨è¯¥é€šçŸ¥çš„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å‘é€šçŸ¥ä¸­å¿ƒå‘é€è§£é™¤æ³¨å†Œçš„ä¿¡æ¯ï¼Œä¹‹åéƒ½ä¸å†æ¥æ”¶åˆ°é€šçŸ¥ã€‚</li>
</ol>
<p>é€šçŸ¥æœºåˆ¶å¸¸å¸¸ç”¨äºåœ¨å‘æœåŠ¡å™¨ç«¯è¯·æ±‚æ•°æ®æˆ–è€…æäº¤æ•°æ®çš„åœºæ™¯ï¼Œåœ¨å’ŒæœåŠ¡å™¨ç«¯æˆåŠŸäº¤äº’åï¼Œéœ€è¦å¤„ç†æœåŠ¡å™¨ç«¯è¿”å›çš„æ•°æ®ï¼Œæˆ–å‘é€å“åº”æ¶ˆæ¯ç­‰ï¼Œå°±éœ€è¦ç”¨åˆ°é€šçŸ¥æœºåˆ¶ã€‚</p>
<h3 id="è·å–é€šçŸ¥ä¸­å¿ƒ"><a href="#è·å–é€šçŸ¥ä¸­å¿ƒ" class="headerlink" title="è·å–é€šçŸ¥ä¸­å¿ƒ"></a>è·å–é€šçŸ¥ä¸­å¿ƒ</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span></div></pre></td></tr></table></figure>
<p>NotificationCenter çš„åŸç†æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ï¼Œåªæœ‰é€šè¿‡è°ƒç”¨é™æ€æ–¹æ³• <code>default</code> æ‰å¯ä»¥è·å–è¿™ä¸ªé€šçŸ¥ä¸­å¿ƒçš„å¯¹è±¡ã€‚å®ƒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šä¸€ç›´å­˜åœ¨äºä¸€ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p>å‘å¸ƒã€æ³¨å†Œã€è§£é™¤é€šçŸ¥éƒ½éœ€è¦ä½¿ç”¨<strong>é€šçŸ¥ä¸­å¿ƒ</strong>ï¼Œå®ƒè´Ÿè´£ååŠ©ä¸åŒå¯¹è±¡ã€ä¸åŒç±»ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ã€‚</p>
<p>NotificationCenter æä¾›äº†ä¸€ä¸ªä¸­å¿ƒåŒ–çš„æ¢çº½ï¼Œé€šè¿‡å®ƒï¼Œåº”ç”¨çš„ä»»ä½•éƒ¨åˆ†éƒ½å¯ä»¥å‘å…¶ä»–éƒ¨åˆ†å‘é€é€šçŸ¥ï¼Œæˆ–è€…æ¥æ”¶æ¥è‡ªåˆ«äººçš„é€šçŸ¥ã€‚</p>
<p>è§‚å¯Ÿè€…é€šè¿‡åœ¨é€šçŸ¥ä¸­å¿ƒè¿›è¡Œæ³¨å†Œï¼Œå¹¶å¯¹ç‰¹å®šçš„äº‹ä»¶æ³¨å†Œç‰¹å®šçš„å“åº”åŠ¨ä½œã€‚æ¯æ¬¡è¿™ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œé€šçŸ¥ä¸­å¿ƒå°†é€šçŸ¥è¿›è¡Œåˆ†å‘ä¹‹åï¼Œæ‰€æœ‰æ³¨å†Œè¿™ä¸ªäº‹ä»¶çš„è§‚å¯Ÿè€…éƒ½ä¼šè·å¾—é€šçŸ¥ã€‚</p>
<h3 id="æŒ‡å®šå‘å¸ƒè€…"><a href="#æŒ‡å®šå‘å¸ƒè€…" class="headerlink" title="æŒ‡å®šå‘å¸ƒè€…"></a>æŒ‡å®šå‘å¸ƒè€…</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">post</span><span class="params">(<span class="number">_</span> notification: Notification)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">post</span><span class="params">(name aName: NSNotification.Name, object anObject: Any?)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">post</span><span class="params">(name aName: NSNotification.Name, object anObject: Any?, userInfo aUserInfo: [AnyHashable : Any]? = <span class="literal">nil</span>)</span></span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ª3ä¸ªæ–¹æ³•å®é™…å¹¶æ— åŒºåˆ«ï¼Œä¼ å…¥çš„éƒ½æ˜¯ä¸€ä¸ª <code>NSNotification</code> ç±»å‹ï¼Œå®ƒæ˜¯æ¶ˆæ¯æºå¸¦çš„è½½ä½“ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬æ‰å¯ä»¥æŠŠæ¶ˆæ¯å†…å®¹ä¼ é€’ç»™è§‚å¯Ÿè€…ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">open <span class="class"><span class="keyword">class</span> <span class="title">NSNotification</span> : <span class="title">NSObject</span>, <span class="title">NSCopying</span>, <span class="title">NSCoding</span> </span>&#123;</div><div class="line">    open <span class="keyword">var</span> name: <span class="type">NSNotification</span>.<span class="type">Name</span> &#123; <span class="keyword">get</span> &#125;</div><div class="line">    open <span class="keyword">var</span> object: <span class="type">Any</span>? &#123; <span class="keyword">get</span> &#125;</div><div class="line">    open <span class="keyword">var</span> userInfo: [<span class="type">AnyHashable</span> : <span class="type">Any</span>]? &#123; <span class="keyword">get</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>nameï¼šæŒ‡å®šæ¶ˆæ¯åç§°ï¼›</li>
<li>objectï¼šæŒ‡å®šå‘æ¶ˆæ¯è€…ï¼›</li>
<li>userInfoï¼šé€šçŸ¥ä¸­ç”¨äºä¼ é€’å‚æ•°çš„è½½ä½“ï¼›</li>
</ul>
<p>userInfo é‡Œçš„é”®å€¼åº”è¯¥å®šä¹‰æˆå­—ç¬¦ä¸²å¸¸é‡ï¼Œåœ¨æ–‡æ¡£ä¸­åº”è¯¥æ¸…æ™°åœ°æ³¨æ˜å“ªä¸ªé”®å¯¹åº”å“ªç§ç±»å‹çš„å€¼ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸èƒ½åƒé’ˆå¯¹å¯¹è±¡é‚£æ ·å¯¹å­—å…¸ç±»å‹ä¸­çš„å€¼ç±»å‹è¿›è¡Œé™åˆ¶ã€‚name å’Œ object ç”¨æ¥æ§åˆ¶é€šçŸ¥åˆ†å‘çš„ä½œç”¨åŸŸï¼Œå¼€å‘è€…ä»¬åº”å½“åœ¨å¯¹è±¡å‘é€é€šçŸ¥å’Œæ¥æ”¶é€šçŸ¥çš„æ–¹å¼ä¸Šä¿æŒä¸€è‡´ï¼Œè€Œä¸”æŠŠé€šçŸ¥çš„è¡Œä¸ºåœ¨å…¬å…±æ¥å£æ–‡æ¡£ä¸­è¿›è¡Œæ¸…æ™°çš„è¯´æ˜ã€‚</p>
<p>ç”±äºé€šçŸ¥åˆ†å‘æ˜¯åœ¨å‘é€é€šçŸ¥çš„çº¿ç¨‹ä¸Šè¿›è¡Œçš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šéœ€è¦ä½¿ç”¨ï¼š</p>
<blockquote>
<p>dispatch_async     &amp;     dispatch_get_main_queue() </p>
</blockquote>
<p>æ¥ä¿è¯é€šçŸ¥çš„å¤„ç†æ˜¯åœ¨ä¸»çº¿ç¨‹è¿›è¡Œï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘è¿™ç‚¹ï¼Œä¸è¿‡è¿˜æ˜¯è¦æŠŠè¿™ä¸€ç‚¹è®°åœ¨å¿ƒé‡Œã€‚</p>
<h3 id="æ³¨å†Œè§‚å¯Ÿè€…"><a href="#æ³¨å†Œè§‚å¯Ÿè€…" class="headerlink" title="æ³¨å†Œè§‚å¯Ÿè€…"></a>æ³¨å†Œè§‚å¯Ÿè€…</h3><p>å„ç§å„æ ·çš„é€šçŸ¥è½¦æ°´é©¬é¾™åœ°é€šè¿‡ NotificationCenterï¼Œç„¶è€Œä¸€ä¸ªé€šçŸ¥æœ¬èº«ä¸ä¼šæœ‰ä»»ä½•å®é™…ä½œç”¨ï¼Œé™¤éæœ‰äººåœ¨ç›‘å¬ç€å®ƒï¼Œä¼ ç»Ÿçš„æ·»åŠ è§‚å¯Ÿè€…çš„æ–¹å¼æ˜¯ä½¿ç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">addObserver</span><span class="params">(<span class="number">_</span> observer: Any, selector aSelector: Selector, name aName: NSNotification.Name?, object anObject: Any?)</span></span></div></pre></td></tr></table></figure>
<p>è¿›è¡Œæ³¨å†Œï¼Œä¸€ä¸ªå¯¹è±¡ï¼ˆé€šå¸¸æ˜¯ selfï¼‰æŠŠè‡ªå·±æ·»åŠ è¿›å»ï¼Œå½“æŸä¸ªé€šçŸ¥å‘å‡ºæ—¶ï¼Œé€šçŸ¥ä¸­å¿ƒå°±ä¼šæŠŠå‘å¸ƒè€…å‘é€çš„é€šçŸ¥ä¿¡æ¯ï¼Œå¹¿æ’­ç»™æ³¨å†Œè¿‡è¯¥é€šçŸ¥çš„è§‚å¯Ÿè€…ï¼Œæ‰§è¡Œè‡ªå·±ç‰¹å®šçš„ selectorï¼Œè§‚å¯Ÿè€…åªèƒ½æ¥æ”¶åˆ°é€šçŸ¥ä¸­å¿ƒçš„ä¿¡æ¯ï¼Œä½†æ— æ³•çŸ¥é“é€šçŸ¥æ˜¯è°æŠ•é€çš„ï¼Œè¿™ä¹Ÿæ˜¯é€šçŸ¥çš„è§£è€¦æ€§çš„ä½“ç°ä¹‹ä¸€ï¼Œå®ƒçš„å‡ ä¸ªå‚æ•°ä½œç”¨å¦‚ä¸‹ï¼š</p>
<ul>
<li>observerï¼šè§‚å¯Ÿè€…çš„å®ä¾‹ï¼Œé€šå¸¸æ˜¯ selfï¼›</li>
</ul>
<ul>
<li><p>selectorï¼šå›è°ƒæ–¹æ³•ï¼Œåœ¨æœ¬ç±»ä¸­å¯¹é€šçŸ¥è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼›å®ƒåªæœ‰ä¸€ä¸ªå‚æ•°, å‚æ•°å°±æ˜¯æ¶ˆæ¯å¯¹è±¡æœ¬èº«, é€šè¿‡è¿™ä¸ªå‚æ•°å›è°ƒæ–¹æ³•å¯ä»¥å–å¾—æ¶ˆæ¯å¯¹è±¡çš„æˆå‘˜å˜é‡(userinfo) ç”¨äºä¼ å€¼æ³¨å†Œã€å–æ¶ˆé€šçŸ¥çš„ä»£ç æ”¾åœ¨å“ªé‡Œç­‰æ“ä½œã€‚</p>
</li>
<li><p>objectï¼šç›¸å¯¹äºå‘å¸ƒè€…çš„ objectï¼Œå¦‚æœåŒæ—¶è®¾ç½®äº† name å’Œ object é‚£ä¹ˆåªæœ‰æ¥è‡ªç‰¹å®šå¯¹è±¡çš„å¯¹åº”åç§°çš„é€šçŸ¥æ‰ä¼šå“åº”ã€‚å¦‚æœä¸º nilï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…å°†æ”¶åˆ°ä»»ä½•å¯¹è±¡å‘å‡ºçš„é€šçŸ¥æ¶ˆæ¯ï¼›</p>
</li>
<li><p>nameï¼šç›¸å¯¹äºå‘å¸ƒè€…çš„ nameï¼Œå¦‚æœè®¾ç½®äº† nameï¼Œé‚£ä¹ˆåªæœ‰å¯¹åº”åç§°çš„é€šçŸ¥ä¼šè§¦å‘ã€‚å¦‚æœä¸º nilï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…å°†æ¥æ”¶åˆ° object å¯¹è±¡çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œä½†æ˜¯æ— æ³•ç¡®å®šæ¥æ”¶è¿™äº›æ¶ˆæ¯çš„é¡ºåºï¼›</p>
</li>
<li><p>å¦‚æœ name å’Œ object éƒ½ä¸º nilï¼Œé‚£ä¹ˆè¯¥è§‚å¯Ÿè€…å°†æ”¶åˆ°æ‰€æœ‰å¯¹è±¡çš„æ‰€æœ‰æ¶ˆæ¯ã€‚</p>
</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æœ‰ä¸¤ç‚¹ï¼š</p>
<ol>
<li><p>å¯¹äºä¸€ä¸ªä»»æ„çš„è§‚å¯Ÿè€…observerï¼Œå¦‚æœä¸èƒ½ä¿è¯å…¶å¯¹åº”çš„selectoræœ‰æœ¬ç±»è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œå¯é‡‡ç”¨ï¼š</p>
<blockquote>
<p>observer.responds(to: NSSelectorFromString(â€œmyFunc:â€)) </p>
</blockquote>
<p>è¿›è¡Œæ£€æŸ¥ï¼Œåˆ¤æ–­å…¶æ–¹æ³•ç¡®å®å­˜åœ¨åå†è¿›è¡Œæ³¨å†Œã€‚</p>
</li>
<li><p>æ§åˆ¶å¥½æˆ‘ä»¬çš„ä»£ç ï¼ä¸€ä¸ªæ™®é€šçš„ iOS åº”ç”¨åœ¨å¯åŠ¨ä¹‹åçš„å‡ ç§’é’Ÿå†…å°±ä¼šå‘å‡ºå‡ åä¸ªé€šçŸ¥ï¼Œå…¶ä¸­çš„å¤§éƒ¨åˆ†æˆ‘ä»¬å¯èƒ½éƒ½æ²¡æœ‰å¬è¯´è¿‡ï¼Œä¹Ÿä¸éœ€è¦å»å…³å¿ƒã€‚</p>
</li>
</ol>
<h4 id="Notification-Block"><a href="#Notification-Block" class="headerlink" title="Notification Block"></a>Notification Block</h4><p>ç°ä»£çš„åŸºäº block çš„ç”¨äºæ·»åŠ é€šçŸ¥è§‚å¯Ÿè€…çš„ API æ˜¯ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">addObserver</span><span class="params">(forName name: NSNotification.Name?, object obj: Any?, queue: OperationQueue?, using block: @escaping <span class="params">(Notification)</span></span></span> -&gt; <span class="type">Swift</span>.<span class="type">Void</span>) -&gt; <span class="type">NSObjectProtocol</span></div></pre></td></tr></table></figure>
<p>å®ƒæ˜¯ iOS 4.0ä¹‹åï¼ŒApple åˆæä¾›äº†ä¸€ä¸ªä»¥ block æ–¹å¼å®ç°çš„æ·»åŠ è§‚å¯Ÿè€…çš„æ–¹æ³•ï¼Œä¸å‰é¢æåˆ°çš„æŠŠä¸€ä¸ªå·²æœ‰çš„å¯¹è±¡æ³¨å†Œæˆè§‚å¯Ÿè€…ä¸åŒï¼Œè¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªåŒ¿åå¯¹è±¡ä½œä¸ºè§‚å¯Ÿè€…ã€‚</p>
<p>å½“æ”¶åˆ°å¯¹åº”çš„é€šçŸ¥æ—¶ï¼Œå®ƒåœ¨æŒ‡å®šçš„é˜Ÿåˆ—ï¼ˆå¦‚æœé˜Ÿåˆ—å‚æ•°ä¸º nil çš„è¯å°±åœ¨è°ƒç”¨è€…çš„çº¿ç¨‹ï¼‰é‡Œæ‰§è¡Œä¸€ä¸ª blockã€‚å¦å¤–ä¸€ç‚¹å’ŒåŸºäº selector çš„æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›æ„é€ å‡ºçš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œæ­¤æ–¹æ³•éœ€è¦è€ƒè™‘ block çš„å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œå¹¶ä¸ç»å¸¸ç”¨åˆ°ã€‚</p>
<h3 id="ç§»é™¤è§‚å¯Ÿè€…"><a href="#ç§»é™¤è§‚å¯Ÿè€…" class="headerlink" title="ç§»é™¤è§‚å¯Ÿè€…"></a>ç§»é™¤è§‚å¯Ÿè€…</h3><p>ç”±äºé€šçŸ¥ä¸­å¿ƒä¸ä¼š retain è§‚å¯Ÿè€…å¯¹è±¡ï¼Œå› æ­¤æ³¨å†Œè¿‡çš„å¯¹è±¡å¿…é¡»åœ¨é‡Šæ”¾ä¹‹å‰æ³¨é”€æ‰ï¼Œå¦‚æœä¸è¿™æ ·çš„è¯ï¼Œå½“è¯¥é€šçŸ¥å†æ¬¡å‡ºç°æ—¶ï¼Œé€šçŸ¥ä¸­å¿ƒä¼šå‘å·²é‡Šæ”¾çš„è§‚å¯Ÿè€…å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œä»è€Œå¯¼è‡´åº”ç”¨å´©æºƒã€‚</p>
<p>åœ¨ ARC ä¸‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›æ”¶æ— ç”¨çš„é€šçŸ¥å¯¹è±¡å†…å­˜ï¼Œä½†æ˜¯ç”±äºç³»ç»Ÿå›æ”¶æœºåˆ¶ ARC æœ‰ä¸€å®šçš„å»¶è¿Ÿæ€§ï¼Œæ‰€ä»¥å³ä½¿ä¸ä¼šå‡ºé”™ï¼Œä¹Ÿå»ºè®®å…»æˆä¹ æƒ¯ï¼Œå¯¹æ— ç”¨çš„é€šçŸ¥è¿›è¡Œæ‰‹åŠ¨é‡Šæ”¾ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">removeObserver</span><span class="params">(<span class="number">_</span> observer: Any)</span></span>	</div><div class="line"><span class="comment">//é‡Šæ”¾æ‰€æœ‰çš„é€šçŸ¥</span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">removeObserver</span><span class="params">(<span class="number">_</span> observer: Any, name aName: NSNotification.Name?, object anObject: Any?)</span></span></div><div class="line"><span class="comment">//é‡Šæ”¾æŒ‡å®š name æˆ– object çš„é€šçŸ¥</span></div></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æˆ‘ä»¬åœ¨å¯¹è±¡çš„ææ„å‡½æ•°ä¸­å°†é€šçŸ¥ç§»é™¤ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†è¿™ä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰é€šçŸ¥ç§»é™¤ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸€ä¸ªæŒ‰ç…§é€šçŸ¥çš„ name æ¥ç§»é™¤ï¼Œç§»é™¤çš„æ—¶æœºå’Œäº‹ä»¶æœ‰å…³ï¼Œå¦‚æœæ˜¯å’Œè§†å›¾ç›¸å…³çš„ï¼Œæ¯”å¦‚é”®ç›˜ã€UIäº‹ä»¶ç­‰ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<blockquote>
<p>viewWillAppear    &amp;    viewWillDisappear</p>
</blockquote>
<p>å¦‚æœæ˜¯å’Œ ViewController ç›¸å…³çš„ï¼Œæ¯”å¦‚å’Œç½‘ç»œã€å¼‚æ­¥IOç­‰ç›¸å…³çš„é€šçŸ¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<blockquote>
<p>viewDidLoad        &amp;    dealloc</p>
</blockquote>
<h2 id="KVO-NotificationCenter"><a href="#KVO-NotificationCenter" class="headerlink" title="KVO != NotificationCenter"></a>KVO != NotificationCenter</h2><p>æœ‰ä¸€ç‚¹ç»å¸¸è®©æˆ‘ä»¬çŠ¯ç³Šæ¶‚ï¼ŒNotificationCenter çš„æ–¹æ³•ç­¾åå’Œ Key-Value Observing éå¸¸ç›¸ä¼¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">addObserver</span><span class="params">(<span class="number">_</span> observer: Any, selector aSelector: Selector, name aName: NSNotification.Name?, object anObject: Any?)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">addObserver</span><span class="params">(<span class="number">_</span> observer: NSObject, forKeyPath keyPath: String, options: NSKeyValueObservingOptions = [], context: UnsafeMutableRawPointer?)</span></span></div></pre></td></tr></table></figure>
<p><strong>Key-Value Observing æ˜¯åœ¨ keypaths ä¸Šæ·»åŠ è§‚å¯Ÿè€…ï¼Œè€Œ NotificationCenter æ˜¯åœ¨é€šçŸ¥ä¸Šæ·»åŠ è§‚å¯Ÿè€…ã€‚</strong>ç‰¢è®°è¿™ä¸ªåŒºåˆ«ï¼Œå°±å¯ä»¥è‡ªä¿¡åœ°å»ä½¿ç”¨è¿™ä¸¤å¥— API äº†ã€‚</p>
<h2 id="Notificationçš„æ —å­"><a href="#Notificationçš„æ —å­" class="headerlink" title="Notificationçš„æ —å­"></a>Notificationçš„æ —å­</h2><blockquote>
<p>Talk is cheap. Show me the code.</p>
</blockquote>
<p>ä¸Šé¢æˆ‘ä»¬æ’¸å®Œæ¦‚å¿µï¼Œä¸‹é¢å¼€å§‹æ’¸ä»£ç äº†ï¼Œæˆ‘ä»¬è¦åšä¸¤ä¸ªé¡µé¢ï¼Œåœ¨ç¬¬äºŒä¸ªé¡µé¢ä¸­è¾“å…¥æ–‡å­—ï¼Œåœ¨ç¬¬ä¸€ä¸ªé¡µé¢ä¸­å±•ç¤ºè¾“å…¥çš„æ–‡å­—ã€‚é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè§†å›¾ FirstVCï¼Œæ·»åŠ ä¸€ä¸ª Label å±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> observerLabel: <span class="type">UILabel</span>!</div></pre></td></tr></table></figure>
<p>ç„¶ååˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨æˆ‘ä»¬è·å¾—é€šçŸ¥æ—¶ï¼Œæ›´æ–° Label çš„æ–‡å­—ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">upDataForLabel</span><span class="params">(notification: NSNotification)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> dict = notification.userInfo!</div><div class="line">    <span class="keyword">let</span> str = dict[<span class="string">"toFirstVCLabel"</span>]</div><div class="line">    observerLabel.text = str <span class="keyword">as</span>? <span class="type">String</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ viewDidLoad æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°† FirstVC è‡ªå·±æ³¨å†Œä¸ºè§‚å¯Ÿè€…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">    <span class="keyword">let</span> selector = <span class="type">NSSelectorFromString</span>(<span class="string">"upDataForLabelWithNotification:"</span>)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.responds(to: selector) &#123;</div><div class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>,</div><div class="line">                                               selector: selector,</div><div class="line">                                               name: <span class="type">NSNotification</span>.<span class="type">Name</span>(rawValue: <span class="string">"upDataForLabel"</span>),</div><div class="line">                                               object: <span class="literal">nil</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬åˆ›å»ºç¬¬äºŒä¸ªé¡µé¢ï¼šSecondVCï¼Œæ·»åŠ ä¸€ä¸ª UITextField ç”¨äºç”¨æˆ·è¾“å…¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> posterTextField: <span class="type">UITextField</span>!</div></pre></td></tr></table></figure>
<p>æ·»åŠ ä¸€ä¸ª Buttonï¼Œç‚¹å‡»æ—¶è¿”å›åˆ° FirstVCï¼Œå¹¶ä¸”å‘é€æ¶ˆæ¯ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">saveAndJumpButtonDidTouch</span><span class="params">(<span class="number">_</span> sender: AnyObject)</span></span> &#123;</div><div class="line">    <span class="keyword">self</span>.dismiss(animated: <span class="literal">true</span>) &#123; </div><div class="line">        <span class="keyword">let</span> str = <span class="keyword">self</span>.posterTextField.text</div><div class="line">        <span class="keyword">let</span> notification = <span class="type">Notification</span>(name: <span class="type">NSNotification</span>.<span class="type">Name</span>(rawValue: <span class="string">"upDataForLabel"</span>),</div><div class="line">                                        object: <span class="literal">nil</span>,</div><div class="line">                                        userInfo: [<span class="string">"toFirstVCLabel"</span>:str])</div><div class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.post(notification)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å‰é¢çš„ç›®æ ‡å°±å®Œæˆäº†ã€‚ä» FirstVC è·³è½¬åˆ° SecondVCï¼Œåœ¨ SecondVC ä¸­è¾“å…¥æ–‡å­—ï¼Œç‚¹å‡» Button åè·³è½¬å› FirstVCï¼Œå¹¶æ˜¾ç¤ºä¹‹å‰è¾“å…¥çš„æ–‡å­—ã€‚</p>
<h3 id="NSNotification-Name"><a href="#NSNotification-Name" class="headerlink" title="NSNotification.Name"></a>NSNotification.Name</h3><p>NSNotification.Name å¹¶ä¸ä»…ä»…å¯ä»¥ä¸ºæˆ‘ä»¬è‡ªå·±çš„é€šçŸ¥è¿›è¡Œæ ‡è¯†ï¼Œå®ƒè¿˜å…·æœ‰å¾ˆå¤š APIï¼Œå¯ä»¥ç›‘æ§ APP çš„è¿è¡ŒçŠ¶æ€ï¼Œæˆ‘ä»¬æ¥ç€å®Œå–„è¿™ä¸ªå°ç¨‹åºï¼Œè¿™æ¬¡æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å½“ç¨‹åºè¿›å…¥éæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œæ›´æ”¹ FirstVC çš„ Label çš„èƒŒæ™¯é¢œè‰²ã€‚æˆ‘ä»¬åœ¨ FirstVC çš„ viewDidLoad ä¸­å†æ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">    <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>,</div><div class="line">                                           selector: #selector(<span class="type">FirstVC</span>.colorChangeForAppState),</div><div class="line">                                           name: <span class="type">NSNotification</span>.<span class="type">Name</span>.<span class="type">UIApplicationWillResignActive</span>,</div><div class="line">                                           object: <span class="literal">nil</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>NSNotification.Name.UIApplicationWillResignActive ä»£è¡¨çš„æ˜¯ä¸€ä¸ªç¨‹åºè¿›å…¥åå°è¿è¡Œçš„é€šçŸ¥ï¼Œç„¶åå®ç°å¯¹åº”é€šçŸ¥çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">colorChangeForAppState</span><span class="params">()</span></span> &#123;</div><div class="line">    observerLabel.backgroundColor = <span class="type">UIColor</span>.<span class="keyword">init</span>(red: <span class="number">168</span>/<span class="number">255</span>, green: <span class="number">21</span>/<span class="number">255</span>, blue: <span class="number">42</span>/<span class="number">255</span>, alpha: <span class="number">1</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬æŒ‰ä¸¤æ¬¡ Home é”®ï¼Œåœ¨ä»»åŠ¡ç®¡ç†ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒLabel çš„é¢œè‰²å·²ç»å‘ç”Ÿæ”¹å˜ã€‚æœ€åï¼Œä¸è¦å¿˜è®°ç§»é™¤è§‚å¯Ÿè€…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceiveMemoryWarning</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.didReceiveMemoryWarning()</div><div class="line">    <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.removeObserver(<span class="keyword">self</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ¯ä¸€ä¸ªè¿è¡Œçš„ Cocoa ç¨‹åºéƒ½æœ‰ä¸€ä¸ªè‡ªå·±ç®¡ç†çš„é»˜è®¤é€šçŸ¥ä¸­å¿ƒ NotificationCenterï¼›</p>
<p>NotificationCenter å¯ä»¥æœ‰è®¸å¤šçš„é€šçŸ¥æ¶ˆæ¯å‘é€è€… NSNotificationï¼›</p>
<p>æ¯ä¸€ä¸ªå‘é€è€… NSNotification å¯ä»¥æœ‰å¾ˆå¤šçš„è§‚å¯Ÿè€… Observer æ¥æ¥æ”¶é€šçŸ¥ã€‚</p>
<p>æ¯ä¸€ä¸ª Notification å¯¹è±¡éƒ½å¿…é¡»å…·æœ‰æœ‰ï¼š</p>
<ul>
<li>nameï¼Œå®ƒæè¿°çš„æ˜¯é€šçŸ¥çš„åç§°ï¼›</li>
<li>object å¯¹è±¡ï¼Œå®ƒè¡¨ç¤ºæ˜¯è°å‘å¸ƒçš„é€šçŸ¥ï¼›</li>
<li>userInfoï¼Œä¸€ä¸ªå­—å…¸ç±»å‹ï¼ŒåŒ…å«å‘å¸ƒè€…è¦ä¼ é€’ç»™é€šçŸ¥æ¥æ”¶è€…çš„ä¸€äº›é¢å¤–å†…å®¹ï¼›</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼ŒUITextField åœ¨æ¯æ¬¡æ–‡æœ¬å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šå‘å‡ºä¸€ä¸ªåä¸º <code>UITextFieldTextDidChangeNotification</code> çš„ NSNotificationï¼Œè¿™ä¸ªé€šçŸ¥å…³è”çš„å¯¹è±¡å°±æ˜¯æ–‡æœ¬æ¡†æœ¬èº«ï¼Œå¯¹äº <code>UIKeyboardWillShowNotification</code> è¿™ä¸ªé€šçŸ¥æ¥è¯´ï¼Œ<code>userInfo</code> ä¸­å­˜å…¥äº† frame çš„ä½ç½®å’ŒåŠ¨ç”»æ—¶é—´ï¼Œå…³è”çš„ <code>object</code> æ˜¯ nilã€‚</p>
<h2 id="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"><a href="#Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ" class="headerlink" title="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"></a>Demoä¸‹è½½è¯·<a href="https://github.com/tianziyao/MyNotification" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a></h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;iOS ä¸­çš„è§‚å¯Ÿè€… Observer æ¨¡å¼åŒ…å«äº†é€šçŸ¥æœºåˆ¶ï¼ˆNotificationï¼‰å’ŒKVOï¼ˆKey-Value-Observingï¼‰æœºåˆ¶ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹è±¡ä¹‹é—´çš„é€šè®¯æœ‰ä»¥ä¸‹å‡ ç§å¸¸è§çš„æ–¹å¼ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Delegateã€Blockã€KVOã€Notificationï¼›&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶ä¸­ Delegate ä½¿ç”¨çš„æ˜¯å§”æ‰˜æœºåˆ¶ï¼Œæ˜¯ä¸€å¯¹ä¸€çš„å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼›è€Œ KVO å’Œ Notification é€šçŸ¥æœºåˆ¶æ˜¯å¹¿æ’­ï¼Œä¹Ÿå°±æ˜¯ä¸€å¯¹å¤šçš„å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ã€‚é‚£ä¹ˆå¯¹è±¡ä¹‹é—´çš„é€šè®¯åˆæ˜¯åšä»€ä¹ˆå‘¢ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯åœ¨ A ç±»ä¸­åˆ›å»ºçš„æ–¹æ³•ï¼Œåœ¨ B ç±»ä¸­æ‰§è¡Œï¼Œä¸” A ç±»å¯ä»¥ä¼ é€’æ•°æ®ç»™ B ç±»ï¼Œæˆ‘ä»¬çŸ¥é“å½“è¯´èµ·é€šçŸ¥æ—¶ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬åœ°é€šçŸ¥ã€æ¨é€é€šçŸ¥ã€å¹¿æ’­é€šçŸ¥ï¼›&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸‰ç§é€šçŸ¥æ˜¯ä¸åŒçš„ï¼Œæœ¬åœ°é€šçŸ¥ä½¿ç”¨çš„æ˜¯ &lt;code&gt;UILocalNotification&lt;/code&gt; å®ç°ï¼Œæ˜¯æˆ‘ä»¬çš„ APP è¿è¡Œæ—¶ï¼Œç»™ç”¨æˆ·çš„é€šçŸ¥ï¼›æ¨é€é€šçŸ¥æ˜¯ä½¿ç”¨ &lt;code&gt;UIUserNotification&lt;/code&gt; å®ç°ï¼Œæ˜¯ç”¨æˆ·åŒæ„æ¨é€åï¼Œç”±æˆ‘ä»¬çš„æœåŠ¡å™¨æäº¤ç»™ APNSï¼Œå†ç”± APNS è½¬å‘ç»™ç”¨æˆ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæˆ‘ä»¬æœ¬æ–‡è¦æ¢è®¨çš„æ˜¯ï¼Œç¨‹åºä¸­çš„å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„é€šçŸ¥ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€é¡¹ï¼Œå¹¿æ’­é€šçŸ¥ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="Notification" scheme="http://yoursite.com/tags/Notification/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¼€å‘ - åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘å¤šä¸ªAPP</title>
    <link href="http://yoursite.com/2016/10/11/iOS%E5%BC%80%E5%8F%91%20-%20%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%B7%A5%E7%A8%8B%E4%B8%AD%E5%BC%80%E5%8F%91%E5%A4%9A%E4%B8%AAAPP/"/>
    <id>http://yoursite.com/2016/10/11/iOSå¼€å‘ - åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­å¼€å‘å¤šä¸ªAPP/</id>
    <published>2016-10-10T18:24:00.000Z</published>
    <updated>2016-10-10T16:49:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ª App åº”ç”¨å¯¹åº”ä¸€ä¸ª<code>Xcode Project</code>ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦åŒæ—¶å¼€å‘å¤šä¸ªäº§å“ï¼Œè€Œè¿™äº›äº§å“ 90% çš„æ•°æ®ç»“æ„ä»¥åŠäº¤äº’æ–¹å¼éƒ½ä¸€æ ·ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰çš„è¿™ä¸¤ä¸ªäº§å“ï¼Œæœ€å¤§çš„ä¸ä¸€æ ·å°±æ˜¯UIå…ƒç´ ä»¥åŠæŸäº›é…è‰²æ—¶ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä¸€ä¸ª App ä¸€ä¸ª<code>Xcode Project</code>ï¼Œæ™®éçš„åšæ³•æ˜¯ï¼š</p>
<p>ä½ ä¼šå…ˆå¼€å‘å®Œæˆä¸€ä¸ªäº§å“ï¼Œç„¶ååœ¨å¤åˆ¶åˆ°å…¶ä»–çš„äº§å“ä¸­ï¼Œéå¸¸çš„éº»çƒ¦è€Œä¸”æ•ˆç‡å¾ˆä½ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ–‡ä»¶å»æ¯”å¯¹ã€‚å¦‚æœä½ ä½¿ç”¨æ¨¡å—çš„æ–¹å¼ï¼Œå¼€å‘å®Œä¸€ä¸ªæ¨¡å—ï¼Œç„¶åå†åˆ©ç”¨<code>Pod</code>çš„æ–¹å¼å¯¼å…¥åˆ°å…¶ä»–äº§å“ä¸­ï¼Œè™½ç„¶è¿™æ ·å¯è¡Œï¼Œä½†æ˜¯æ¶‰åŠåˆ°äº§å“çš„è¿­ä»£å¼€å‘ä»¥åŠäº§å“çš„éšæ—¶ä¼šå˜çš„äº¤äº’ï¼Œæ¨¡å—çš„ç»†åŒ–åˆ†å¾ˆéš¾å®ç°ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿé¢ä¸´è¿™æ ·çš„é—®é¢˜ï¼Œä¸æ”¾è€ƒè™‘ä¸€ä¸‹ä¸‹é¢è®²çš„<code>ä¸€ä¸ªå·¥ç¨‹æ¥å¼€å‘å¤šä¸ªApp</code>ï¼š</p>
   <a id="more"></a>
<h2 id="åˆ›å»ºæ–°çš„Target"><a href="#åˆ›å»ºæ–°çš„Target" class="headerlink" title="åˆ›å»ºæ–°çš„Target"></a>åˆ›å»ºæ–°çš„Target</h2><p> å¦‚æœç°åœ¨ä½ å·²ç»æœ‰ä¸ªä¸€ä¸ªäº§å“å«<code>ProjectOfApps</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161010-0.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161010-0"></p>
<p>è¿™æ—¶ä½ æƒ³æ·»åŠ ä¸€ä¸ªå«<code>ProjectOfApps_B</code>çš„äº§å“ï¼Œä½ éœ€è¦åšçš„æ˜¯æŒ‰å¦‚ä¸‹çš„æ­¥å¥è¿›è¡Œåˆ›å»ºï¼š é€‰æ‹©<code>Project -&gt; Targets -&gt; å³å‡»ProjectOfApps -&gt; é€‰æ‹©Duplicate</code>ï¼Œè¿™æ—¶æˆ‘ä»¬å°±æŒ‰ç…§<code>ProjectOfApps</code>å¤åˆ¶äº†ä¸€ä¸ªäº§å“<code>ProjectOfApps copy</code>ï¼Œå¹¶ä¸”ä½ ä¼šçœ‹åˆ°å¤šå‡ºäº†ä¸€ä¸ªæ–‡ä»¶<code>ProjectOfApps copy-Info.plist</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161010-1.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161010-1"></p>
<p>åŒå‡»<code>ProjectOfApps copy</code>æˆ–é€‰ä¸­å›è½¦ï¼Œå°† Target åæ”¹ä¸º <code>ProjectOfApps_B</code>ã€‚</p>
<h2 id="ç¼–è¾‘Plistæ–‡ä»¶"><a href="#ç¼–è¾‘Plistæ–‡ä»¶" class="headerlink" title="ç¼–è¾‘Plistæ–‡ä»¶"></a>ç¼–è¾‘Plistæ–‡ä»¶</h2><p>å½“æˆ‘ä»¬åˆ›å»ºæ–°çš„<code>Target</code>åä¼šå¤šå‡ºä¸€ä¸ª<code>ProjectOfApps copy-Info.plist</code>æ–‡ä»¶ï¼Œè¿™ä¸ª<code>plist</code>æ–‡ä»¶å°±æ˜¯æ§åˆ¶<code>ProjectOfApps_B</code>çš„åç§°ï¼Œç‰ˆæœ¬ç­‰ä¿¡æ¯çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸ºäº†ç»Ÿä¸€å°†ä»–æ”¹ä¸º<code>ProjectOfApps_B-Info.plist</code>ï¼Œåœ¨ä¿®æ”¹åå­—ä¹‹å‰ä½ éœ€è¦åœ¨<code>ProjectOfApps_B</code>çš„<code>Build Settings</code>ä¸­æ‰¾åˆ°<code>ProjectOfApps copy-Info.plist</code>ä¸€é¡¹ï¼Œå¾…ä¼šå„¿æˆ‘ä»¬ä¿®æ”¹å®Œè¿™ä¸ª<code>plist</code>æ–‡ä»¶ä»¥åï¼Œè¿˜éœ€è¦åœ¨è¿™é‡Œå¡«å…¥å®ƒæ­£åˆ‡çš„ä½ç½®ä¿¡æ¯ã€‚è¿™æ ·ç¨‹åºæ‰§è¡Œæ—¶æ‰èƒ½æ‰¾åˆ°å®ƒï¼Œä¸ç„¶ç¨‹åºæ˜¯ä¸èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼š</p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161010-2.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161010-2"></p>
<p>æˆ‘ä»¬çš„åŸé¡¹ç›®<code>ProjectOfApps</code>ä¹Ÿå¯ä»¥è¿™æ ·ä¿®æ”¹ï¼Œæ¥è¾¾åˆ°å‘½åçš„ç»Ÿä¸€ã€‚å¦‚æœæœ‰å¿…è¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹<code>plist</code>æ–‡ä»¶é‡Œé¢çš„é€‰é¡¹ä»¥ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œå’Œ<code>Info.plist</code>çš„ä½¿ç”¨å¹¶æ— ä¸åŒã€‚</p>
<h2 id="åˆ¤æ–­å½“å‰ç¼–è¯‘çš„-Target"><a href="#åˆ¤æ–­å½“å‰ç¼–è¯‘çš„-Target" class="headerlink" title="åˆ¤æ–­å½“å‰ç¼–è¯‘çš„ Target"></a>åˆ¤æ–­å½“å‰ç¼–è¯‘çš„ Target</h2><p>ç°åœ¨æˆ‘ä»¬çš„å·¥ç¨‹é‡Œé¢åŒæ—¶åŒ…å«äº†ä¸¤ä¸ª<code>Target</code>ï¼Œç°åœ¨å·¥ç¨‹é‡Œé¢çš„ç±»æ˜¯è¿™ä¸¤ä¸ª<code>Target</code>å…¬ç”¨çš„ï¼Œå¦‚æœä½ æƒ³åœ¨ä¸€ä¸ªç±»é‡Œé¢åŒºåˆ†æ˜¯<code>ProjectOfApps_A</code>è¿˜æ˜¯<code>ProjectOfApps_B</code>ï¼Œæ ¹æ®å¼€å‘è¯­è¨€çš„ä¸åŒæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<h3 id="Objective-C"><a href="#Objective-C" class="headerlink" title="Objective - C"></a>Objective - C</h3><p>Objective - C éœ€è¦è®¾ç½®<code>Preprocessor Macros</code>ï¼Œå®ƒçš„å®šä¹‰å¾ˆç®€å•ï¼Œé€‰ä¸­ä¸€ä¸ª<code>Target</code>ï¼Œç„¶ååœ¨<code>Build Settings</code>é‡Œé¢æœç´¢<code>Preprocessor Macros</code>ä¸€é¡¹ï¼Œç„¶ååœ¨é‡Œé¢æ·»åŠ è¡¨æ˜æ˜¯<code>ProjectOfApps_A</code>çš„å®ï¼š </p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161010-3.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161010-3"></p>
<p>ç„¶åå°±å¯ä»¥åˆ¤æ–­å½“å‰ç¼–è¯‘çš„ Target æ˜¯å“ªä¸€ä¸ªäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (void)someFunction </div><div class="line">&#123;</div><div class="line">#ifdef ProjectOfApps_A</div><div class="line">    NSLog(@&quot;Build For Target ProjectOfApps_A!&quot;);</div><div class="line">#else</div><div class="line">    NSLog(@&quot;Build For Target ProjectOfApps_B!&quot;);</div><div class="line">#endif</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h3><p>Swift ä¸‹çš„å¤„ç†å’Œ Objective - C æœ‰æ‰€ä¸åŒï¼Œéœ€è¦è®¾ç½®<code>Custom Flags</code>ï¼Œé€‰ä¸­ä¸€ä¸ª<code>Target</code>ï¼Œç„¶ååœ¨<code>Build Settings</code>é‡Œé¢æœç´¢<code>Custom Flags</code>ä¸€é¡¹ï¼Œç„¶ååœ¨é‡Œé¢æ·»åŠ è¡¨æ˜æ˜¯<code>ProjectOfApps_A</code>çš„å®ï¼š</p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161011-0.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161011-0"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè¦ä½¿ç”¨<code>ï¼D</code>çš„æ ¼å¼ã€‚å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">someFunction</span><span class="params">()</span></span> &#123;</div><div class="line">    #<span class="keyword">if</span> <span class="type">ProjectOfApps_A</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Build For Target ProjectOfApps_A!"</span>)</div><div class="line">    #elseif <span class="type">ProjectOfApps_B</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Build For Target ProjectOfApps_B!"</span>)</div><div class="line">    #<span class="keyword">else</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Other"</span>)</div><div class="line">    #endif</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä¿®æ”¹Scheme"><a href="#ä¿®æ”¹Scheme" class="headerlink" title="ä¿®æ”¹Scheme"></a>ä¿®æ”¹Scheme</h2><p>ç°åœ¨çš„ Scheme è¿˜æ˜¯<code>ProjectOfApps copy</code>å’Œ<code>ProjectOfApps</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Manage Schemes</code>å°†ä¸¤ä¸ª Scheme ä¿®æ”¹ä¸€ä¸‹ï¼š </p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161011-1.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161011-1"></p>
<h2 id="èµ„æºæ–‡ä»¶å’Œç±»æ–‡ä»¶"><a href="#èµ„æºæ–‡ä»¶å’Œç±»æ–‡ä»¶" class="headerlink" title="èµ„æºæ–‡ä»¶å’Œç±»æ–‡ä»¶"></a>èµ„æºæ–‡ä»¶å’Œç±»æ–‡ä»¶</h2><p>å¦‚æœéœ€è¦ä¸ºä¸åŒçš„ Target åŒºåˆ«ä¸åŒçš„èµ„æºæ–‡ä»¶å’Œç±»æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ Xcode çš„<code>Target Membership</code>åŠŸèƒ½ï¼Œæ¥é€‰æ‹©è¯¥ç±»å±äºå“ªä¸ª<code>Target</code>ã€‚Assetsã€æ§ä»¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ </p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/QQ20161011-2.png" alt="http://oboehz2ag.bkt.clouddn.com/QQ20161011-2"></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://summertreee.github.io/blog/2016/01/23/ioszhong-ru-he-zai-%5B%3F%5D-ge-gong-cheng-chuang-jian-duo-ge-app/" target="_blank" rel="external">iOSä¸­å¦‚ä½•åœ¨ä¸€ä¸ªå·¥ç¨‹åˆ›å»ºå¤šä¸ªApp</a> - å¤æ ‘æ­£èŒ‚</p>
<p><a href="http://stackoverflow.com/questions/24003291/ifdef-replacement-in-swift-language" target="_blank" rel="external">#ifdef replacement in swift language</a> - stackoverflow</p>
<h2 id="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"><a href="#Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ" class="headerlink" title="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"></a>Demoä¸‹è½½è¯·<a href="https://github.com/tianziyao/ProjectOfApps" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a></h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ª App åº”ç”¨å¯¹åº”ä¸€ä¸ª&lt;code&gt;Xcode Project&lt;/code&gt;ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦åŒæ—¶å¼€å‘å¤šä¸ªäº§å“ï¼Œè€Œè¿™äº›äº§å“ 90% çš„æ•°æ®ç»“æ„ä»¥åŠäº¤äº’æ–¹å¼éƒ½ä¸€æ ·ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰çš„è¿™ä¸¤ä¸ªäº§å“ï¼Œæœ€å¤§çš„ä¸ä¸€æ ·å°±æ˜¯UIå…ƒç´ ä»¥åŠæŸäº›é…è‰²æ—¶ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä¸€ä¸ª App ä¸€ä¸ª&lt;code&gt;Xcode Project&lt;/code&gt;ï¼Œæ™®éçš„åšæ³•æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;ä½ ä¼šå…ˆå¼€å‘å®Œæˆä¸€ä¸ªäº§å“ï¼Œç„¶ååœ¨å¤åˆ¶åˆ°å…¶ä»–çš„äº§å“ä¸­ï¼Œéå¸¸çš„éº»çƒ¦è€Œä¸”æ•ˆç‡å¾ˆä½ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ–‡ä»¶å»æ¯”å¯¹ã€‚å¦‚æœä½ ä½¿ç”¨æ¨¡å—çš„æ–¹å¼ï¼Œå¼€å‘å®Œä¸€ä¸ªæ¨¡å—ï¼Œç„¶åå†åˆ©ç”¨&lt;code&gt;Pod&lt;/code&gt;çš„æ–¹å¼å¯¼å…¥åˆ°å…¶ä»–äº§å“ä¸­ï¼Œè™½ç„¶è¿™æ ·å¯è¡Œï¼Œä½†æ˜¯æ¶‰åŠåˆ°äº§å“çš„è¿­ä»£å¼€å‘ä»¥åŠäº§å“çš„éšæ—¶ä¼šå˜çš„äº¤äº’ï¼Œæ¨¡å—çš„ç»†åŒ–åˆ†å¾ˆéš¾å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä¹Ÿé¢ä¸´è¿™æ ·çš„é—®é¢˜ï¼Œä¸æ”¾è€ƒè™‘ä¸€ä¸‹ä¸‹é¢è®²çš„&lt;code&gt;ä¸€ä¸ªå·¥ç¨‹æ¥å¼€å‘å¤šä¸ªApp&lt;/code&gt;ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="Custom Flags" scheme="http://yoursite.com/tags/Custom-Flags/"/>
    
  </entry>
  
  <entry>
    <title>Xcodeé”™è¯¯ - Pch file not found</title>
    <link href="http://yoursite.com/2016/09/26/Xcode%E9%94%99%E8%AF%AF%20-%20Pch%20file%20not%20found/"/>
    <id>http://yoursite.com/2016/09/26/Xcodeé”™è¯¯ - Pch file not found/</id>
    <published>2016-09-25T21:46:00.000Z</published>
    <updated>2016-09-26T10:45:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç§é—®é¢˜å‡ºç°çš„åŸå› å¤§å¤šæ˜¯è·¯å¾„é—®é¢˜ï¼Œå½“ Mac æ‹·è´äº†å·¥ç¨‹æˆ–æ˜¯å·¥ç¨‹çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¼è‡´ Pch æ–‡ä»¶çš„è·¯å¾„å‡ºé”™ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ol>
<li><code>Targets -&gt; Build Settings -&gt; Apple llvm - Language</code> ï¼Œå°†é¡¹ç›®é‡Œçš„çš„ Pch æ–‡ä»¶ç›´æ¥æ‹–åˆ°è¿™è¾¹ï¼Œè®¾ç½®ä¸º YESï¼›</li>
<li><code>âŒ˜ + â‡§ + K</code> æ¸…é™¤å·¥ç¨‹ï¼›</li>
<li><code>âŒ˜ + B</code> ç¼–è¯‘å·¥ç¨‹ï¼›</li>
</ol>
<p><img src="http://oboehz2ag.bkt.clouddn.com/pchnotfound.png" alt="pchnotfound"></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://stackoverflow.com/questions/25840720/xcode-6-pch-file-not-found" target="_blank" rel="external">http://stackoverflow.com/questions/25840720/xcode-6-pch-file-not-found</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ç§é—®é¢˜å‡ºç°çš„åŸå› å¤§å¤šæ˜¯è·¯å¾„é—®é¢˜ï¼Œå½“ Mac æ‹·è´äº†å·¥ç¨‹æˆ–æ˜¯å·¥ç¨‹çš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¼è‡´ Pch æ–‡ä»¶çš„è·¯å¾„å‡ºé”™ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Targets -&amp;gt; Build Settings -&amp;gt; Apple llvm - Langua
    
    </summary>
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/categories/Xcode%E9%94%99%E8%AF%AF/"/>
    
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/tags/Xcode%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>Xcodeé”™è¯¯ - Expected a type</title>
    <link href="http://yoursite.com/2016/09/15/Xcode%E9%94%99%E8%AF%AF%20-%20Expected%20a%20type%20/"/>
    <id>http://yoursite.com/2016/09/15/Xcodeé”™è¯¯ - Expected a type /</id>
    <published>2016-09-14T18:24:00.000Z</published>
    <updated>2016-11-26T01:15:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>éœ€è¦è‡ªå·±æ‰‹åŠ¨å¯¼å…¥åº“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;UIKit/UIKit.h&gt;</div></pre></td></tr></table></figure>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="http://stackoverflow.com/questions/26412635/ios-8-expected-a-type" target="_blank" rel="external">http://stackoverflow.com/questions/26412635/ios-8-expected-a-type</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;éœ€è¦è‡ªå·±æ‰‹åŠ¨å¯¼å…¥åº“ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;p
    
    </summary>
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/categories/Xcode%E9%94%99%E8%AF%AF/"/>
    
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/tags/Xcode%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å¼€å‘ - access_token</title>
    <link href="http://yoursite.com/2016/09/05/%E5%BE%AE%E4%BF%A1%E6%8E%A5%E5%8F%A3%20-%20access%20token/"/>
    <id>http://yoursite.com/2016/09/05/å¾®ä¿¡æ¥å£ - access token/</id>
    <published>2016-09-04T18:24:00.000Z</published>
    <updated>2016-09-05T12:08:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æ¥å£å¼€å‘ä¸­ï¼Œaccess_tokenå æ®äº†ä¸€ä¸ªå¾ˆé‡è¦çš„åœ°ä½ï¼Œå®ƒç›¸å½“äºè¿›å…¥å„ç§æ¥å£çš„é’¥åŒ™ï¼Œæ‹¿åˆ°è¿™ä¸ªé’¥åŒ™æ‰æœ‰è°ƒç”¨å…¶ä»–å„ç§ç‰¹æ®Šæ¥å£çš„æƒé™ã€‚</p>
<p>åŒæ ·å¾®ä¿¡æœåŠ¡å™¨ä¹Ÿæ˜¯é€šè¿‡access_tokenè¯†åˆ«æ˜¯å“ªä¸ªå…¬ä¼—å·ï¼Œä»¥åŠè¯¥å…¬ä¼—å·æ˜¯å¦æœ‰æƒé™è°ƒç”¨è¯¥æ¥å£ã€‚</p>
<p>access_tokenæ˜¯å…¬ä¼—å·çš„å…¨å±€å”¯ä¸€æ¥å£è°ƒç”¨å‡­æ®ï¼Œå…¬ä¼—å·è°ƒç”¨å„æ¥å£æ—¶éƒ½éœ€ä½¿ç”¨access_tokenã€‚å¼€å‘è€…éœ€è¦è¿›è¡Œå¦¥å–„ä¿å­˜ã€‚access_tokençš„å­˜å‚¨è‡³å°‘è¦ä¿ç•™512ä¸ªå­—ç¬¦ç©ºé—´ã€‚access_tokençš„æœ‰æ•ˆæœŸç›®å‰ä¸º2ä¸ªå°æ—¶ï¼Œéœ€å®šæ—¶åˆ·æ–°ï¼Œé‡å¤è·å–å°†å¯¼è‡´ä¸Šæ¬¡è·å–çš„access_tokenå¤±æ•ˆã€‚</p>
<p><strong>å…¬ä¼—å·å¯ä»¥ä½¿ç”¨AppIDå’ŒAppSecretè°ƒç”¨æœ¬æ¥å£æ¥è·å–access_tokenã€‚AppIDå’ŒAppSecretå¯åœ¨å¼€å‘æ¨¡å¼ä¸­è·å¾—ï¼Œæ³¨æ„è°ƒç”¨æ‰€æœ‰å¾®ä¿¡æ¥å£æ—¶å‡éœ€ä½¿ç”¨httpsåè®®ã€‚</strong></p>
   <a id="more"></a>
<h2 id="access-tokenå¼€å‘ç­–ç•¥"><a href="#access-tokenå¼€å‘ç­–ç•¥" class="headerlink" title="access_tokenå¼€å‘ç­–ç•¥"></a>access_tokenå¼€å‘ç­–ç•¥</h2><p>å› ä¸ºaccess_tokenå…·æœ‰æ¯å¤©2000æ¬¡çš„è®¿é—®é™åˆ¶ï¼Œè€Œaccess_tokenåˆæ˜¯å¾ˆé‡è¦çš„å±æ€§ï¼Œè°ƒç”¨éå¸¸é¢‘ç¹ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„æ¥å£éƒ½éœ€è¦ä½¿ç”¨access_tokenæ¥è¿›è¡Œè®¿é—®æƒé™çš„éªŒè¯ï¼Œå½“é¢‘ç¹è°ƒç”¨å¾®ä¿¡APIæ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šè¶…å‡º2000æ¬¡çš„é™åˆ¶ã€‚å› æ­¤æ™®éçš„è§£å†³æ–¹æ¡ˆæ˜¯å°†ä¸€æ¬¡è·å–çš„access_tokenä¿å­˜åˆ°æ•°æ®åº“ï¼Œåœ¨ä¸¤ä¸ªå°æ—¶åå†æ›´æ–°æ•°æ®åº“ï¼Œåœ¨è¿™ä¸¤ä¸ªå°æ—¶å†…ï¼Œæ‰€æœ‰éœ€è¦access_tokençš„åœ°æ–¹å…¨éƒ¨åˆ°æ•°æ®åº“æ¥å–ã€‚ </p>
<p><img src="http://oboehz2ag.bkt.clouddn.com/access_token%E5%BC%80%E5%8F%91%E7%AD%96%E7%95%A5.gif" alt="access_tokenå¼€å‘ç­–ç•¥"></p>
<h2 id="æ¥å£è°ƒç”¨è¯·æ±‚è¯´æ˜"><a href="#æ¥å£è°ƒç”¨è¯·æ±‚è¯´æ˜" class="headerlink" title="æ¥å£è°ƒç”¨è¯·æ±‚è¯´æ˜"></a>æ¥å£è°ƒç”¨è¯·æ±‚è¯´æ˜</h2><p>ä½¿ç”¨HTTPè¯·æ±‚ï¼Œè¯·æ±‚æ–¹å¼ä¸ºGETï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=APPID&amp;secret=APPSECRET</div></pre></td></tr></table></figure>
<p>è¯·æ±‚ä¸­é™„å¸¦çš„å‚æ•°ä¸ºï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æ˜¯å¦å¿…é¡»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>grant_type</td>
<td>æ˜¯</td>
<td>è·å–access_tokenå¡«å†™client_credential</td>
</tr>
<tr>
<td>appid</td>
<td>æ˜¯</td>
<td>ç¬¬ä¸‰æ–¹ç”¨æˆ·å”¯ä¸€å‡­è¯</td>
</tr>
<tr>
<td>secret</td>
<td>æ˜¯</td>
<td>ç¬¬ä¸‰æ–¹ç”¨æˆ·å”¯ä¸€å‡­è¯å¯†é’¥ï¼Œå³appsecret</td>
</tr>
</tbody>
</table>
<h2 id="è¿”å›è¯´æ˜"><a href="#è¿”å›è¯´æ˜" class="headerlink" title="è¿”å›è¯´æ˜"></a>è¿”å›è¯´æ˜</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¾®ä¿¡ä¼šè¿”å›ä¸‹è¿°JSONæ•°æ®åŒ…ç»™å…¬ä¼—å·ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="attr">"access_token"</span>:<span class="string">"ACCESS_TOKEN"</span>,<span class="attr">"expires_in"</span>:<span class="number">7200</span>&#125;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>access_token</td>
<td>è·å–åˆ°çš„å‡­è¯</td>
</tr>
<tr>
<td>expires_in</td>
<td>å‡­è¯æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ï¼šç§’</td>
</tr>
</tbody>
</table>
<h2 id="è·å–ç²‰ä¸å¤´åƒ"><a href="#è·å–ç²‰ä¸å¤´åƒ" class="headerlink" title="è·å–ç²‰ä¸å¤´åƒ"></a>è·å–ç²‰ä¸å¤´åƒ</h2><p>ä¸‹é¢æˆ‘ä»¬ç”¨è·å–ç²‰ä¸å¤´åƒçš„ä¾‹å­æ¥æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨access_tokenã€‚</p>
<p>é¦–å…ˆå†™ä¸€ä¸ªPHPæ–‡ä»¶ï¼Œæ¥è·å–access_tokenï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">getaccesstoken.php</div><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">define(<span class="string">'appid'</span>, <span class="string">'wx5d649f3295ce323a'</span>);</div><div class="line">define(<span class="string">'app_secret'</span>, <span class="string">'a17ecddd3fb0699814fce90fa6376b8e'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_access_token</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    $url = <span class="string">"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid="</span>.appid.<span class="string">"&amp;secret="</span>.app_secret;</div><div class="line">    <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">    $ch = curl_init();</div><div class="line">    <span class="comment">//è®¾ç½®é€‰é¡¹ï¼ŒåŒ…æ‹¬URL</span></div><div class="line">    curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_USERAGENT, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_ENCODING, <span class="string">"gzip"</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">//æ‰§è¡Œå¹¶è·å–HTMLæ–‡æ¡£å†…å®¹</span></div><div class="line">    $output = curl_exec($ch);</div><div class="line">    <span class="comment">//é‡Šæ”¾curlå¥æŸ„</span></div><div class="line">    curl_close($ch);</div><div class="line">    <span class="comment">//æ‰“å°è·å¾—çš„æ•°æ®</span></div><div class="line">    <span class="comment">//print_r($output);</span></div><div class="line">    $access_taken_arr = json_decode($output, <span class="keyword">true</span>);</div><div class="line">    $access_token = $access_taken_arr[<span class="string">"access_token"</span>];</div><div class="line">    <span class="comment">//print_r($access_taken_arr);</span></div><div class="line">    <span class="keyword">return</span> $access_token;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ–°å»ºå¦ä¸€ä¸ªPHPæ–‡ä»¶ï¼Œé¦–å…ˆè·å–ç²‰ä¸åˆ—è¡¨ï¼Œæå–å‡ºç²‰ä¸çš„openidç»„æˆæ•°ç»„ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_user_list</span><span class="params">($access_token)</span> </span>&#123;</div><div class="line"></div><div class="line">    $url = <span class="string">"https://api.weixin.qq.com/cgi-bin/user/get?access_token="</span>.$access_token;</div><div class="line">    <span class="comment">//echo $access_token;</span></div><div class="line">    <span class="comment">//åˆå§‹åŒ–</span></div><div class="line">    $ch = curl_init();</div><div class="line">    <span class="comment">//è®¾ç½®é€‰é¡¹ï¼ŒåŒ…æ‹¬URL</span></div><div class="line">    curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_USERAGENT, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_ENCODING, <span class="string">"gzip"</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">//æ‰§è¡Œå¹¶è·å–HTMLæ–‡æ¡£å†…å®¹</span></div><div class="line">    $output = curl_exec($ch);</div><div class="line">    <span class="comment">//é‡Šæ”¾curlå¥æŸ„</span></div><div class="line">    curl_close($ch);</div><div class="line">    <span class="comment">//æ‰“å°è·å¾—çš„æ•°æ®</span></div><div class="line">    <span class="comment">//print_r($output);</span></div><div class="line">    $user_list_arr = json_decode($output, <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> ($user_list_arr[<span class="string">"data"</span>][<span class="string">"openid"</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶ååˆ©ç”¨openidè·å–ç²‰ä¸çš„ç”¨æˆ·ä¿¡æ¯ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_user_info</span><span class="params">($access_token, $openid)</span> </span>&#123;</div><div class="line"></div><div class="line">    $url = <span class="string">"https://api.weixin.qq.com/cgi-bin/user/info?access_token="</span>.$access_token.<span class="string">"&amp;openid="</span>.$openid.<span class="string">"&amp;lang=zh_CN"</span>;</div><div class="line"></div><div class="line">    $ch = curl_init();</div><div class="line">    curl_setopt($ch, CURLOPT_URL, $url);</div><div class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_USERAGENT, <span class="number">1</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_ENCODING, <span class="string">"gzip"</span>);</div><div class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    $output = curl_exec($ch);</div><div class="line">    curl_close($ch);</div><div class="line"></div><div class="line">    $user_info_arr = json_decode($output, <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> ($user_info_arr[<span class="string">"headimgurl"</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åä»ç”¨æˆ·ä¿¡æ¯ä¸­æå–å‡ºç”¨æˆ·å¤´åƒçš„urlï¼Œå¹¶ä¼ ç»™iOSå®¢æˆ·ç«¯ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;<span class="number">3</span>; $i++) &#123;</div><div class="line">    $openid = $openids[$i];</div><div class="line">    $use_info = get_user_info($access_token, $openid);</div><div class="line">    $user_image = substr($use_info, <span class="number">0</span>, strlen($str)<span class="number">-2</span>).<span class="string">"/132"</span>;</div><div class="line">    <span class="comment">//echo $user_image;</span></div><div class="line">    array_push($user_images, $user_image);</div><div class="line">&#125;</div><div class="line"><span class="keyword">echo</span> json_encode($user_images);</div></pre></td></tr></table></figure>
<p>åœ¨Xcodeä¸­åˆ›å»ºå·¥ç¨‹ï¼Œä½¿ç”¨NSURLSessionè·å–PHPæœåŠ¡å™¨ä¼ æ¥çš„åŒ…å«ç²‰ä¸å¤´åƒurlçš„æ•°ç»„ï¼Œåˆ©ç”¨urlè·å–ç²‰ä¸å¤´åƒï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºå·¥ç¨‹ä¸­ImageViewçš„Imageï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>UIæ“ä½œè¦è½¬åˆ°ä¸»çº¿ç¨‹è¿›è¡Œ</strong>ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">getWechatFansHeadImgs</span><span class="params">()</span></span> &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.pleaseWait()</div><div class="line">        </div><div class="line">        <span class="comment">//let request = NSURLRequest(URL: NSURL(string: "http://localhost:8888/i/wechat/getuserinfo.php")!)</span></div><div class="line">        <span class="keyword">let</span> request = <span class="type">NSURLRequest</span>(<span class="type">URL</span>: <span class="type">NSURL</span>(string: <span class="string">"http://123.206.27.127/wechat/getuserinfo.php"</span>)!)</div><div class="line"></div><div class="line">        <span class="keyword">let</span> task = <span class="type">NSURLSession</span>.sharedSession().dataTaskWithRequest(request) &#123; (data, resp, error) <span class="keyword">in</span></div><div class="line">            </div><div class="line">            <span class="keyword">if</span> error != <span class="literal">nil</span> &#123;</div><div class="line">                <span class="built_in">print</span>(error?.localizedDescription)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">var</span> imgLinks: [<span class="type">String</span>] = []</div><div class="line">                <span class="keyword">let</span> readingOprions = <span class="type">NSJSONReadingOptions</span>.<span class="type">MutableContainers</span></div><div class="line">                imgLinks = <span class="keyword">try</span>! <span class="type">NSJSONSerialization</span>.<span class="type">JSONObjectWithData</span>(data!, options: readingOprions) <span class="keyword">as</span>! <span class="type">Array</span><span class="comment">//nil</span></div><div class="line">                <span class="built_in">print</span>(imgLinks)</div><div class="line">                </div><div class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;imgLinks.<span class="built_in">count</span> &#123;</div><div class="line">                    <span class="keyword">if</span> imgLinks[i] != <span class="string">""</span> &#123;</div><div class="line">                        <span class="keyword">let</span> data = <span class="type">NSData</span>(contentsOfURL: <span class="type">NSURL</span>(string: imgLinks[i])!)</div><div class="line">                        dispatch_async(dispatch_get_main_queue(), &#123;</div><div class="line">                            <span class="keyword">self</span>.headImageViews[i].image = data != <span class="literal">nil</span> ? <span class="type">UIImage</span>(data: data!) : <span class="literal">nil</span></div><div class="line">                            <span class="built_in">print</span>(i)</div><div class="line">                        &#125;)</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                </div><div class="line">                <span class="built_in">print</span>(<span class="type">NSThread</span>.currentThread())</div><div class="line">                dispatch_async(dispatch_get_main_queue(), &#123;</div><div class="line">                    <span class="keyword">self</span>.clearAllNotice()</div><div class="line">                    <span class="keyword">self</span>.noticeSuccess(<span class="string">"è·å–æˆåŠŸ"</span>, autoClear: <span class="literal">true</span>, autoClearTime: <span class="number">2</span>)</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        task.resume()</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æœ€åä½¿ç”¨ç‚¹å‡»äº‹ä»¶è§¦å‘è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">showHeadImageButtonDidTouch</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line">    </div><div class="line">    getWechatFansHeadImgs()</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"><a href="#Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ" class="headerlink" title="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"></a>Demoä¸‹è½½è¯·<a href="https://github.com/tianziyao/demo" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a></h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æ¥å£å¼€å‘ä¸­ï¼Œaccess_tokenå æ®äº†ä¸€ä¸ªå¾ˆé‡è¦çš„åœ°ä½ï¼Œå®ƒç›¸å½“äºè¿›å…¥å„ç§æ¥å£çš„é’¥åŒ™ï¼Œæ‹¿åˆ°è¿™ä¸ªé’¥åŒ™æ‰æœ‰è°ƒç”¨å…¶ä»–å„ç§ç‰¹æ®Šæ¥å£çš„æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·å¾®ä¿¡æœåŠ¡å™¨ä¹Ÿæ˜¯é€šè¿‡access_tokenè¯†åˆ«æ˜¯å“ªä¸ªå…¬ä¼—å·ï¼Œä»¥åŠè¯¥å…¬ä¼—å·æ˜¯å¦æœ‰æƒé™è°ƒç”¨è¯¥æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;access_tokenæ˜¯å…¬ä¼—å·çš„å…¨å±€å”¯ä¸€æ¥å£è°ƒç”¨å‡­æ®ï¼Œå…¬ä¼—å·è°ƒç”¨å„æ¥å£æ—¶éƒ½éœ€ä½¿ç”¨access_tokenã€‚å¼€å‘è€…éœ€è¦è¿›è¡Œå¦¥å–„ä¿å­˜ã€‚access_tokençš„å­˜å‚¨è‡³å°‘è¦ä¿ç•™512ä¸ªå­—ç¬¦ç©ºé—´ã€‚access_tokençš„æœ‰æ•ˆæœŸç›®å‰ä¸º2ä¸ªå°æ—¶ï¼Œéœ€å®šæ—¶åˆ·æ–°ï¼Œé‡å¤è·å–å°†å¯¼è‡´ä¸Šæ¬¡è·å–çš„access_tokenå¤±æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…¬ä¼—å·å¯ä»¥ä½¿ç”¨AppIDå’ŒAppSecretè°ƒç”¨æœ¬æ¥å£æ¥è·å–access_tokenã€‚AppIDå’ŒAppSecretå¯åœ¨å¼€å‘æ¨¡å¼ä¸­è·å¾—ï¼Œæ³¨æ„è°ƒç”¨æ‰€æœ‰å¾®ä¿¡æ¥å£æ—¶å‡éœ€ä½¿ç”¨httpsåè®®ã€‚&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/tags/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å¼€å‘ - æ¥å£ç®€ä»‹</title>
    <link href="http://yoursite.com/2016/09/05/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%20-%20%E6%8E%A5%E5%8F%A3%E7%AE%80%E4%BB%8B/"/>
    <id>http://yoursite.com/2016/09/05/å¾®ä¿¡å¼€å‘ - æ¥å£ç®€ä»‹/</id>
    <published>2016-09-04T18:24:00.000Z</published>
    <updated>2016-09-05T12:05:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºç”¨æˆ·ä½“éªŒå’Œå®‰å…¨æ€§æ–¹é¢çš„è€ƒè™‘ï¼Œå¾®ä¿¡å…¬ä¼—å·çš„æ³¨å†Œæœ‰ä¸€å®šé—¨æ§›ï¼ŒæŸäº›é«˜çº§æ¥å£çš„æƒé™éœ€è¦å¾®ä¿¡è®¤è¯åæ‰å¯ä»¥è·å–ã€‚æ‰€ä»¥ï¼Œä¸ºäº†å¸®åŠ©å¼€å‘è€…å¿«é€Ÿäº†è§£å’Œä¸Šæ‰‹å¾®ä¿¡å…¬ä¼—å·å¼€å‘ï¼Œç†Ÿæ‚‰å„ä¸ªæ¥å£çš„è°ƒç”¨ï¼Œéœ€è¦å¼€é€šæµ‹è¯•è´¦å·ã€‚</p>
<p>å¼€é€šæµ‹è¯•è´¦å·çš„è·¯å¾„ä¸ºï¼š</p>
<blockquote>
<p>å¾®ä¿¡å…¬ä¼—å¹³å° &gt; å¼€å‘è€…å·¥å…· &gt; å…¬ä¼—å¹³å°æµ‹è¯•å¸å· &gt; è¿›å…¥</p>
</blockquote>
<p>æˆ–ç‚¹å‡»<a href="http://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index" target="_blank" rel="external">ä¼ é€é—¨</a>ï¼Œéœ€è¦å¡«å†™çš„ä¸ºä»¥ä¸‹å‡ é¡¹ï¼š</p>
<blockquote>
<p>URLï¼šæ¥å£æ–‡æ¡£æ‰€åœ¨çš„è·¯å¾„ï¼Œå¦‚ï¼š<code>https://localhost/filepath/wxapifile.php</code></p>
<p>Tokenï¼šæ¥å£æ–‡æ¡£ä¸­è®¾å®šçš„Token</p>
<p>åŸŸåï¼šç½‘å€æˆ–ä¸»æœºåï¼Œå¦‚ï¼š<code>localhost</code></p>
</blockquote>
<p>å¦‚å¯¹ä»¥ä¸Šæ­¥éª¤é™Œç”Ÿçš„åŒå­¦å¯ä»¥å…ˆçœ‹<a href="https://tianziyao.github.io/2016/09/02/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%20-%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
   <a id="more"></a>
<h2 id="æ¥å£é¢‘ç‡é™åˆ¶"><a href="#æ¥å£é¢‘ç‡é™åˆ¶" class="headerlink" title="æ¥å£é¢‘ç‡é™åˆ¶"></a>æ¥å£é¢‘ç‡é™åˆ¶</h2><p>å…¬ä¼—å·è°ƒç”¨æ¥å£å¹¶ä¸æ˜¯æ— é™åˆ¶çš„ã€‚ä¸ºäº†é˜²æ­¢å…¬ä¼—å·çš„ç¨‹åºé”™è¯¯è€Œå¼•å‘å¾®ä¿¡æœåŠ¡å™¨è´Ÿè½½å¼‚å¸¸ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå…¬ä¼—å·è°ƒç”¨æ¥å£éƒ½ä¸èƒ½è¶…è¿‡ä¸€å®šé™åˆ¶ï¼Œå½“è¶…è¿‡ä¸€å®šé™åˆ¶æ—¶ï¼Œè°ƒç”¨å¯¹åº”æ¥å£ä¼šæ”¶åˆ°å¦‚ä¸‹é”™è¯¯è¿”å›ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;errcode&quot;:45009,&quot;errmsg&quot;:&quot;api freq out of limit&quot;&#125;</div></pre></td></tr></table></figure>
<p>æ¥å£é¢‘ç‡é™åˆ¶çš„è¯´æ˜è¯·ç‚¹å‡»<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433744592&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">ä¼ é€é—¨</a>ã€‚</p>
<h2 id="å…¨å±€è¿”å›ç "><a href="#å…¨å±€è¿”å›ç " class="headerlink" title="å…¨å±€è¿”å›ç "></a>å…¨å±€è¿”å›ç </h2><p>å…¬ä¼—å·æ¯æ¬¡è°ƒç”¨æ¥å£æ—¶ï¼Œå¯èƒ½è·å¾—æ­£ç¡®æˆ–é”™è¯¯çš„è¿”å›ç ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è¿”å›ç ä¿¡æ¯è°ƒè¯•æ¥å£ï¼Œæ’æŸ¥é”™è¯¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;errcode&quot;:45009,&quot;errmsg&quot;:&quot;api freq out of limit&quot;&#125;</div></pre></td></tr></table></figure>
<p>å¦‚ä¸Šçš„è¿”å›ç <code>45009</code>è¡¨è¾¾çš„å°±æ˜¯<code>æ¥å£è°ƒç”¨è¶…è¿‡é™åˆ¶</code>ã€‚æ¥å£é¢‘ç‡é™åˆ¶çš„è¯´æ˜è¯·ç‚¹å‡»<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433744592&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">ä¼ é€é—¨</a>ã€‚</p>
<h2 id="æ¥å£ä»‹ç»"><a href="#æ¥å£ä»‹ç»" class="headerlink" title="æ¥å£ä»‹ç»"></a>æ¥å£ä»‹ç»</h2><p>access_tokenæ˜¯å…¬ä¼—å·çš„å…¨å±€å”¯ä¸€æ¥å£è°ƒç”¨å‡­æ®ï¼Œå…¬ä¼—å·è°ƒç”¨å„æ¥å£æ—¶éƒ½éœ€ä½¿ç”¨access_tokenã€‚å¼€å‘è€…éœ€è¦è¿›è¡Œå¦¥å–„ä¿å­˜ã€‚</p>
<p>access_tokençš„å­˜å‚¨è‡³å°‘è¦ä¿ç•™512ä¸ªå­—ç¬¦ç©ºé—´ã€‚access_tokençš„æœ‰æ•ˆæœŸç›®å‰ä¸º2ä¸ªå°æ—¶ï¼Œéœ€å®šæ—¶åˆ·æ–°ï¼Œé‡å¤è·å–å°†å¯¼è‡´ä¸Šæ¬¡è·å–çš„access_tokenå¤±æ•ˆã€‚</p>
<p>access_tokenç›¸å½“äºå¼€å‘è€…çš„æœåŠ¡å™¨è®¿é—®å¾®ä¿¡æœåŠ¡å™¨çš„ä¸€æŠŠé’¥åŒ™ï¼Œè€Œå¾®ä¿¡æœåŠ¡å™¨æä¾›çš„å„ç§APIæ˜¯ä¸€ä¸ªä¸ªé—¨ï¼Œå…·æœ‰æ­£ç¡®çš„access_tokenæ‰å¯ä»¥å¾—åˆ°é—¨åé¢çš„ä¸œè¥¿ã€‚</p>
<h3 id="è·å–å¾®ä¿¡æœåŠ¡å™¨IPæ¥å£"><a href="#è·å–å¾®ä¿¡æœåŠ¡å™¨IPæ¥å£" class="headerlink" title="è·å–å¾®ä¿¡æœåŠ¡å™¨IPæ¥å£"></a>è·å–å¾®ä¿¡æœåŠ¡å™¨IPæ¥å£</h3><p>å¦‚æœå…¬ä¼—å·åŸºäºå®‰å…¨ç­‰è€ƒè™‘ï¼Œéœ€è¦è·çŸ¥å¾®ä¿¡æœåŠ¡å™¨çš„IPåœ°å€åˆ—è¡¨ï¼Œä»¥ä¾¿è¿›è¡Œç›¸å…³é™åˆ¶ï¼Œå®ƒä¸€èˆ¬æ˜¯ä¸ºäº†åˆ¤æ–­è¯·æ±‚æ˜¯å¦æ¥è‡ªäºå¾®ä¿¡ï¼Œå¦‚ä¸æ˜¯å¾®ä¿¡æœåŠ¡å™¨åˆ™å¯ä»¥è¿”å›éæ³•è®¿é—®ç­‰æ“ä½œã€‚</p>
<h3 id="é•¿é“¾æ¥è½¬çŸ­é“¾æ¥æ¥å£"><a href="#é•¿é“¾æ¥è½¬çŸ­é“¾æ¥æ¥å£" class="headerlink" title="é•¿é“¾æ¥è½¬çŸ­é“¾æ¥æ¥å£"></a>é•¿é“¾æ¥è½¬çŸ­é“¾æ¥æ¥å£</h3><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†ä¸€æ¡é•¿é“¾æ¥è½¬æˆçŸ­é“¾æ¥ã€‚å®ƒçš„ä¸»è¦ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œå¦‚æœå¼€å‘è€…ç”¨äºç”ŸæˆäºŒç»´ç çš„åŸé“¾æ¥ï¼ˆå•†å“ã€æ”¯ä»˜äºŒç»´ç ç­‰ï¼‰å¤ªé•¿å¯¼è‡´æ‰«ç é€Ÿåº¦å’ŒæˆåŠŸç‡ä¸‹é™ï¼Œå°†åŸé•¿é“¾æ¥é€šè¿‡æ­¤æ¥å£è½¬æˆçŸ­é“¾æ¥å†ç”ŸæˆäºŒç»´ç å°†å¤§å¤§æå‡æ‰«ç é€Ÿåº¦å’ŒæˆåŠŸç‡ã€‚</p>
<h3 id="è·å–ç”¨æˆ·åˆ—è¡¨æ¥å£"><a href="#è·å–ç”¨æˆ·åˆ—è¡¨æ¥å£" class="headerlink" title="è·å–ç”¨æˆ·åˆ—è¡¨æ¥å£"></a>è·å–ç”¨æˆ·åˆ—è¡¨æ¥å£</h3><p>å…¬ä¼—å·å¯é€šè¿‡æœ¬æ¥å£æ¥è·å–å¸å·çš„å…³æ³¨è€…åˆ—è¡¨ï¼Œå…³æ³¨è€…åˆ—è¡¨ç”±ä¸€ä¸²OpenIDï¼ˆåŠ å¯†åçš„å¾®ä¿¡å·ï¼Œæ¯ä¸ªç”¨æˆ·å¯¹æ¯ä¸ªå…¬ä¼—å·çš„OpenIDæ˜¯å”¯ä¸€çš„ï¼‰ç»„æˆã€‚ä¸€æ¬¡æ‹‰å–è°ƒç”¨æœ€å¤šæ‹‰å–10000ä¸ªå…³æ³¨è€…çš„OpenIDï¼Œå¯ä»¥é€šè¿‡å¤šæ¬¡æ‹‰å–çš„æ–¹å¼æ¥æ»¡è¶³éœ€æ±‚ã€‚</p>
<p>å®ƒä¸»è¦ç”¨äºè·å–å’Œä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œåœ¨é«˜çº§ç¾¤å‘æ¥å£ä¸­ä¹Ÿä¼šä½¿ç”¨åˆ°ã€‚</p>
<h3 id="è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£"><a href="#è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£" class="headerlink" title="è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£"></a>è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£</h3><p>åœ¨å…³æ³¨è€…ä¸å…¬ä¼—å·äº§ç”Ÿæ¶ˆæ¯äº¤äº’åï¼Œå…¬ä¼—å·å¯è·å¾—å…³æ³¨è€…çš„OpenIDï¼ˆåŠ å¯†åçš„å¾®ä¿¡å·ï¼Œæ¯ä¸ªç”¨æˆ·å¯¹æ¯ä¸ªå…¬ä¼—å·çš„OpenIDæ˜¯å”¯ä¸€çš„ã€‚å¯¹äºä¸åŒå…¬ä¼—å·ï¼ŒåŒä¸€ç”¨æˆ·çš„openidä¸åŒï¼‰ã€‚</p>
<p>å…¬ä¼—å·å¯é€šè¿‡æœ¬æ¥å£æ¥æ ¹æ®OpenIDè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬<strong>æ˜µç§°ã€å¤´åƒã€æ€§åˆ«ã€æ‰€åœ¨åŸå¸‚ã€è¯­è¨€å’Œå…³æ³¨æ—¶é—´</strong>ã€‚</p>
<h4 id="UnionIDæœºåˆ¶"><a href="#UnionIDæœºåˆ¶" class="headerlink" title="UnionIDæœºåˆ¶"></a>UnionIDæœºåˆ¶</h4><p>å¼€å‘è€…å¯é€šè¿‡OpenIDæ¥è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœå¼€å‘è€…æ‹¥æœ‰å¤šä¸ªç§»åŠ¨åº”ç”¨ã€ç½‘ç«™åº”ç”¨å’Œå…¬ä¼—å¸å·ï¼Œå¯é€šè¿‡è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ä¸­çš„unionidæ¥åŒºåˆ†ç”¨æˆ·çš„å”¯ä¸€æ€§</strong>ã€‚</p>
<p>å› ä¸ºåªè¦æ˜¯åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°å¸å·ä¸‹çš„ç§»åŠ¨åº”ç”¨ã€ç½‘ç«™åº”ç”¨å’Œå…¬ä¼—å¸å·ï¼Œç”¨æˆ·çš„unionidæ˜¯å”¯ä¸€çš„ï¼Œæ¢å¥è¯è¯´ï¼ŒåŒä¸€ç”¨æˆ·ï¼Œå¯¹åŒä¸€ä¸ªå¾®ä¿¡å¼€æ”¾å¹³å°ä¸‹çš„ä¸åŒåº”ç”¨ï¼Œunionidæ˜¯ç›¸åŒçš„ã€‚ </p>
<p><strong>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œopenidæ˜¯å¼€å‘è€…çš„å”¯ä¸€ç”¨æˆ·æ ‡è¯†ï¼Œunionidæ˜¯æ•´ä¸ªå¾®ä¿¡çš„å”¯ä¸€ç”¨æˆ·æ ‡è¯†ï¼Œopenidæ˜¯è·å–unionidçš„å…ˆå†³æ¡ä»¶ï¼Œä¸¤ç§æ ‡è¯†éƒ½éœ€è¦ç”¨æˆ·å…³æ³¨æˆ–ä½¿ç”¨åº”ç”¨åæ‰èƒ½è·å–ã€‚</strong></p>
<h3 id="ç½‘é¡µæˆæƒæ¥å£"><a href="#ç½‘é¡µæˆæƒæ¥å£" class="headerlink" title="ç½‘é¡µæˆæƒæ¥å£"></a>ç½‘é¡µæˆæƒæ¥å£</h3><p>å¦‚æœç”¨æˆ·åœ¨å¾®ä¿¡å®¢æˆ·ç«¯ä¸­è®¿é—®ç¬¬ä¸‰æ–¹ç½‘é¡µï¼Œå…¬ä¼—å·å¯ä»¥é€šè¿‡å¾®ä¿¡ç½‘é¡µæˆæƒæœºåˆ¶ï¼Œæ¥è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚</p>
<h4 id="ç½‘é¡µæˆæƒçš„ä¸¤ç§èŒƒå›´"><a href="#ç½‘é¡µæˆæƒçš„ä¸¤ç§èŒƒå›´" class="headerlink" title="ç½‘é¡µæˆæƒçš„ä¸¤ç§èŒƒå›´"></a>ç½‘é¡µæˆæƒçš„ä¸¤ç§èŒƒå›´</h4><ul>
<li>ä»¥snsapi_baseä¸ºscopeå‘èµ·çš„ç½‘é¡µæˆæƒï¼Œæ˜¯ç”¨æ¥<strong>è·å–è¿›å…¥é¡µé¢çš„ç”¨æˆ·çš„openidçš„</strong>ï¼Œå¹¶ä¸”æ˜¯é™é»˜æˆæƒå¹¶è‡ªåŠ¨è·³è½¬åˆ°å›è°ƒé¡µçš„ã€‚ç”¨æˆ·æ„ŸçŸ¥çš„å°±æ˜¯ç›´æ¥è¿›å…¥äº†å›è°ƒé¡µï¼ˆå¾€å¾€æ˜¯ä¸šåŠ¡é¡µé¢ï¼‰ã€‚</li>
<li>ä»¥snsapi_userinfoä¸ºscopeå‘èµ·çš„ç½‘é¡µæˆæƒï¼Œæ˜¯ç”¨æ¥<strong>è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯çš„</strong>ã€‚ä½†è¿™ç§æˆæƒéœ€è¦ç”¨æˆ·æ‰‹åŠ¨åŒæ„ï¼Œå¹¶ä¸”ç”±äºç”¨æˆ·åŒæ„è¿‡ï¼Œæ‰€ä»¥æ— é¡»å…³æ³¨ï¼Œå°±å¯åœ¨æˆæƒåè·å–è¯¥ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€‚ </li>
<li>ç”¨æˆ·ç®¡ç†ç±»æ¥å£ä¸­çš„â€œè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£â€ï¼Œæ˜¯åœ¨ç”¨æˆ·å’Œå…¬ä¼—å·äº§ç”Ÿæ¶ˆæ¯äº¤äº’æˆ–å…³æ³¨åäº‹ä»¶æ¨é€åï¼Œæ‰èƒ½æ ¹æ®ç”¨æˆ·OpenIDæ¥è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚è¿™ä¸ªæ¥å£ï¼ŒåŒ…æ‹¬å…¶ä»–å¾®ä¿¡æ¥å£ï¼Œéƒ½æ˜¯<strong>éœ€è¦è¯¥ç”¨æˆ·ï¼ˆå³openidï¼‰å…³æ³¨äº†å…¬ä¼—å·åï¼Œæ‰èƒ½è°ƒç”¨æˆåŠŸçš„</strong>ã€‚ </li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">snsapi_userinfoæ¼”ç¤º</th>
<th style="text-align:center">å¯èƒ½æ˜¯snsapi_base</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="http://oboehz2ag.bkt.clouddn.com/snsapi_userinfo.jpg" alt="snsapi_userinfo"></td>
<td style="text-align:center"><img src="http://oboehz2ag.bkt.clouddn.com/snsapi_base.jpg" alt="snsapi_base"></td>
</tr>
</tbody>
</table>
<h3 id="é«˜çº§ç¾¤å‘æ¥å£"><a href="#é«˜çº§ç¾¤å‘æ¥å£" class="headerlink" title="é«˜çº§ç¾¤å‘æ¥å£"></a>é«˜çº§ç¾¤å‘æ¥å£</h3><p>åœ¨å…¬ä¼—å¹³å°ç½‘ç«™ä¸Šï¼Œä¸ºè®¢é˜…å·æä¾›äº†æ¯å¤©ä¸€æ¡çš„ç¾¤å‘æƒé™ï¼Œä¸ºæœåŠ¡å·æä¾›æ¯æœˆï¼ˆè‡ªç„¶æœˆï¼‰4æ¡çš„ç¾¤å‘æƒé™ã€‚è€Œå¯¹äºæŸäº›å…·å¤‡å¼€å‘èƒ½åŠ›çš„å…¬ä¼—å·è¿è¥è€…ï¼Œå¯ä»¥é€šè¿‡é«˜çº§ç¾¤å‘æ¥å£ï¼Œå®ç°æ›´çµæ´»çš„ç¾¤å‘èƒ½åŠ›ã€‚</p>
<p>é«˜çº§ç¾¤å‘å…·æœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¯æ ¹æ®ç”¨æˆ·æ ‡ç­¾æˆ–openidè¿›è¡Œç¾¤å‘ï¼Œæ™®é€šç¾¤å‘åªå¯é’ˆå¯¹æ ‡ç­¾å’Œå…¨éƒ¨è¿›è¡Œç¾¤å‘ï¼Œé«˜çº§ç¾¤å‘çš„é’ˆå¯¹æ€§æ›´å¼ºï¼›</li>
<li>é«˜çº§ç¾¤å‘å›¾æ–‡å†…å®¹æ”¯æŒHTML</li>
</ul>
<h3 id="JS-SDKæ¥å£"><a href="#JS-SDKæ¥å£" class="headerlink" title="JS-SDKæ¥å£"></a>JS-SDKæ¥å£</h3><p>å¾®ä¿¡JS-SDKæ˜¯å¾®ä¿¡å…¬ä¼—å¹³å°é¢å‘ç½‘é¡µå¼€å‘è€…æä¾›çš„åŸºäºå¾®ä¿¡å†…çš„ç½‘é¡µå¼€å‘å·¥å…·åŒ…ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨å¾®ä¿¡JS-SDKï¼Œç½‘é¡µå¼€å‘è€…å¯å€ŸåŠ©å¾®ä¿¡é«˜æ•ˆåœ°ä½¿ç”¨æ‹ç…§ã€é€‰å›¾ã€è¯­éŸ³ã€ä½ç½®ç­‰æ‰‹æœºç³»ç»Ÿçš„èƒ½åŠ›ï¼ŒåŒæ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨å¾®ä¿¡åˆ†äº«ã€æ‰«ä¸€æ‰«ã€å¡åˆ¸ã€æ”¯ä»˜ç­‰å¾®ä¿¡ç‰¹æœ‰çš„èƒ½åŠ›ï¼Œä¸ºå¾®ä¿¡ç”¨æˆ·æä¾›æ›´ä¼˜è´¨çš„ç½‘é¡µä½“éªŒã€‚</p>
<p>ä¾‹å¦‚åˆ†äº«åŠŸèƒ½ï¼ŒJS-SDKå¯ä»¥æä¾›è‡ªå®šä¹‰åˆ†äº«æ ‡é¢˜ï¼Œå†…å®¹å’Œå›¾ç‰‡çš„æ”¯æŒï¼Œè¿˜æœ‰è°ƒç”¨ç›¸æœºï¼Œä½ç½®ç­‰æ¥å£ã€‚</p>
<h3 id="æ¨¡æ¿æ¶ˆæ¯æ¥å£"><a href="#æ¨¡æ¿æ¶ˆæ¯æ¥å£" class="headerlink" title="æ¨¡æ¿æ¶ˆæ¯æ¥å£"></a>æ¨¡æ¿æ¶ˆæ¯æ¥å£</h3><p>å…¬ä¼—å·å¯ä»¥ä¸»åŠ¨å‘ç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œç”¨æˆ·å¯ä»¥æ”¶åˆ°æœåŠ¡å·æ¯æœˆ4æ¡ï¼Œè®¢é˜…å·æ¯å¤©1æ¡çš„æ¶ˆæ¯ï¼Œè¶…å‡ºåå…¬ä¼—å·å‘é€çš„æ¶ˆæ¯å°†å¯¹æ­¤ç”¨æˆ·å±è”½ï¼Œè¿™æ ·çš„é™åˆ¶æ˜¯ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„å¼€å‘éœ€æ±‚çš„ã€‚</p>
<p>å½“ç”¨æˆ·åœ¨å…¬ä¼—å·è¿›è¡Œç‰¹å®šè¡Œä¸ºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ¿æ¶ˆæ¯ã€‚æ¨¡æ¿æ¶ˆæ¯ä»…ç”¨äºå…¬ä¼—å·å‘ç”¨æˆ·å‘é€é‡è¦çš„æœåŠ¡é€šçŸ¥ï¼Œåªèƒ½ç”¨äºç¬¦åˆå…¶è¦æ±‚çš„æœåŠ¡åœºæ™¯ä¸­ï¼Œå¦‚ä¿¡ç”¨å¡åˆ·å¡é€šçŸ¥ï¼Œå•†å“è´­ä¹°æˆåŠŸé€šçŸ¥ç­‰ã€‚</p>
<p>ä¸æ”¯æŒå¹¿å‘Šç­‰è¥é”€ç±»æ¶ˆæ¯ä»¥åŠå…¶å®ƒæ‰€æœ‰å¯èƒ½å¯¹ç”¨æˆ·é€ æˆéªšæ‰°çš„æ¶ˆæ¯ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">JS-SDKåˆ†äº«æ¼”ç¤º</th>
<th style="text-align:center">æ¨¡æ¿æ¶ˆæ¯æ¼”ç¤º</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="http://oboehz2ag.bkt.clouddn.com/JSSDK.PNG" alt="JSSDK"></td>
<td style="text-align:center"><img src="http://oboehz2ag.bkt.clouddn.com/%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF.PNG" alt="æ¨¡æ¿æ¶ˆæ¯"></td>
</tr>
</tbody>
</table>
<h2 id="å¼€å‘å‰ç¡®å®šéœ€è¦çš„æ¥å£"><a href="#å¼€å‘å‰ç¡®å®šéœ€è¦çš„æ¥å£" class="headerlink" title="å¼€å‘å‰ç¡®å®šéœ€è¦çš„æ¥å£"></a>å¼€å‘å‰ç¡®å®šéœ€è¦çš„æ¥å£</h2><p>æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>
<p>æŸå…¬å¸å¸Œæœ›å°†è‡ªå·±çš„PCå•†åŸå’Œè‡ªå·±çš„å¾®ä¿¡å…¬ä¼—å¹³å°è¿›è¡Œå¯¹æ¥ï¼Œä¹Ÿå°±æ˜¯åœ¨å¾®ä¿¡ä¸Šç»‘å®šPCå•†åŸè´¦å·çš„åŠŸèƒ½ï¼Œä»¥å®ç°åœ¨å¾®ä¿¡ä¸­ç‚¹å‡»èœå•æ— éœ€ç™»å½•å³å¯æŸ¥çœ‹è‡ªå·±è´¦å·çš„è¯¦æƒ…ï¼Œè´­ç‰©è®°å½•ç­‰ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•å¾—çŸ¥éœ€è¦çš„æ¥å£æœ‰å“ªäº›å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬éœ€è¦ï¼š</p>
<h3 id="ç¡®å®šåŠŸèƒ½çš„æµç¨‹"><a href="#ç¡®å®šåŠŸèƒ½çš„æµç¨‹" class="headerlink" title="ç¡®å®šåŠŸèƒ½çš„æµç¨‹"></a>ç¡®å®šåŠŸèƒ½çš„æµç¨‹</h3><p> <img src="http://oboehz2ag.bkt.clouddn.com/%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B%E7%A4%BA%E4%BE%8B.gif" alt="åŠŸèƒ½æµç¨‹ç¤ºä¾‹"></p>
<p>å°†åŠŸèƒ½çš„æµç¨‹ç½—åˆ—å¥½ä»¥åï¼Œå³å¯æŒ‰ç…§æ¯ä¸ªæµç¨‹çš„éœ€æ±‚æ¥ç¡®å®šéœ€è¦è°ƒç”¨çš„æ¥å£ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºç”¨æˆ·ä½“éªŒå’Œå®‰å…¨æ€§æ–¹é¢çš„è€ƒè™‘ï¼Œå¾®ä¿¡å…¬ä¼—å·çš„æ³¨å†Œæœ‰ä¸€å®šé—¨æ§›ï¼ŒæŸäº›é«˜çº§æ¥å£çš„æƒé™éœ€è¦å¾®ä¿¡è®¤è¯åæ‰å¯ä»¥è·å–ã€‚æ‰€ä»¥ï¼Œä¸ºäº†å¸®åŠ©å¼€å‘è€…å¿«é€Ÿäº†è§£å’Œä¸Šæ‰‹å¾®ä¿¡å…¬ä¼—å·å¼€å‘ï¼Œç†Ÿæ‚‰å„ä¸ªæ¥å£çš„è°ƒç”¨ï¼Œéœ€è¦å¼€é€šæµ‹è¯•è´¦å·ã€‚&lt;/p&gt;
&lt;p&gt;å¼€é€šæµ‹è¯•è´¦å·çš„è·¯å¾„ä¸ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¾®ä¿¡å…¬ä¼—å¹³å° &amp;gt; å¼€å‘è€…å·¥å…· &amp;gt; å…¬ä¼—å¹³å°æµ‹è¯•å¸å· &amp;gt; è¿›å…¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ–ç‚¹å‡»&lt;a href=&quot;http://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;amp;t=sandbox/index&quot;&gt;ä¼ é€é—¨&lt;/a&gt;ï¼Œéœ€è¦å¡«å†™çš„ä¸ºä»¥ä¸‹å‡ é¡¹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;URLï¼šæ¥å£æ–‡æ¡£æ‰€åœ¨çš„è·¯å¾„ï¼Œå¦‚ï¼š&lt;code&gt;https://localhost/filepath/wxapifile.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Tokenï¼šæ¥å£æ–‡æ¡£ä¸­è®¾å®šçš„Token&lt;/p&gt;
&lt;p&gt;åŸŸåï¼šç½‘å€æˆ–ä¸»æœºåï¼Œå¦‚ï¼š&lt;code&gt;localhost&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚å¯¹ä»¥ä¸Šæ­¥éª¤é™Œç”Ÿçš„åŒå­¦å¯ä»¥å…ˆçœ‹&lt;a href=&quot;https://tianziyao.github.io/2016/09/02/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%20-%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/&quot;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/tags/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¤šçº¿ç¨‹ - ä¸‹è½½åŠå›¾ç‰‡ç¼“å­˜</title>
    <link href="http://yoursite.com/2016/09/03/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E8%BD%BD%E5%8F%8A%E5%9B%BE%E7%89%87%E7%BC%93%E5%AD%98/"/>
    <id>http://yoursite.com/2016/09/03/iOSå¤šçº¿ç¨‹ä¸‹è½½åŠå›¾ç‰‡ç¼“å­˜/</id>
    <published>2016-09-02T18:46:00.000Z</published>
    <updated>2017-01-24T15:48:40.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>çº¿ç¨‹å¯ä»¥ç†è§£ä¸ºä¸‹è½½çš„é€šé“ï¼Œä¸€ä¸ªçº¿ç¨‹å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ä¸‹è½½é€šé“ï¼Œå¤šçº¿ç¨‹ä¹Ÿå°±æ˜¯åŒæ—¶å¼€èµ·å¥½å‡ ä¸ªä¸‹è½½é€šé“.å½“æœåŠ¡å™¨æä¾›ä¸‹è½½æœåŠ¡æ—¶ï¼Œä½¿ç”¨ä¸‹è½½è€…æ˜¯å…±äº«å¸¦å®½çš„ï¼Œåœ¨ä¼˜å…ˆçº§ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ€»æœåŠ¡å™¨ä¼šå¯¹æ€»ä¸‹è½½çº¿ç¨‹è¿›è¡Œå¹³å‡åˆ†é…ã€‚ä¸éš¾ç†è§£ï¼Œå¦‚æœä½ çº¿ç¨‹å¤šçš„è¯ï¼Œé‚£ä¸‹è½½çš„è¶Šå¿«ã€‚ç°æµè¡Œçš„ä¸‹è½½è½¯ä»¶éƒ½æ”¯æŒå¤šçº¿ç¨‹ã€‚</p>
</blockquote>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç æ¥äº†è§£ä»¥ä¸‹å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>å¤šçº¿ç¨‹ä¸‹è½½ï¼›</li>
<li>è‡ªå®šä¹‰ NSOperation ï¼›</li>
<li>NSCache å¢åˆ æ”¹æŸ¥ï¼›</li>
<li>NSFileManager å¢åˆ æ”¹æŸ¥ï¼›</li>
<li>ä»£ç†æ¨¡å¼ï¼›</li>
<li>é—­åŒ…åå‘ä¼ å€¼ï¼›</li>
<li>æ‰©å±•æ–¹æ³•ï¼›</li>
<li>Plist æ–‡ä»¶è§£æï¼›</li>
</ol>
<a id="more"></a>
<p>é¦–å…ˆæˆ‘ä»¬ç»™ String ç±»å‹æ·»åŠ æ‰©å±•æ–¹æ³•ï¼Œè·å–å­—ç¬¦ä¸²çš„MD5å€¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> md5 : <span class="type">String</span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> str = <span class="keyword">self</span>.cStringUsingEncoding(<span class="type">NSUTF8StringEncoding</span>)</div><div class="line">        <span class="keyword">let</span> strLen = <span class="type">CC_LONG</span>(<span class="keyword">self</span>.lengthOfBytesUsingEncoding(<span class="type">NSUTF8StringEncoding</span>))</div><div class="line">        <span class="keyword">let</span> digestLen = <span class="type">Int</span>(<span class="type">CC_MD5_DIGEST_LENGTH</span>)</div><div class="line">        <span class="keyword">let</span> result = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">CUnsignedChar</span>&gt;.alloc(digestLen);</div><div class="line"></div><div class="line">        <span class="type">CC_MD5</span>(str!, strLen, result);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> hash = <span class="type">NSMutableString</span>();</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; digestLen &#123;</div><div class="line">            hash.appendFormat(<span class="string">"%02x"</span>, result[i]);</div><div class="line">        &#125;</div><div class="line">        result.destroy();</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: hash <span class="keyword">as</span> <span class="type">String</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬æ¥è‡ªå®šä¹‰ä¸€ä¸ª NSOperation ï¼Œæ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ª NSOperation çš„ç±»ï¼Œå¹¶å£°æ˜ä»¥ä¸‹å±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownloadOperation</span>: <span class="title">NSOperation</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> memCache: <span class="type">NSCache</span>!</div><div class="line">    <span class="keyword">var</span> fileMgr: <span class="type">NSFileManager</span>!</div><div class="line">    <span class="keyword">var</span> diskCachePath: <span class="type">String</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> operations: [<span class="type">NSOperation</span>] = []</div><div class="line">    <span class="keyword">var</span> getImageQueue: <span class="type">NSOperationQueue</span>!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åå£°æ˜ä¸€ä¸ªé—­åŒ…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typealias</span> <span class="type">Block</span> = (<span class="type">UIImage</span>) -&gt; (<span class="type">Void</span>)</div></pre></td></tr></table></figure>
<p>æœ€åå£°æ˜ä¸€ä¸ªåè®®ï¼Œå¹¶åˆ›å»ºä¸¤ä¸ªä»£ç†æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">DownloadDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">userCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬é‡å†™è‡ªå®šä¹‰ NSOperation çš„ init æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºæ²™ç›’ç›®å½•ï¼Œå®ä¾‹ NSCache NSFileManager NSOperationQueue ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">init</span>() &#123;</div><div class="line"></div><div class="line">    memCache = <span class="type">NSCache</span>()</div><div class="line">    fileMgr = <span class="type">NSFileManager</span>()</div><div class="line"></div><div class="line">    <span class="keyword">let</span> paths = <span class="type">NSSearchPathForDirectoriesInDomains</span>(<span class="type">NSSearchPathDirectory</span>.<span class="type">DocumentDirectory</span>,</div><div class="line">                                                    <span class="type">NSSearchPathDomainMask</span>.<span class="type">UserDomainMask</span>,</div><div class="line">                                                    <span class="literal">true</span>)</div><div class="line">    <span class="keyword">self</span>.diskCachePath = paths.first?.stringByAppendingString(<span class="string">"/ImageCache"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> !(<span class="type">NSFileManager</span>.defaultManager().fileExistsAtPath(<span class="keyword">self</span>.diskCachePath!)) &#123;</div><div class="line"></div><div class="line">        <span class="keyword">try</span>! <span class="type">NSFileManager</span>.defaultManager().createDirectoryAtPath(<span class="keyword">self</span>.diskCachePath!,</div><div class="line">                                                                  withIntermediateDirectories: <span class="literal">true</span>,</div><div class="line">                                                                  attributes: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    getImageQueue = <span class="type">NSOperationQueue</span>()</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯é—­åŒ…åå‘ä¼ å€¼çš„ç¬¬ä¸€æ­¥ï¼Œåˆå§‹åŒ–é—­åŒ…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">ininWithblock</span><span class="params">(block: Block)</span></span> &#123;</div><div class="line">    showImage = block</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶åè·å¾—è¦ä¿å­˜çš„è·¯å¾„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">diskPathForKey</span><span class="params">(key: String)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (diskCachePath?.stringByAppendingString(<span class="string">"/<span class="subst">\(key.md5)</span>"</span>))!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶ååˆ¤æ–­è¿™ä¸ªæ–‡ä»¶åœ¨å†…å­˜ä¸­æ˜¯å¦å­˜åœ¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">cacheIsExist</span><span class="params">(key: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> data = memCache.objectForKey(key)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> data != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶ååˆ¤æ–­è¿™ä¸ªæ–‡ä»¶åœ¨ç£ç›˜ä¸­æ˜¯å¦å­˜åœ¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">fileIsExist</span><span class="params">(key: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> fileMgr.fileExistsAtPath(diskPathForKey(key))</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å®ç°åˆ©ç”¨æ–‡ä»¶åä»å†…å­˜ä¸­è·å–æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">readFromeMem</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> image = memCache.objectForKey(key) <span class="keyword">as</span>! <span class="type">UIImage</span></div><div class="line">    <span class="keyword">return</span> image</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å®ç°åˆ©ç”¨æ–‡ä»¶åä»ç£ç›˜ä¸­è·å–æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">readFromeDisk</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span>  data = fileMgr.contentsAtPath(diskPathForKey(key))</div><div class="line">    <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: data!)</div><div class="line">    <span class="keyword">return</span> image!</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å®ç°åˆ©ç”¨é“¾æ¥ä¸‹è½½æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: key)</div><div class="line">    <span class="keyword">let</span> data = <span class="type">NSData</span>(contentsOfURL: url!)</div><div class="line">    <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: data!)</div><div class="line">    <span class="keyword">return</span> image!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°å°†æ–‡ä»¶å†™å…¥å†…å­˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">saveToMem</span><span class="params">(image: UIImage, key: String)</span></span> &#123;</div><div class="line"></div><div class="line">    memCache.setObject(image, forKey: key)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹è½½å®ç°å°†æ–‡ä»¶å†™å…¥ç£ç›˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">saveToDisk</span><span class="params">(image: UIImage, key: String)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> key = diskPathForKey(key)</div><div class="line"></div><div class="line">    fileMgr.createFileAtPath(key,</div><div class="line">                             contents: <span class="type">UIImageJPEGRepresentation</span>(image, <span class="number">1.0</span>),</div><div class="line">                             attributes: <span class="literal">nil</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°åˆ©ç”¨é“¾æ¥ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹è½½çš„æ–‡ä»¶å†™å…¥å†…å­˜å’Œç£ç›˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">saveToMemAndDisk</span><span class="params">(key: String, toDisk: Bool)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> image = download(key)</div><div class="line"></div><div class="line">    saveToMem(image, key: key)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> toDisk &#123;</div><div class="line">        saveToDisk(image, key: key)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°è¯»å–æ–‡ä»¶ï¼Œå¦‚æœå†…å­˜ä¸­æœ‰å°±ä»å†…å­˜è¯»å–ï¼Œå¦‚æœç£ç›˜ä¸­æœ‰å°±ä»ç£ç›˜è¯»å–ï¼Œå¹¶å†™å…¥åˆ°å†…å­˜ï¼Œå¦‚æœéƒ½æ²¡æœ‰ï¼Œå°±ä¸‹è½½å¹¶å†™å…¥åˆ°å†…å­˜å’Œç£ç›˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">readImage</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> cacheIsExist(key) &#123;</div><div class="line">        <span class="keyword">let</span> image = readFromeMem(key)</div><div class="line">        <span class="keyword">return</span> image</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> fileIsExist(key) &#123;</div><div class="line">        <span class="keyword">let</span> image = readFromeDisk(key)</div><div class="line">        saveToMem(image, key: key)</div><div class="line">        <span class="keyword">return</span> image</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    saveToMemAndDisk(key, toDisk: <span class="literal">true</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> readFromeMem(key)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°åˆ©ç”¨å­˜æ”¾é“¾æ¥çš„æ•°ç»„ï¼Œæ‰¹é‡ä¸‹è½½æ–‡ä»¶ï¼Œè®¾ç½®ä¸‹è½½çº¿ç¨‹çš„æœ€å¤§å€¼å¹¶ä½¿ç”¨ block æ‰§è¡Œ ViewController é¢„è®¾çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">getImage</span><span class="params">(keys: [String], <span class="built_in">max</span>: Int)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> operation = <span class="type">NSBlockOperation</span>(block: &#123;</div><div class="line"></div><div class="line">            <span class="keyword">let</span> image = <span class="keyword">self</span>.readImage(key)</div><div class="line">            <span class="keyword">self</span>.showImage!(image)</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        operations.append(operation)</div><div class="line">    &#125;</div><div class="line">    getImageQueue.maxConcurrentOperationCount = <span class="built_in">max</span></div><div class="line">    getImageQueue.addOperations(operations, waitUntilFinished: <span class="literal">true</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°åˆ©ç”¨æ–‡ä»¶ååˆ é™¤æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">deleteFile</span><span class="params">(key: String)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> fileMgr.isDeletableFileAtPath(key) &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"åˆ é™¤æˆåŠŸ"</span>)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å®ç°è°ƒç”¨ä»£ç†çš„ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">showImg</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegete != <span class="literal">nil</span>) &amp;&amp; (<span class="keyword">self</span>.delegete?.userCache != <span class="literal">nil</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.delegete?.userCache(<span class="keyword">self</span>, imageCache: <span class="keyword">self</span>.memCache)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">deleteImg</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegete != <span class="literal">nil</span>) &amp;&amp; (<span class="keyword">self</span>.delegete?.cleanCache != <span class="literal">nil</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.delegete?.cleanCache(<span class="keyword">self</span>, imageCache: <span class="keyword">self</span>.memCache)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å›åˆ° ViewController ä¸­ï¼Œå£°æ˜ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> keys: <span class="type">NSArray</span>!</div><div class="line">    <span class="keyword">var</span> imgView: <span class="type">UIImageView</span>!</div><div class="line">    <span class="keyword">var</span> downloadBtn: <span class="type">UIButton</span>?</div><div class="line">    <span class="keyword">var</span> cleanBtn: <span class="type">UIButton</span>?</div><div class="line"></div><div class="line">    <span class="keyword">var</span> operation: <span class="type">DownloadOperation</span>!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬åˆ›å»º block è¦æ‰§è¡Œçš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">showImage</span><span class="params">(image: UIImage)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.imgView = <span class="type">UIImageView</span>(frame: <span class="keyword">self</span>.view.bounds)</div><div class="line">    <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.imgView!)</div><div class="line">    <span class="keyword">self</span>.imgView.image = image</div><div class="line">    <span class="built_in">print</span>(<span class="string">"block åŠ è½½å›¾ç‰‡"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬è§£æ Plist æ–‡ä»¶ä¸ºæ•°ç»„ï¼Œå¹¶å°†åŒ…å«ä¸‹è½½é“¾æ¥çš„æ•°ç»„ä¼ ç»™è‡ªå®šä¹‰ NSOperation çš„è·å–æ–‡ä»¶æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadForKeys</span><span class="params">(<span class="built_in">max</span>: Int)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> imgPaths = <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"ImageLinks"</span>, ofType: <span class="string">"plist"</span>)</div><div class="line">    <span class="keyword">let</span> imgUrls = <span class="type">NSURL</span>(fileURLWithPath: imgPaths!)</div><div class="line">    <span class="keyword">self</span>.keys = <span class="type">NSArray</span>(contentsOfURL: imgUrls)!</div><div class="line">    operation.getImage(keys <span class="keyword">as</span>! [<span class="type">String</span>], <span class="built_in">max</span>: <span class="built_in">max</span>)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬ç»™ ViewController æ·»åŠ ä¸¤ä¸ª Button ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">addButton</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> width = <span class="keyword">self</span>.view.bounds.size.width</div><div class="line">    <span class="keyword">let</span> height = <span class="keyword">self</span>.view.bounds.size.height</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.downloadBtn = <span class="type">UIButton</span>(type: .<span class="type">Custom</span>)</div><div class="line">    <span class="keyword">let</span> downloadBtnframe = <span class="type">CGRectMake</span>(<span class="number">20</span>, height-<span class="number">60</span>, <span class="number">80</span>, <span class="number">40</span>)</div><div class="line">    <span class="keyword">self</span>.downloadBtn?.frame = downloadBtnframe</div><div class="line">    <span class="keyword">self</span>.downloadBtn?.backgroundColor = <span class="type">UIColor</span>.lightGrayColor()</div><div class="line">    <span class="keyword">self</span>.downloadBtn?.titleLabel?.font = <span class="type">UIFont</span>.systemFontOfSize(<span class="number">18</span>)</div><div class="line">    <span class="keyword">self</span>.downloadBtn?.setTitle(<span class="string">"ä¸‹è½½"</span>, forState: .<span class="type">Normal</span>)</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.cleanBtn = <span class="type">UIButton</span>(type: .<span class="type">Custom</span>)</div><div class="line">    <span class="keyword">let</span> cleanBtnframe = <span class="type">CGRectMake</span>(width-<span class="number">80</span>-<span class="number">20</span>, height-<span class="number">60</span>, <span class="number">80</span>, <span class="number">40</span>)</div><div class="line">    <span class="keyword">self</span>.cleanBtn?.frame = cleanBtnframe</div><div class="line">    <span class="keyword">self</span>.cleanBtn?.backgroundColor = <span class="type">UIColor</span>.lightGrayColor()</div><div class="line">    <span class="keyword">self</span>.cleanBtn?.titleLabel?.font = <span class="type">UIFont</span>.systemFontOfSize(<span class="number">18</span>)</div><div class="line">    <span class="keyword">self</span>.cleanBtn?.setTitle(<span class="string">"æ¸…é™¤"</span>, forState: .<span class="type">Normal</span>)</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.downloadBtn?.addTarget(<span class="keyword">self</span>,</div><div class="line">                                action: #selector(<span class="type">ViewController</span>.downloadBtnClicked),</div><div class="line">                                forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.cleanBtn?.addTarget(<span class="keyword">self</span>,</div><div class="line">                                action: #selector(<span class="type">ViewController</span>.cleanBtnClicked),</div><div class="line">                                forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.downloadBtn!)</div><div class="line">    <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.cleanBtn!)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å®ç° Button çš„å“åº”äº‹ä»¶æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadBtnClicked</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    operation.showImg()</div><div class="line">    addButton()</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">cleanBtnClicked</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">    operation.deleteImg()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å®ç°ä»£ç†æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">userCache</span><span class="params">(operation: DownloadOperation, imageCache: NSCache)</span></span> &#123;</div><div class="line"></div><div class="line">    imgView.removeFromSuperview()</div><div class="line"></div><div class="line">    <span class="keyword">let</span> width = <span class="keyword">self</span>.view.bounds.size.width</div><div class="line">    <span class="keyword">let</span> imgHeight = <span class="keyword">self</span>.view.bounds.size.height / <span class="type">CGFloat</span>(<span class="type">Float</span>(keys.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; keys.<span class="built_in">count</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> frame = <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="type">CGFloat</span>(i) * imgHeight, width, imgHeight)</div><div class="line">        <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(frame: frame)</div><div class="line">        <span class="keyword">let</span> key = keys[i] <span class="keyword">as</span>! <span class="type">String</span></div><div class="line">        <span class="keyword">let</span> image = operation.readImage(key)</div><div class="line">        imageView.image = image</div><div class="line">        imageView.contentMode = .<span class="type">ScaleToFill</span></div><div class="line">        <span class="keyword">self</span>.view.addSubview(imageView)</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">cleanCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span> &#123;</div><div class="line"></div><div class="line">    imageCache.removeAllObjects()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> subView <span class="keyword">in</span> <span class="keyword">self</span>.view.subviews &#123;</div><div class="line">        subView.removeFromSuperview()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> temKey = operation.diskPathForKey(key <span class="keyword">as</span>! <span class="type">String</span>)</div><div class="line">        operation.deleteFile(temKey)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    addButton()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åæˆ‘ä»¬å¼•å…¥ä»£ç†åè®®ï¼Œå®ä¾‹åŒ–è‡ªå®šä¹‰çš„  ï¼Œå®ä¾‹åŒ–ä»£ç†å¯¹è±¡ï¼Œå®ä¾‹åŒ– blockï¼Œä»¥ä¸Šå‡ ä¸ªåŠŸèƒ½ç‚¹å°±å®Œæˆäº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">DownloadDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> keys: <span class="type">NSArray</span>!</div><div class="line">    <span class="keyword">var</span> imgView: <span class="type">UIImageView</span>!</div><div class="line">    <span class="keyword">var</span> downloadBtn: <span class="type">UIButton</span>?</div><div class="line">    <span class="keyword">var</span> cleanBtn: <span class="type">UIButton</span>?</div><div class="line">    <span class="keyword">var</span> operation: <span class="type">DownloadOperation</span>!</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        operation = <span class="type">DownloadOperation</span>()</div><div class="line">        operation.ininWithblock(showImage)</div><div class="line">        operation.delegete = <span class="keyword">self</span></div><div class="line">        downloadForKeys(<span class="number">3</span>)</div><div class="line">        addButton()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> md5 : <span class="type">String</span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> str = <span class="keyword">self</span>.cStringUsingEncoding(<span class="type">NSUTF8StringEncoding</span>)</div><div class="line">        <span class="keyword">let</span> strLen = <span class="type">CC_LONG</span>(<span class="keyword">self</span>.lengthOfBytesUsingEncoding(<span class="type">NSUTF8StringEncoding</span>))</div><div class="line">        <span class="keyword">let</span> digestLen = <span class="type">Int</span>(<span class="type">CC_MD5_DIGEST_LENGTH</span>)</div><div class="line">        <span class="keyword">let</span> result = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">CUnsignedChar</span>&gt;.alloc(digestLen);</div><div class="line"></div><div class="line">        <span class="type">CC_MD5</span>(str!, strLen, result);</div><div class="line"></div><div class="line">        <span class="keyword">let</span> hash = <span class="type">NSMutableString</span>();</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; digestLen &#123;</div><div class="line">            hash.appendFormat(<span class="string">"%02x"</span>, result[i]);</div><div class="line">        &#125;</div><div class="line">        result.destroy();</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: hash <span class="keyword">as</span> <span class="type">String</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typealias</span> <span class="type">Block</span> = (<span class="type">UIImage</span>) -&gt; (<span class="type">Void</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">DownloadDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">userCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownloadOperation</span>: <span class="title">NSOperation</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> memCache: <span class="type">NSCache</span>!</div><div class="line">    <span class="keyword">var</span> fileMgr: <span class="type">NSFileManager</span>!</div><div class="line">    <span class="keyword">var</span> diskCachePath: <span class="type">String</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> operations: [<span class="type">NSOperation</span>] = []</div><div class="line">    <span class="keyword">var</span> getImageQueue: <span class="type">NSOperationQueue</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> showImage: <span class="type">Block</span>?</div><div class="line">    <span class="keyword">var</span> delegete:<span class="type">DownloadDelegate</span>?</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</div><div class="line"></div><div class="line">        memCache = <span class="type">NSCache</span>()</div><div class="line">        fileMgr = <span class="type">NSFileManager</span>()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> paths = <span class="type">NSSearchPathForDirectoriesInDomains</span>(<span class="type">NSSearchPathDirectory</span>.<span class="type">DocumentDirectory</span>,</div><div class="line">                                                        <span class="type">NSSearchPathDomainMask</span>.<span class="type">UserDomainMask</span>,</div><div class="line">                                                        <span class="literal">true</span>)</div><div class="line">        <span class="keyword">self</span>.diskCachePath = paths.first?.stringByAppendingString(<span class="string">"/ImageCache"</span>)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> !(<span class="type">NSFileManager</span>.defaultManager().fileExistsAtPath(<span class="keyword">self</span>.diskCachePath!)) &#123;</div><div class="line"></div><div class="line">            <span class="keyword">try</span>! <span class="type">NSFileManager</span>.defaultManager().createDirectoryAtPath(<span class="keyword">self</span>.diskCachePath!,</div><div class="line">                                                                      withIntermediateDirectories: <span class="literal">true</span>,</div><div class="line">                                                                      attributes: <span class="literal">nil</span>)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        getImageQueue = <span class="type">NSOperationQueue</span>()</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ininWithblock</span><span class="params">(block: Block)</span></span> &#123;</div><div class="line">        showImage = block</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">diskPathForKey</span><span class="params">(key: String)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> (diskCachePath?.stringByAppendingString(<span class="string">"/<span class="subst">\(key.md5)</span>"</span>))!</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fileIsExist</span><span class="params">(key: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> fileMgr.fileExistsAtPath(diskPathForKey(key))</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cacheIsExist</span><span class="params">(key: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> data = memCache.objectForKey(key)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> data != <span class="literal">nil</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readFromeMem</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> image = memCache.objectForKey(key) <span class="keyword">as</span>! <span class="type">UIImage</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"å†…å­˜è¯»å–"</span>)</div><div class="line">        <span class="keyword">return</span> image</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readFromeDisk</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span>  data = fileMgr.contentsAtPath(diskPathForKey(key))</div><div class="line">        <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: data!)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"æ–‡ä»¶è¯»å–"</span>)</div><div class="line">        <span class="keyword">return</span> image!</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">deleteFile</span><span class="params">(key: String)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> fileMgr.isDeletableFileAtPath(key) &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"åˆ é™¤æˆåŠŸ"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: key)</div><div class="line">        <span class="keyword">let</span> data = <span class="type">NSData</span>(contentsOfURL: url!)</div><div class="line">        <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: data!)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"ä¸‹è½½"</span>)</div><div class="line">        <span class="keyword">return</span> image!</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">saveToMemAndDisk</span><span class="params">(key: String, toDisk: Bool)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> image = download(key)</div><div class="line"></div><div class="line">        saveToMem(image, key: key)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> toDisk &#123;</div><div class="line">            saveToDisk(image, key: key)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">saveToMem</span><span class="params">(image: UIImage, key: String)</span></span> &#123;</div><div class="line"></div><div class="line">        memCache.setObject(image, forKey: key)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"å†™å…¥å†…å­˜"</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">saveToDisk</span><span class="params">(image: UIImage, key: String)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> key = diskPathForKey(key)</div><div class="line"></div><div class="line">        fileMgr.createFileAtPath(key,</div><div class="line">                                 contents: <span class="type">UIImageJPEGRepresentation</span>(image, <span class="number">1.0</span>),</div><div class="line">                                 attributes: <span class="literal">nil</span>)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"å†™å…¥æ–‡ä»¶"</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readImage</span><span class="params">(key: String)</span></span> -&gt; <span class="type">UIImage</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> cacheIsExist(key) &#123;</div><div class="line">            <span class="keyword">let</span> image = readFromeMem(key)</div><div class="line">            <span class="keyword">return</span> image</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> fileIsExist(key) &#123;</div><div class="line">            <span class="keyword">let</span> image = readFromeDisk(key)</div><div class="line">            saveToMem(image, key: key)</div><div class="line">            <span class="keyword">return</span> image</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        saveToMemAndDisk(key, toDisk: <span class="literal">true</span>)</div><div class="line"></div><div class="line">        <span class="keyword">return</span> readFromeMem(key)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getImage</span><span class="params">(keys: [String], <span class="built_in">max</span>: Int)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> keys &#123;</div><div class="line"></div><div class="line">            <span class="keyword">let</span> operation = <span class="type">NSBlockOperation</span>(block: &#123;</div><div class="line"></div><div class="line">                <span class="keyword">let</span> image = <span class="keyword">self</span>.readImage(key)</div><div class="line">                <span class="keyword">self</span>.showImage!(image)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">            operations.append(operation)</div><div class="line">        &#125;</div><div class="line">        getImageQueue.maxConcurrentOperationCount = <span class="built_in">max</span></div><div class="line">        getImageQueue.addOperations(operations, waitUntilFinished: <span class="literal">true</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showImg</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegete != <span class="literal">nil</span>) &amp;&amp; (<span class="keyword">self</span>.delegete?.userCache != <span class="literal">nil</span>) &#123;</div><div class="line">            <span class="keyword">self</span>.delegete?.userCache(<span class="keyword">self</span>, imageCache: <span class="keyword">self</span>.memCache)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">deleteImg</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegete != <span class="literal">nil</span>) &amp;&amp; (<span class="keyword">self</span>.delegete?.cleanCache != <span class="literal">nil</span>) &#123;</div><div class="line">            <span class="keyword">self</span>.delegete?.cleanCache(<span class="keyword">self</span>, imageCache: <span class="keyword">self</span>.memCache)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">DownloadDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> keys: <span class="type">NSArray</span>!</div><div class="line">    <span class="keyword">var</span> imgView: <span class="type">UIImageView</span>!</div><div class="line">    <span class="keyword">var</span> downloadBtn: <span class="type">UIButton</span>?</div><div class="line">    <span class="keyword">var</span> cleanBtn: <span class="type">UIButton</span>?</div><div class="line">    <span class="keyword">var</span> operation: <span class="type">DownloadOperation</span>!</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        operation = <span class="type">DownloadOperation</span>()</div><div class="line">        operation.ininWithblock(showImage)</div><div class="line">        operation.delegete = <span class="keyword">self</span></div><div class="line"></div><div class="line">        downloadForKeys(<span class="number">3</span>)</div><div class="line">        addButton()</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadForKeys</span><span class="params">(<span class="built_in">max</span>: Int)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> imgPaths = <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"ImageLinks"</span>, ofType: <span class="string">"plist"</span>)</div><div class="line">        <span class="keyword">let</span> imgUrls = <span class="type">NSURL</span>(fileURLWithPath: imgPaths!)</div><div class="line">        <span class="keyword">self</span>.keys = <span class="type">NSArray</span>(contentsOfURL: imgUrls)!</div><div class="line">        operation.getImage(keys <span class="keyword">as</span>! [<span class="type">String</span>], <span class="built_in">max</span>: <span class="built_in">max</span>)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">showImage</span><span class="params">(image: UIImage)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.imgView = <span class="type">UIImageView</span>(frame: <span class="keyword">self</span>.view.bounds)</div><div class="line">        <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.imgView!)</div><div class="line">        <span class="keyword">self</span>.imgView.image = image</div><div class="line">        <span class="built_in">print</span>(<span class="string">"block åŠ è½½å›¾ç‰‡"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addButton</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> width = <span class="keyword">self</span>.view.bounds.size.width</div><div class="line">        <span class="keyword">let</span> height = <span class="keyword">self</span>.view.bounds.size.height</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.downloadBtn = <span class="type">UIButton</span>(type: .<span class="type">Custom</span>)</div><div class="line">        <span class="keyword">let</span> downloadBtnframe = <span class="type">CGRectMake</span>(<span class="number">20</span>, height-<span class="number">60</span>, <span class="number">80</span>, <span class="number">40</span>)</div><div class="line">        <span class="keyword">self</span>.downloadBtn?.frame = downloadBtnframe</div><div class="line">        <span class="keyword">self</span>.downloadBtn?.backgroundColor = <span class="type">UIColor</span>.lightGrayColor()</div><div class="line">        <span class="keyword">self</span>.downloadBtn?.titleLabel?.font = <span class="type">UIFont</span>.systemFontOfSize(<span class="number">18</span>)</div><div class="line">        <span class="keyword">self</span>.downloadBtn?.setTitle(<span class="string">"ä¸‹è½½"</span>, forState: .<span class="type">Normal</span>)</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.cleanBtn = <span class="type">UIButton</span>(type: .<span class="type">Custom</span>)</div><div class="line">        <span class="keyword">let</span> cleanBtnframe = <span class="type">CGRectMake</span>(width-<span class="number">80</span>-<span class="number">20</span>, height-<span class="number">60</span>, <span class="number">80</span>, <span class="number">40</span>)</div><div class="line">        <span class="keyword">self</span>.cleanBtn?.frame = cleanBtnframe</div><div class="line">        <span class="keyword">self</span>.cleanBtn?.backgroundColor = <span class="type">UIColor</span>.lightGrayColor()</div><div class="line">        <span class="keyword">self</span>.cleanBtn?.titleLabel?.font = <span class="type">UIFont</span>.systemFontOfSize(<span class="number">18</span>)</div><div class="line">        <span class="keyword">self</span>.cleanBtn?.setTitle(<span class="string">"æ¸…é™¤"</span>, forState: .<span class="type">Normal</span>)</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.downloadBtn?.addTarget(<span class="keyword">self</span>,</div><div class="line">                                    action: #selector(<span class="type">ViewController</span>.downloadBtnClicked),</div><div class="line">                                    forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.cleanBtn?.addTarget(<span class="keyword">self</span>,</div><div class="line">                                    action: #selector(<span class="type">ViewController</span>.cleanBtnClicked),</div><div class="line">                                    forControlEvents: .<span class="type">TouchUpInside</span>)</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.downloadBtn!)</div><div class="line">        <span class="keyword">self</span>.view.addSubview(<span class="keyword">self</span>.cleanBtn!)</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">userCache</span><span class="params">(operation: DownloadOperation, imageCache: NSCache)</span></span> &#123;</div><div class="line"></div><div class="line">        imgView.removeFromSuperview()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> width = <span class="keyword">self</span>.view.bounds.size.width</div><div class="line">        <span class="keyword">let</span> imgHeight = <span class="keyword">self</span>.view.bounds.size.height / <span class="type">CGFloat</span>(<span class="type">Float</span>(keys.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; keys.<span class="built_in">count</span> &#123;</div><div class="line"></div><div class="line">            <span class="keyword">let</span> frame = <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="type">CGFloat</span>(i) * imgHeight, width, imgHeight)</div><div class="line">            <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(frame: frame)</div><div class="line">            <span class="keyword">let</span> key = keys[i] <span class="keyword">as</span>! <span class="type">String</span></div><div class="line">            <span class="keyword">let</span> image = operation.readImage(key)</div><div class="line">            imageView.image = image</div><div class="line">            imageView.contentMode = .<span class="type">ScaleToFill</span></div><div class="line">            <span class="keyword">self</span>.view.addSubview(imageView)</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanCache</span> <span class="params">(operation: DownloadOperation, imageCache:NSCache)</span></span> &#123;</div><div class="line"></div><div class="line">        imageCache.removeAllObjects()</div><div class="line"></div><div class="line">        <span class="keyword">for</span> subView <span class="keyword">in</span> <span class="keyword">self</span>.view.subviews &#123;</div><div class="line">            subView.removeFromSuperview()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> keys &#123;</div><div class="line"></div><div class="line">            <span class="keyword">let</span> temKey = operation.diskPathForKey(key <span class="keyword">as</span>! <span class="type">String</span>)</div><div class="line">            operation.deleteFile(temKey)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        addButton()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadBtnClicked</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        operation.showImg()</div><div class="line">        addButton()</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanBtnClicked</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        operation.deleteImg()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;çº¿ç¨‹å¯ä»¥ç†è§£ä¸ºä¸‹è½½çš„é€šé“ï¼Œä¸€ä¸ªçº¿ç¨‹å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„ä¸‹è½½é€šé“ï¼Œå¤šçº¿ç¨‹ä¹Ÿå°±æ˜¯åŒæ—¶å¼€èµ·å¥½å‡ ä¸ªä¸‹è½½é€šé“.å½“æœåŠ¡å™¨æä¾›ä¸‹è½½æœåŠ¡æ—¶ï¼Œä½¿ç”¨ä¸‹è½½è€…æ˜¯å…±äº«å¸¦å®½çš„ï¼Œåœ¨ä¼˜å…ˆçº§ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ€»æœåŠ¡å™¨ä¼šå¯¹æ€»ä¸‹è½½çº¿ç¨‹è¿›è¡Œå¹³å‡åˆ†é…ã€‚ä¸éš¾ç†è§£ï¼Œå¦‚æœä½ çº¿ç¨‹å¤šçš„è¯ï¼Œé‚£ä¸‹è½½çš„è¶Šå¿«ã€‚ç°æµè¡Œçš„ä¸‹è½½è½¯ä»¶éƒ½æ”¯æŒå¤šçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç æ¥äº†è§£ä»¥ä¸‹å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¤šçº¿ç¨‹ä¸‹è½½ï¼›&lt;/li&gt;
&lt;li&gt;è‡ªå®šä¹‰ NSOperation ï¼›&lt;/li&gt;
&lt;li&gt;NSCache å¢åˆ æ”¹æŸ¥ï¼›&lt;/li&gt;
&lt;li&gt;NSFileManager å¢åˆ æ”¹æŸ¥ï¼›&lt;/li&gt;
&lt;li&gt;ä»£ç†æ¨¡å¼ï¼›&lt;/li&gt;
&lt;li&gt;é—­åŒ…åå‘ä¼ å€¼ï¼›&lt;/li&gt;
&lt;li&gt;æ‰©å±•æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;Plist æ–‡ä»¶è§£æï¼›&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="é—­åŒ…" scheme="http://yoursite.com/tags/%E9%97%AD%E5%8C%85/"/>
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="æ–‡ä»¶ç®¡ç†" scheme="http://yoursite.com/tags/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/"/>
    
      <category term="ä»£ç†æ¨¡å¼" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="Plist" scheme="http://yoursite.com/tags/Plist/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å¼€å‘ - å…¬ä¼—å¹³å°ç®€ä»‹</title>
    <link href="http://yoursite.com/2016/09/02/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%20-%20%E5%85%AC%E4%BC%97%E5%B9%B3%E5%8F%B0%E7%AE%80%E4%BB%8B/"/>
    <id>http://yoursite.com/2016/09/02/å¾®ä¿¡å¼€å‘ - å…¬ä¼—å¹³å°ç®€ä»‹/</id>
    <published>2016-09-01T18:24:00.000Z</published>
    <updated>2016-09-02T11:50:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¾®ä¿¡å¼€å‘å³å¾®ä¿¡å…¬ä¼—å¹³å°å¼€å‘ï¼Œå°†ä¼ä¸šä¿¡æ¯ã€æœåŠ¡ã€æ´»åŠ¨ç­‰å†…å®¹é€šè¿‡å¾®ä¿¡ç½‘é¡µçš„æ–¹å¼è¿›è¡Œè¡¨ç°ï¼Œç”¨æˆ·é€šè¿‡ç®€å•çš„è®¾ç½®ï¼Œå°±èƒ½ç”Ÿæˆå¾®ä¿¡3Gç½‘ç«™ã€‚é€šè¿‡å¾®ä¿¡å…¬ä¼—å¹³å°å°†ä¼ä¸šå“ç‰Œå±•ç¤ºç»™å¾®ä¿¡ç”¨æˆ·ï¼Œå‡å°‘å®£ä¼ æˆæœ¬ï¼Œå»ºç«‹ä¼ä¸šä¸æ¶ˆè´¹è€…ã€å®¢æˆ·çš„ä¸€å¯¹ä¸€äº’åŠ¨å’Œæ²Ÿé€šï¼Œå°†æ¶ˆè´¹è€…æ¥å…¥ä¼ä¸šCRMç³»ç»Ÿï¼Œè¿›è¡Œä¿ƒé”€ã€æ¨å¹¿ã€å®£ä¼ ã€å”®åç­‰ã€‚å½¢æˆäº†ä¸€ç§ä¸»æµçš„çº¿ä¸Šçº¿ä¸‹å¾®ä¿¡äº’åŠ¨è¥é”€æ–¹å¼ã€‚</p>
<p>é€šè¿‡äºŒæ¬¡å¼€å‘å¯ä»¥å°†å…¬ä¼—è´¦å·ç”±ä¸€ä¸ªåª’ä½“å‹è¥é”€å·¥å…·è½¬åŒ–æˆæä¾›æœåŠ¡çš„äº§å“ã€‚è€Œä¸€æ—¦æˆä¸ºç”¨æˆ·éœ€è¦çš„äº§å“ï¼Œå…¬ä¼—è´¦å·çš„è¥é”€åŠŸèƒ½ä¾¿ä¼šå¼€å¯ã€‚<br>å¾®ä¿¡çš„æ ¸å¿ƒæ˜¯é€šè®¯å·¥å…·ï¼Œè¿™ä¸€å·¥å…·å±æ€§å°†ç”¨æˆ·ç‰¢ç‰¢åœ°é»åœ¨äº†å¹³å°ä¹‹ä¸Šã€‚ç”¨æˆ·å’Œä¼ä¸šå¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸Šé¢è¿›è¡Œæ²Ÿé€šï¼Œæ‰€ä»¥å¾®ä¿¡å¾ˆè‡ªç„¶åœ°å°±æˆäº†ä¼ä¸šçš„CRM(å®¢æˆ·ç®¡ç†ç³»ç»Ÿ)å¹³å°æ¥é¢å¯¹å¿ å®ç”¨æˆ·ï¼Œè¿™ä¹Ÿç»™äº†ä¼ä¸šå°†æœåŠ¡å¼•å…¥å¹³å°çš„æœºä¼šã€‚</p>
   <a id="more"></a>
<h2 id="ä¸»è¦æ¨¡æ¿"><a href="#ä¸»è¦æ¨¡æ¿" class="headerlink" title="ä¸»è¦æ¨¡æ¿"></a>ä¸»è¦æ¨¡æ¿</h2><p>å¾®ä¿¡å…¬ä¼—è´¦å·ä¸ä¼šåšå¤ªå¤šæ·±åº¦çš„å¼€æ”¾ï¼Œä¸ºäº†æŠŠå¾®ä¿¡åšå¾—æ›´â€œè½»â€ã€‚åœ¨2013å¹´6æœˆä»½çš„åˆä½œä¼™ä¼´å¤§ä¼šä¸Šï¼Œå¾®ä¿¡äº§å“éƒ¨åŠ©ç†æ›¾é¸£æå‡ºï¼Œå¾®ä¿¡å…¬ä¼—è´¦å·ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„è¥é”€å·¥å…·ï¼Œè®©å…¬ä¼—è´¦å·æä¾›æœ€ä½“ç°ä¼ä¸šä»·å€¼çš„ä¸œè¥¿ã€‚</p>
<ul>
<li>åœ¨çº¿è¥é”€ï¼šå‘ç»ˆç«¯å®¢æˆ·æ¨èæ–°å“ã€ä¿ƒé”€ç­–ç•¥ç­‰ï¼›</li>
<li>å”®åæœåŠ¡ï¼šé€šè¿‡å¾®ä¿¡å¹³å°ï¼Œè‡ªåŠ¨ä¸å®¢æˆ·è¿›è¡Œäº¤äº’ï¼Œå±•ç¤ºä¼ä¸šäº§å“ã€å”®åæ”¯æŒï¼›</li>
<li>ç”µå­å•†åŠ¡ï¼šå°†ä¼ä¸šç½‘ç«™æˆ–è´­ç‰©å¹³å°ä¸å¾®ä¿¡å¯¹æ¥ï¼Œæ¨èåˆ°æœ‹å‹åœˆè·å–å…è´¹å®£ä¼ ï¼›</li>
<li>ä¼šå‘˜ç®¡ç†ï¼šä¼ä¸šä¼šå‘˜å¯é€šè¿‡å¾®ä¿¡å¹³å°è¿›è¡Œçº¿ä¸‹æ´»åŠ¨é¢„çº¦ã€ç§¯åˆ†ç®¡ç†ç­‰æ“ä½œã€‚</li>
</ul>
<h2 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a>ä¸»è¦åŠŸèƒ½</h2><p>å…¬ä¼—å¹³å°æ˜¯ä¼ä¸šåœ¨OTTäº§å“åŸºç¡€ä¸Šæ–°å¢çš„åŠŸèƒ½æ¨¡å—ï¼ŒåŸºäºâ€œå†å°çš„ä¸ªä½“ä¹Ÿæœ‰è‡ªå·±å“ç‰Œâ€è¿™ä¸€ç†å¿µã€‚é€šè¿‡è¿™ä¸€å¹³å°ï¼Œä¸ªäººå’Œä¼ä¸šéƒ½å¯ä»¥æ‰“é€ ä¸€ä¸ªå…¬ä¼—å·ï¼Œå¹¶å®ç°å’Œç‰¹å®šç¾¤ä½“çš„æ–‡å­—ã€å›¾ç‰‡ã€è¯­éŸ³çš„å…¨æ–¹ä½æ²Ÿé€šã€äº’åŠ¨ã€‚åŒæ—¶ï¼Œä¼ä¸šä¹Ÿå¯ä»¥åˆ©ç”¨å…¬ä¼—å¹³å°è¿›è¡ŒCRMå¼ç®¡ç†ï¼Œä¸ªäººå¯ä»¥è¿›è¡Œè‡ªåª’ä½“åˆ›ä½œã€‚</p>
<h3 id="å¾®ä¿¡å®˜ç½‘"><a href="#å¾®ä¿¡å®˜ç½‘" class="headerlink" title="å¾®ä¿¡å®˜ç½‘"></a>å¾®ä¿¡å®˜ç½‘</h3><ol>
<li>å…¬å¸ä»‹ç»ï¼šæ”¯æŒå¤šçº§åˆ†ç±»ï¼›</li>
<li>äº§å“å±•ç¤ºï¼šäº§å“æ”¯æŒå¤šå›¾æ˜¾ç¤ºï¼Œæ‰‹æŒ‡æ»‘åŠ¨æµè§ˆå›¾ç‰‡ï¼›</li>
<li>æ–°é—»èµ„è®¯ï¼šå¯¹æ¥å¾®ä¿¡å…¬ä¼—å¹³å°æ¶ˆæ¯æ¨é€ï¼›</li>
<li>è”ç³»æ–¹å¼ï¼šLBSåœ°å›¾ä½ç½®æ ‡æ³¨ï¼Œç‚¹å‡»ç”µè¯å·ç ç›´æ¥æ‹¨æ‰“ï¼›</li>
<li>ä¿¡æ¯æ¨é€ï¼šä»¥å¾®ä¿¡å®˜æ–¹è§„å®šçš„æ¶ˆæ¯æ¨é€ä¸ºæ ‡å‡†ã€‚</li>
</ol>
<h3 id="å¾®ä¿¡å®¢æœ"><a href="#å¾®ä¿¡å®¢æœ" class="headerlink" title="å¾®ä¿¡å®¢æœ"></a>å¾®ä¿¡å®¢æœ</h3><ol>
<li>å¤šäººå·¥å®¢æœï¼šå®ç°å¤šä¸ªäººå·¥å®¢æœåœ¨çº¿ä¸å¾®ä¿¡å…¬ä¼—å¹³å°å®¢æˆ·æ²Ÿé€šï¼›</li>
<li>LBSä½ç½®æœåŠ¡ï¼šç”¨æˆ·ç»è¿‡å¾®ä¿¡æä¾›ä½ç½®ï¼Œå…¬ä¼—å¹³å°è‡ªåŠ¨åº”ç­”ç¦»ç”¨æˆ·æœ€è¿‘çš„é—¨åº—ã€ç»é”€å•†ï¼›</li>
<li>å»ºè®®/æŠ•è¯‰/å”®åï¼šå¾®ä¿¡å¹³å°å†…åµŒå”®åæœåŠ¡è¡¨å•ã€‚</li>
</ol>
<h3 id="å¾®ä¿¡å•†åŸ"><a href="#å¾®ä¿¡å•†åŸ" class="headerlink" title="å¾®ä¿¡å•†åŸ"></a>å¾®ä¿¡å•†åŸ</h3><ol>
<li>åœ¨çº¿è®¢è´­ï¼šæ”¯æŒç°æœ‰å•†åŸç³»ç»Ÿè¿›è¡Œå¯¹æ¥ï¼›</li>
<li>ä¼šå‘˜ç³»ç»Ÿï¼šæ”¯æŒç°æœ‰ä¼šå‘˜ç³»ç»Ÿè¿›è¡Œå¯¹æ¥ï¼›</li>
<li>åœ¨çº¿æ”¯ä»˜ï¼šæ”¯æŒåœ¨çº¿æ”¯ä»˜åŠŸèƒ½ï¼Œè‹¥æ— éœ€åœ¨çº¿æ”¯ä»˜ï¼Œåˆ™åªè®°å½•è®¢å•ä¿¡æ¯ä¸æµç¨‹ã€‚</li>
</ol>
<h3 id="æ´»åŠ¨ä¸ä¿ƒé”€"><a href="#æ´»åŠ¨ä¸ä¿ƒé”€" class="headerlink" title="æ´»åŠ¨ä¸ä¿ƒé”€"></a>æ´»åŠ¨ä¸ä¿ƒé”€</h3><ol>
<li>æ´»åŠ¨å‘å¸ƒï¼šè½¯å•†ç³»ç»Ÿç›´æ¥å¯¹æ¥å¾®ä¿¡å¹³å°å‘å¸ƒï¼›</li>
<li>æŠ½å¥–åˆ®åˆ®å¡ï¼šæ”¯æŒç³»ç»Ÿè‡ªå®šä¹‰å¥–å“ã€‚</li>
<li>æŠ½å¥–è½¬ç›˜ï¼šæ”¯æŒç³»ç»Ÿè‡ªå®šä¹‰å¥–å“ã€‚</li>
</ol>
<h2 id="å¼€æ”¾æ¥å£"><a href="#å¼€æ”¾æ¥å£" class="headerlink" title="å¼€æ”¾æ¥å£"></a>å¼€æ”¾æ¥å£</h2><p>å…¬ä¼—å¹³å°æ¨å‡ºæ–°çš„è®¤è¯ä½“ç³»ï¼Œå¾®ä¿¡å°†å…è´¹å¼€æ”¾åœ°ç†ä½ç½®ã€å®¢æœã€è¯­éŸ³ç­‰ä¹å¤§é«˜çº§æŠ€æœ¯æ¥å£ ã€‚é’ˆå¯¹æœåŠ¡å·é¢†åŸŸï¼Œå¾®ä¿¡è¿˜å°†æ¨å‡ºä¸€äº›å‚ç›´é¢†åŸŸå®šåˆ¶ã€‚å¾®ä¿¡äº§å“éƒ¨æ¨¡å¼è¯†åˆ«ä¸­å¿ƒæ€»ç›‘é™ˆæ³¢é€éœ²ï¼Œå›¾åƒè¯†åˆ«è¿˜å°†ä¸å¾®ä¿¡æ”¯ä»˜ç»“åˆï¼Œæä¾›è´­ä¹°æµç¨‹ã€‚è¿™ä¸¤ä¸ªæŠ€æœ¯ä¸»è¦ä¸ºå…¬ä¼—å¹³å°æä¾›æœåŠ¡ï¼Œåç»­å°†å‘Appå¼€æ”¾ã€‚</p>
<ol>
<li>è¯­éŸ³è¯†åˆ«æ¥å£</li>
<li>å®¢æœæ¥å£</li>
<li>OAuth2.0 ç½‘é¡µæˆæƒæ¥å£</li>
<li>ç”Ÿæˆå¸¦å‚æ•°çš„äºŒç»´ç æ¥å£</li>
<li>è·å–ç”¨æˆ·åœ°ç†ä½ç½®æ¥å£</li>
<li>è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æ¥å£</li>
<li>è·å–å…³æ³¨è€…åˆ—è¡¨æ¥å£</li>
<li>ç”¨æˆ·åˆ†ç»„æ¥å£</li>
<li>ä¸Šä¼ ä¸‹è½½å¤šåª’ä½“æ–‡ä»¶æ¥å£</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¾®ä¿¡å¼€å‘å³å¾®ä¿¡å…¬ä¼—å¹³å°å¼€å‘ï¼Œå°†ä¼ä¸šä¿¡æ¯ã€æœåŠ¡ã€æ´»åŠ¨ç­‰å†…å®¹é€šè¿‡å¾®ä¿¡ç½‘é¡µçš„æ–¹å¼è¿›è¡Œè¡¨ç°ï¼Œç”¨æˆ·é€šè¿‡ç®€å•çš„è®¾ç½®ï¼Œå°±èƒ½ç”Ÿæˆå¾®ä¿¡3Gç½‘ç«™ã€‚é€šè¿‡å¾®ä¿¡å…¬ä¼—å¹³å°å°†ä¼ä¸šå“ç‰Œå±•ç¤ºç»™å¾®ä¿¡ç”¨æˆ·ï¼Œå‡å°‘å®£ä¼ æˆæœ¬ï¼Œå»ºç«‹ä¼ä¸šä¸æ¶ˆè´¹è€…ã€å®¢æˆ·çš„ä¸€å¯¹ä¸€äº’åŠ¨å’Œæ²Ÿé€šï¼Œå°†æ¶ˆè´¹è€…æ¥å…¥ä¼ä¸šCRMç³»ç»Ÿï¼Œè¿›è¡Œä¿ƒé”€ã€æ¨å¹¿ã€å®£ä¼ ã€å”®åç­‰ã€‚å½¢æˆäº†ä¸€ç§ä¸»æµçš„çº¿ä¸Šçº¿ä¸‹å¾®ä¿¡äº’åŠ¨è¥é”€æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡äºŒæ¬¡å¼€å‘å¯ä»¥å°†å…¬ä¼—è´¦å·ç”±ä¸€ä¸ªåª’ä½“å‹è¥é”€å·¥å…·è½¬åŒ–æˆæä¾›æœåŠ¡çš„äº§å“ã€‚è€Œä¸€æ—¦æˆä¸ºç”¨æˆ·éœ€è¦çš„äº§å“ï¼Œå…¬ä¼—è´¦å·çš„è¥é”€åŠŸèƒ½ä¾¿ä¼šå¼€å¯ã€‚&lt;br&gt;å¾®ä¿¡çš„æ ¸å¿ƒæ˜¯é€šè®¯å·¥å…·ï¼Œè¿™ä¸€å·¥å…·å±æ€§å°†ç”¨æˆ·ç‰¢ç‰¢åœ°é»åœ¨äº†å¹³å°ä¹‹ä¸Šã€‚ç”¨æˆ·å’Œä¼ä¸šå¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸Šé¢è¿›è¡Œæ²Ÿé€šï¼Œæ‰€ä»¥å¾®ä¿¡å¾ˆè‡ªç„¶åœ°å°±æˆäº†ä¼ä¸šçš„CRM(å®¢æˆ·ç®¡ç†ç³»ç»Ÿ)å¹³å°æ¥é¢å¯¹å¿ å®ç”¨æˆ·ï¼Œè¿™ä¹Ÿç»™äº†ä¼ä¸šå°†æœåŠ¡å¼•å…¥å¹³å°çš„æœºä¼šã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/tags/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å¼€å‘ - å¿«é€Ÿå…¥é—¨</title>
    <link href="http://yoursite.com/2016/09/02/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%20-%20%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://yoursite.com/2016/09/02/å¾®ä¿¡å¼€å‘ - å¿«é€Ÿå…¥é—¨/</id>
    <published>2016-09-01T18:24:00.000Z</published>
    <updated>2016-09-02T12:03:15.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å¾®ä¿¡æ˜¯ä¸€ä¸ªç”Ÿæ´»æ–¹å¼ï¼Œå¼ å°é¾™æå‡ºçš„è¿™ä¸ªæ„¿æ™¯å·²ç»å¾—åˆ°äº†è¶Šæ¥è¶Šæ¸…æ™°çš„ä½“ç°ã€‚</p>
</blockquote>
<p>ç¾¤èŠã€è¯­éŸ³ã€è§†é¢‘ï¼Œç…§ç‰‡/è§†é¢‘/ä½ç½®å…±äº«ï¼Œæ”¯ä»˜å’Œå•†åº—éƒ½æœ‰äº†ï¼Œè¿˜èƒ½é€šè¿‡å…¬ä¼—è´¦å·æ¥è·å–å„ç§èµ„æºâ€¦â€¦</p>
<p>å¦‚ä»Šçš„å¾®ä¿¡å°±æ˜¯åœ¨æ—¥ä¸­å¤©çš„çŠ¶æ€ï¼Œå…¬ä¼—å¹³å°å¸¦æ¥çš„å½±å“æœ‰ç›®å…±ç¹ï¼Œæ‰€ä»¥å¾ˆå¤šå…¬å¸å’Œä¸ªäººéƒ½å¸Œæœ›æœ‰è‡ªå·±çš„å…¬ä¼—å·ï¼Œæƒ³å……åˆ†åˆ©ç”¨å´æ— å¤„ä¸‹æ‰‹ï¼Œä¸‹é¢æˆ‘ä»¬åˆ†ä¸ºå‡ ç¯‡æ–‡ç« ï¼Œç”±æµ…å…¥æ·±çš„äº†è§£å¾®ä¿¡å¼€å‘ã€‚</p>
<p>åœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­ï¼Œéœ€è¦ä½ å…·æœ‰PHPè¯­è¨€çš„åŸºç¡€ï¼Œå¹¶æ‹¥æœ‰ä¸€å°å…·æœ‰PHPè¿è¡Œç¯å¢ƒçš„ä¸»æœºï¼Œå¦‚æœè¿˜æ²¡æœ‰å¯ä»¥é€šè¿‡æ–°æµªSAEï¼Œé˜¿é‡Œäº‘ECSç­‰è¿›è¡Œæ­å»ºã€‚</p>
<p>ä¸‹é¢è¿›å…¥æ­£é¢˜ï¼</p>
   <a id="more"></a>
<h2 id="æ¥å…¥å¼€å‘è€…æ¨¡å¼"><a href="#æ¥å…¥å¼€å‘è€…æ¨¡å¼" class="headerlink" title="æ¥å…¥å¼€å‘è€…æ¨¡å¼"></a>æ¥å…¥å¼€å‘è€…æ¨¡å¼</h2><p>æ¥å…¥å¼€å‘è€…æ¨¡å¼éå¸¸ç®€å•ï¼Œä¸»è¦åˆ†ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>ä¸‹è½½å®˜æ–¹æ¥å£æ–‡ä»¶ï¼›</li>
<li>ç®€å•è°ƒæ•´æ¥å£æ–‡ä»¶çš„ä»£ç ï¼›</li>
<li>å°†è°ƒæ•´å¥½çš„æ¥å£æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼›</li>
<li>åœ¨å¼€å‘è€…åå°è¿›è¡Œæ¥å£çš„éªŒè¯ï¼›</li>
</ol>
<p>é¦–å…ˆä¸‹è½½PHPæ¥å£æ–‡ä»¶ï¼Œä¸‹è½½åœ°å€è¯·ç‚¹å‡»<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">å¾®ä¿¡å…¬ä¼—å¹³å°å¼€å‘è€…æ–‡æ¡£</a>ã€‚</p>
<p>å°†åŸæœ‰çš„ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">define(<span class="string">"TOKEN"</span>, <span class="string">"weixin"</span>);</div><div class="line">$wechatObj = <span class="keyword">new</span> wechatCallbackapiTest();</div><div class="line">$wechatObj-&gt;valid();</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">define(<span class="string">"TOKEN"</span>, <span class="string">"wechat"</span>);</div><div class="line"></div><div class="line">$wechatObj = <span class="keyword">new</span> wechatCallbackapiTest();</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($_GET[<span class="string">"echostr"</span>]) &#123;</div><div class="line">    $wechatObj-&gt;valid();</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    $wechatObj-&gt;responseMsg();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åå°†ä¿®æ”¹åçš„PHPæ–‡ä»¶ä¸Šä¼ è‡³ä½ çš„æœåŠ¡å™¨ï¼Œè¿›å…¥ï¼š</p>
<blockquote>
<p>å¾®ä¿¡å…¬ä¼—å¹³å° &gt; å¼€å‘ &gt; åŸºæœ¬é…ç½® &gt; æœåŠ¡å™¨é…ç½® &gt; ä¿®æ”¹é…ç½®</p>
</blockquote>
<p>åœ¨å¼¹å‡ºçš„<strong>åŸºæœ¬é…ç½®/ å¡«å†™æœåŠ¡å™¨é…ç½®</strong>ä¸­ï¼š</p>
<blockquote>
<p>URLå¡«å†™ä½ çš„PHPæ–‡ä»¶åœ°å€ï¼Œå¦‚ï¼š<code>https://localhost/filepath/wx_sample.php</code> ï¼›</p>
<p>Tokenå¡«å†™ä½ åœ¨PHPæ–‡ä»¶ä¸­è®¾å®šçš„å€¼ï¼Œå¦‚ï¼š<code>define(&quot;TOKEN&quot;, &quot;wechat&quot;);</code>ï¼Œå¡«å†™<code>wechat</code> ï¼›</p>
<p>EncodingAESKeyä½¿ç”¨<code>éšæœºç”Ÿæˆ</code>å³å¯ï¼›</p>
<p>æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼é€‰æ‹©<code>æ˜æ–‡æ¨¡å¼</code>å³å¯ï¼›</p>
</blockquote>
<p>ç‚¹å‡»æäº¤ï¼Œå°±å®Œæˆäº†å¼€å‘è€…æ¨¡å¼çš„æ¥å…¥ã€‚</p>
<h2 id="å¼€å‘è€…æ¨¡å¼ä¸‹æ•°æ®ä¼ è¾“åŠå¤„ç†"><a href="#å¼€å‘è€…æ¨¡å¼ä¸‹æ•°æ®ä¼ è¾“åŠå¤„ç†" class="headerlink" title="å¼€å‘è€…æ¨¡å¼ä¸‹æ•°æ®ä¼ è¾“åŠå¤„ç†"></a>å¼€å‘è€…æ¨¡å¼ä¸‹æ•°æ®ä¼ è¾“åŠå¤„ç†</h2><p> <img src="http://oboehz2ag.bkt.clouddn.com/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93.gif" alt="å¾®ä¿¡å¼€å‘æ¨¡å¼æ•°æ®ä¼ è¾“"></p>
<p>äº†è§£å¼€å‘è€…æ¨¡å¼ä¸‹çš„æ•°æ®ä¼ è¾“åï¼Œæˆ‘ä»¬å¼€å§‹ç¼–å†™ç¬¬ä¸€ä¸ªç¨‹åºã€‚</p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>æ²¡é”™ï¼Œå°±æ˜¯ä»å®ƒå¼€å§‹â€¦â€¦</p>
<p>å®ç°Hello Worldéå¸¸ç®€å•ï¼Œé¦–å…ˆç¼–å†™ç¨‹åºä»£ç ï¼Œå°†PHPæ–‡ä»¶ä¸­åŸä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>( $keyword )) &#123;</div><div class="line">	$msgType = <span class="string">"text"</span>;</div><div class="line">	$contentStr = <span class="string">"Welcome to wechat world!"</span>;</div><div class="line">	$resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">	<span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"Input something..."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>( $keyword )) &#123;</div><div class="line">	$msgType = <span class="string">"text"</span>;</div><div class="line">	$contentStr = $keyword.<span class="string">"World"</span>;</div><div class="line">	$resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">	<span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"Input something..."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œå‘ä½ çš„å…¬ä¼—å·å‘é€ä¸€ä¸ª<code>Hello</code>ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ª<code>Hello World</code>ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å·²ç»æ˜ç™½ï¼Œ<strong><code>$keyword</code>è¿™ä¸ªå˜é‡ï¼Œå°±æ˜¯ç”¨æˆ·å‘é€çš„æ–‡æœ¬ä¿¡æ¯</strong>ã€‚</p>
<p>è¿™æ—¶å½“ç”¨æˆ·å‘é€è¯­éŸ³ï¼Œå›¾ç‰‡ï¼Œä½ç½®ç­‰ä¿¡æ¯æ—¶ï¼Œå› ä¸ºPHPæ–‡ä»¶å¯¹æ­¤æ²¡æœ‰è¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼Œæ‰€ä»¥ç”¨æˆ·è®¾å¤‡ä¼šæ”¶åˆ°<strong>è¯¥å…¬ä¼—å·æš‚æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œè¯·ç¨åå†è¯•</strong>ã€‚</p>
<h2 id="è¢«åŠ¨å›å¤æ¶ˆæ¯"><a href="#è¢«åŠ¨å›å¤æ¶ˆæ¯" class="headerlink" title="è¢«åŠ¨å›å¤æ¶ˆæ¯"></a>è¢«åŠ¨å›å¤æ¶ˆæ¯</h2><p>å½“ç”¨æˆ·å‘é€æ¶ˆæ¯ç»™å…¬ä¼—å·æ—¶ï¼ˆæˆ–æŸäº›ç‰¹å®šçš„ç”¨æˆ·æ“ä½œå¼•å‘çš„äº‹ä»¶æ¨é€æ—¶ï¼‰ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå¼€å‘è€…å¯ä»¥åœ¨å“åº”åŒ…ï¼ˆGetï¼‰ä¸­è¿”å›ç‰¹å®šXMLç»“æ„ï¼Œæ¥å¯¹è¯¥æ¶ˆæ¯è¿›è¡Œå“åº”ï¼ˆç°æ”¯æŒå›å¤æ–‡æœ¬ã€å›¾ç‰‡ã€å›¾æ–‡ã€è¯­éŸ³ã€è§†é¢‘ã€éŸ³ä¹ï¼‰ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œå‘é€è¢«åŠ¨å“åº”æ¶ˆæ¯å…¶å®å¹¶ä¸æ˜¯ä¸€ç§æ¥å£ï¼Œè€Œæ˜¯å¯¹å¾®ä¿¡æœåŠ¡å™¨å‘è¿‡æ¥æ¶ˆæ¯çš„ä¸€æ¬¡å›å¤ã€‚</p>
<p><strong>ä¸€æ—¦é‡åˆ°ä»¥ä¸‹æƒ…å†µï¼Œå¾®ä¿¡éƒ½ä¼šåœ¨å…¬ä¼—å·ä¼šè¯ä¸­ï¼Œå‘ç”¨æˆ·ä¸‹å‘ç³»ç»Ÿæç¤ºâ€œè¯¥å…¬ä¼—å·æš‚æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œè¯·ç¨åå†è¯•â€ï¼š</strong></p>
<blockquote>
<p>1ã€å¼€å‘è€…åœ¨5ç§’å†…æœªå›å¤ä»»ä½•å†…å®¹</p>
<p>2ã€å¼€å‘è€…å›å¤äº†å¼‚å¸¸æ•°æ®ï¼Œæ¯”å¦‚JSONæ•°æ®ç­‰</p>
</blockquote>
<p>å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œå›å¤å›¾ç‰‡ç­‰å¤šåª’ä½“æ¶ˆæ¯æ—¶éœ€è¦é¢„å…ˆé€šè¿‡ç´ æç®¡ç†æ¥å£ä¸Šä¼ ä¸´æ—¶ç´ æåˆ°å¾®ä¿¡æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ç´ æç®¡ç†ä¸­çš„ä¸´æ—¶ç´ æï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ°¸ä¹…ç´ æã€‚</p>
<p>è¢«åŠ¨å›å¤æ”¯æŒçš„æ¶ˆæ¯ç±»å‹æœ‰ï¼š</p>
<p><strong>æ–‡æœ¬ã€å›¾ç‰‡ã€è¯­éŸ³ã€è§†é¢‘ã€éŸ³ä¹</strong></p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰å¯ä»¥åŒ…æ‹¬ä»¥ä¸Šæ‰€æœ‰ç±»å‹çš„<strong>å›¾æ–‡æ¶ˆæ¯</strong>ã€‚</p>
<p>å„æ¶ˆæ¯ç±»å‹æ˜¯ç”±XMLæ•°æ®åŒ…æ„æˆï¼Œå…³äºæ•°æ®åŒ…çš„æ ¼å¼è¯·è®¿é—®<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421140543&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">å¾®ä¿¡å¼€å‘è€…æ–‡æ¡£</a>ã€‚</p>
<h2 id="å…³æ³¨äº‹ä»¶å¤„ç†"><a href="#å…³æ³¨äº‹ä»¶å¤„ç†" class="headerlink" title="å…³æ³¨äº‹ä»¶å¤„ç†"></a>å…³æ³¨äº‹ä»¶å¤„ç†</h2><p>ç”¨æˆ·åœ¨å…³æ³¨ä¸å–æ¶ˆå…³æ³¨å…¬ä¼—å·æ—¶ï¼Œå¾®ä¿¡ä¼šæŠŠè¿™ä¸ªäº‹ä»¶æ¨é€åˆ°å¼€å‘è€…å¡«å†™çš„URLã€‚æ–¹ä¾¿å¼€å‘è€…ç»™ç”¨æˆ·ä¸‹å‘æ¬¢è¿æ¶ˆæ¯æˆ–è€…åšå¸å·çš„è§£ç»‘ã€‚</p>
<p><strong>å…³æ³¨äº‹ä»¶å®é™…ä¸Šæ˜¯è·å–Eventäº‹ä»¶ç±»å‹ï¼Œå¹¶è®¾ç½®ä¸åŒæ¶ˆæ¯ç±»å‹çš„XMLæ•°æ®åŒ…æ¨é€åˆ°ç”¨æˆ·è®¾å¤‡</strong>ã€‚</p>
<p>æ¨é€XMLæ•°æ®åŒ…ç¤ºä¾‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">xml</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ToUserName</span>&gt;</span>&lt;![CDATA[toUser]]&gt;<span class="tag">&lt;/<span class="name">ToUserName</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">FromUserName</span>&gt;</span>&lt;![CDATA[FromUser]]&gt;<span class="tag">&lt;/<span class="name">FromUserName</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">CreateTime</span>&gt;</span>123456789<span class="tag">&lt;/<span class="name">CreateTime</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">MsgType</span>&gt;</span>&lt;![CDATA[event]]&gt;<span class="tag">&lt;/<span class="name">MsgType</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Event</span>&gt;</span>&lt;![CDATA[subscribe]]&gt;<span class="tag">&lt;/<span class="name">Event</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></div></pre></td></tr></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToUserName</td>
<td>å¼€å‘è€…å¾®ä¿¡å·</td>
</tr>
<tr>
<td>FromUserName</td>
<td>å‘é€æ–¹å¸å·ï¼ˆä¸€ä¸ªOpenIDï¼‰</td>
</tr>
<tr>
<td>CreateTime</td>
<td>æ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´å‹ï¼‰</td>
</tr>
<tr>
<td>MsgType</td>
<td>æ¶ˆæ¯ç±»å‹ï¼Œevent</td>
</tr>
<tr>
<td>Event</td>
<td>äº‹ä»¶ç±»å‹ï¼Œsubscribe(è®¢é˜…)ã€unsubscribe(å–æ¶ˆè®¢é˜…)</td>
</tr>
</tbody>
</table>
<h3 id="å…³æ³¨äº‹ä»¶æ–‡å­—å›å¤"><a href="#å…³æ³¨äº‹ä»¶æ–‡å­—å›å¤" class="headerlink" title="å…³æ³¨äº‹ä»¶æ–‡å­—å›å¤"></a>å…³æ³¨äº‹ä»¶æ–‡å­—å›å¤</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å–Eventå‚æ•°ï¼Œå¹¶å¯¹Eventè¿›è¡Œç›¸åº”çš„å¤„ç†ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">$postObj = simplexml_load_string($postStr, <span class="string">'SimpleXMLElement'</span>, LIBXML_NOCDATA);</div><div class="line">$fromUsername = $postObj-&gt;FromUserName;</div><div class="line">$toUsername = $postObj-&gt;ToUserName;</div><div class="line">$keyword = trim($postObj-&gt;Content);</div><div class="line">$event = $postObj-&gt;Event;</div><div class="line">$time = time();</div><div class="line">$textTpl = <span class="string">"&lt;xml&gt;</span></div><div class="line">			&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;</div><div class="line">			&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;</div><div class="line">			&lt;CreateTime&gt;%s&lt;/CreateTime&gt;</div><div class="line">			&lt;MsgType&gt;&lt;![CDATA[%s]]&gt;&lt;/MsgType&gt;</div><div class="line">			&lt;Content&gt;&lt;![CDATA[%s]]&gt;&lt;/Content&gt;</div><div class="line">			&lt;FuncFlag&gt;0&lt;/FuncFlag&gt;</div><div class="line">			&lt;/xml&gt;";</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($event == <span class="string">"subscribe"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"è®¢é˜…äº‹ä»¶"</span>;</div><div class="line">    $msgType = <span class="string">"text"</span>;</div><div class="line">    $contentStr = <span class="string">"æ¬¢è¿å…³æ³¨superliar"</span>;</div><div class="line">    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span> ($event == <span class="string">"unsubscribe"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"å–æ¶ˆè®¢é˜…äº‹ä»¶"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ—¶æˆ‘ä»¬å–æ¶ˆå…³æ³¨çš„å…¬ä¼—å·ï¼Œå†é‡æ–°å…³æ³¨å®ƒï¼Œä¼šæ”¶åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">æ¬¢è¿å…³æ³¨superliar</div></pre></td></tr></table></figure>
<h3 id="å…³æ³¨äº‹ä»¶å›¾æ–‡å›å¤"><a href="#å…³æ³¨äº‹ä»¶å›¾æ–‡å›å¤" class="headerlink" title="å…³æ³¨äº‹ä»¶å›¾æ–‡å›å¤"></a>å…³æ³¨äº‹ä»¶å›¾æ–‡å›å¤</h3><p>å›¾æ–‡æ¶ˆæ¯çš„XMLåŒ…ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">xml</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ToUserName</span>&gt;</span>&lt;![CDATA[toUser]]&gt;<span class="tag">&lt;/<span class="name">ToUserName</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">FromUserName</span>&gt;</span>&lt;![CDATA[fromUser]]&gt;<span class="tag">&lt;/<span class="name">FromUserName</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">CreateTime</span>&gt;</span>12345678<span class="tag">&lt;/<span class="name">CreateTime</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">MsgType</span>&gt;</span>&lt;![CDATA[news]]&gt;<span class="tag">&lt;/<span class="name">MsgType</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ArticleCount</span>&gt;</span>2<span class="tag">&lt;/<span class="name">ArticleCount</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Articles</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Title</span>&gt;</span>&lt;![CDATA[title1]]&gt;<span class="tag">&lt;/<span class="name">Title</span>&gt;</span> </div><div class="line"><span class="tag">&lt;<span class="name">Description</span>&gt;</span>&lt;![CDATA[description1]]&gt;<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">PicUrl</span>&gt;</span>&lt;![CDATA[picurl]]&gt;<span class="tag">&lt;/<span class="name">PicUrl</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Url</span>&gt;</span>&lt;![CDATA[url]]&gt;<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Title</span>&gt;</span>&lt;![CDATA[title]]&gt;<span class="tag">&lt;/<span class="name">Title</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Description</span>&gt;</span>&lt;![CDATA[description]]&gt;<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">PicUrl</span>&gt;</span>&lt;![CDATA[picurl]]&gt;<span class="tag">&lt;/<span class="name">PicUrl</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Url</span>&gt;</span>&lt;![CDATA[url]]&gt;<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Articles</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></div></pre></td></tr></table></figure>
<p>å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æ˜¯å¦å¿…é¡»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToUserName</td>
<td>æ˜¯</td>
<td>æ¥æ”¶æ–¹å¸å·ï¼ˆæ”¶åˆ°çš„OpenIDï¼‰</td>
</tr>
<tr>
<td>FromUserName</td>
<td>æ˜¯</td>
<td>å¼€å‘è€…å¾®ä¿¡å·</td>
</tr>
<tr>
<td>CreateTime</td>
<td>æ˜¯</td>
<td>æ¶ˆæ¯åˆ›å»ºæ—¶é—´ ï¼ˆæ•´å‹ï¼‰</td>
</tr>
<tr>
<td>MsgType</td>
<td>æ˜¯</td>
<td>news</td>
</tr>
<tr>
<td>ArticleCount</td>
<td>æ˜¯</td>
<td>å›¾æ–‡æ¶ˆæ¯ä¸ªæ•°ï¼Œé™åˆ¶ä¸º10æ¡ä»¥å†…</td>
</tr>
<tr>
<td>Articles</td>
<td>æ˜¯</td>
<td>å¤šæ¡å›¾æ–‡æ¶ˆæ¯ä¿¡æ¯ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªitemä¸ºå¤§å›¾,æ³¨æ„ï¼Œå¦‚æœå›¾æ–‡æ•°è¶…è¿‡10ï¼Œåˆ™å°†ä¼šæ— å“åº”</td>
</tr>
<tr>
<td>Title</td>
<td>å¦</td>
<td>å›¾æ–‡æ¶ˆæ¯æ ‡é¢˜</td>
</tr>
<tr>
<td>Description</td>
<td>å¦</td>
<td>å›¾æ–‡æ¶ˆæ¯æè¿°</td>
</tr>
<tr>
<td>PicUrl</td>
<td>å¦</td>
<td>å›¾ç‰‡é“¾æ¥ï¼Œæ”¯æŒJPGã€PNGæ ¼å¼ï¼Œè¾ƒå¥½çš„æ•ˆæœä¸ºå¤§å›¾360<em>200ï¼Œå°å›¾200</em>200</td>
</tr>
<tr>
<td>Url</td>
<td>å¦</td>
<td>ç‚¹å‡»å›¾æ–‡æ¶ˆæ¯è·³è½¬é“¾æ¥</td>
</tr>
</tbody>
</table>
<p><code>MsgTyp</code>æè¿°çš„æ˜¯æ¨é€æ¶ˆæ¯çš„ç±»å‹ï¼Œå¦‚<code>text\image\voice\video\music\news</code>ç­‰ã€‚</p>
<p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªå›¾æ–‡æ¶ˆæ¯ç±»å‹çš„XMLåŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$newsTpl = "<span class="tag">&lt;<span class="name">xml</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">ToUserName</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">ToUserName</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">FromUserName</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">FromUserName</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">CreateTime</span>&gt;</span>%s<span class="tag">&lt;/<span class="name">CreateTime</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">MsgType</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">MsgType</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">ArticleCount</span>&gt;</span>2<span class="tag">&lt;/<span class="name">ArticleCount</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Articles</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">item</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Title</span>&gt;</span>&lt;![CDATA[æ¬¢è¿å…³æ³¨superliar]]&gt;<span class="tag">&lt;/<span class="name">Title</span>&gt;</span> </div><div class="line">           <span class="tag">&lt;<span class="name">Description</span>&gt;</span>&lt;![CDATA[superliaræ˜¯ä¸€ä¸ªçœŸäººç§€èŠ‚ç›®,balabalabalabalabalabalabalabala]]&gt;<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">PicUrl</span>&gt;</span>&lt;![CDATA[http://i2.hdslb.com/bfs/archive/e4d44a24ef5b838db63ac6c4c5fda0302102fb23.jpg]]&gt;<span class="tag">&lt;/<span class="name">PicUrl</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Url</span>&gt;</span>&lt;![CDATA[http://www.panda.tv/]]&gt;<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">item</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Title</span>&gt;</span>&lt;![CDATA[ç©ç‹¼äººæ€æœ‰ä»€ä¹ˆç‹¬å®¶æŠ€å·§?]]&gt;<span class="tag">&lt;/<span class="name">Title</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Description</span>&gt;</span>&lt;![CDATA[ä¸€ä¸ªç©å®¶åšäº†ä»€ä¹ˆä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯è¦çŸ¥é“taä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚]]&gt;<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">PicUrl</span>&gt;</span>&lt;![CDATA[http://i0.hdslb.com/bfs/archive/b957f527aadaddc3c32287f0ff5c1858df696658.jpg]]&gt;<span class="tag">&lt;/<span class="name">PicUrl</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">Url</span>&gt;</span>&lt;![CDATA[https://www.zhihu.com/question/25833846]]&gt;<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">Articles</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">xml</span>&gt;</span>";</div></pre></td></tr></table></figure>
<p>ç„¶åå°†è®¢é˜…çš„Eventäº‹ä»¶å¤„ç†ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($event == <span class="string">"subscribe"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"è®¢é˜…äº‹ä»¶"</span>;</div><div class="line">    $msgType = <span class="string">"news"</span>;</div><div class="line">    $resultStr = sprintf($newsTpl, $fromUsername, $toUsername, $time, $msgType);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span> ($event == <span class="string">"unsubscribe"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"å–æ¶ˆè®¢é˜…äº‹ä»¶"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶å†é‡æ–°å…³æ³¨ï¼Œæ”¶åˆ°çš„å°±æ˜¯ä¸€æ¡å›¾æ–‡æ¶ˆæ¯äº†ï¼Œå…¶ä»–ç±»å‹çš„æ¶ˆæ¯ä¹Ÿæ˜¯åŒæ ·çš„åŸç†ã€‚</p>
<h2 id="å…³é”®å­—è§¦å‘äº‹ä»¶"><a href="#å…³é”®å­—è§¦å‘äº‹ä»¶" class="headerlink" title="å…³é”®å­—è§¦å‘äº‹ä»¶"></a>å…³é”®å­—è§¦å‘äº‹ä»¶</h2><p>å…³é”®å­—è§¦å‘ä¸€èˆ¬ç”¨äºè¿è¥æ´»åŠ¨ä¸­ï¼Œå³ç”¨æˆ·å‘é€ä¸€æ¡ç‰¹å®šçš„æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€æ¡ç‰¹å®šçš„æ¶ˆæ¯ã€‚</p>
<h3 id="è¿”å›æ–‡æœ¬æ¶ˆæ¯"><a href="#è¿”å›æ–‡æœ¬æ¶ˆæ¯" class="headerlink" title="è¿”å›æ–‡æœ¬æ¶ˆæ¯"></a>è¿”å›æ–‡æœ¬æ¶ˆæ¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>( $keyword )) &#123;</div><div class="line">    <span class="keyword">if</span> ($keyword == <span class="string">"text"</span>) &#123;</div><div class="line">        $msgType = <span class="string">"text"</span>;</div><div class="line">        $contentStr = <span class="string">"æ‚¨å‘é€äº†"</span>.$keyword;</div><div class="line">        $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">        <span class="keyword">echo</span> $resultStr;</div><div class="line">    &#125;</div><div class="line">	$msgType = <span class="string">"text"</span>;</div><div class="line">	$contentStr = <span class="string">"Hello World"</span>;</div><div class="line">	$resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">	<span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"Input something..."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ—¶ç”¨æˆ·è¾“å…¥<code>text</code>ï¼Œå°±ä¼šæ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„<code>æ‚¨å‘é€äº†text</code>ã€‚ç”¨æˆ·å‘é€å…¶ä»–ä¿¡æ¯ï¼Œåˆ™è¿”å›<code>Hello World</code>ã€‚</p>
<h3 id="è¿”å›å›¾æ–‡æ¶ˆæ¯"><a href="#è¿”å›å›¾æ–‡æ¶ˆæ¯" class="headerlink" title="è¿”å›å›¾æ–‡æ¶ˆæ¯"></a>è¿”å›å›¾æ–‡æ¶ˆæ¯</h3><p>é‡æ–°å®šä¹‰ä¸€ä¸ªå›¾æ–‡æ¶ˆæ¯XMLæ•°æ®åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$newsNoImgTpl = "<span class="tag">&lt;<span class="name">xml</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">ToUserName</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">ToUserName</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">FromUserName</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">FromUserName</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">CreateTime</span>&gt;</span>%s<span class="tag">&lt;/<span class="name">CreateTime</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">MsgType</span>&gt;</span>&lt;![CDATA[%s]]&gt;<span class="tag">&lt;/<span class="name">MsgType</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">ArticleCount</span>&gt;</span>1<span class="tag">&lt;/<span class="name">ArticleCount</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Articles</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">item</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Title</span>&gt;</span>&lt;![CDATA[æ¬¢è¿å…³æ³¨superliar]]&gt;<span class="tag">&lt;/<span class="name">Title</span>&gt;</span> </div><div class="line">            <span class="tag">&lt;<span class="name">Description</span>&gt;</span>&lt;![CDATA[superliaræ˜¯ä¸€ä¸ªçœŸäººç§€èŠ‚ç›®,balabalabalabalabalabalabalabala]]&gt;<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Url</span>&gt;</span>&lt;![CDATA[http://www.panda.tv/]]&gt;<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">Articles</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">xml</span>&gt;</span>";</div></pre></td></tr></table></figure>
<p>è§¦å‘äº‹ä»¶è®¾ç½®ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>( $keyword )) &#123;</div><div class="line">    <span class="keyword">if</span> ($keyword == <span class="string">"text"</span>) &#123;</div><div class="line">        $msgType = <span class="string">"text"</span>;</div><div class="line">        $contentStr = <span class="string">"æ‚¨å‘é€äº†"</span>.$keyword;</div><div class="line">        $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">        <span class="keyword">echo</span> $resultStr;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ($keyword == <span class="string">"news"</span>) &#123;</div><div class="line">        $msgType = <span class="string">"news"</span>;</div><div class="line">        $resultStr = sprintf($newsNoImgTpl, $fromUsername, $toUsername, $time, $msgType);</div><div class="line">        <span class="keyword">echo</span> $resultStr;</div><div class="line">    &#125;</div><div class="line">	$msgType = <span class="string">"text"</span>;</div><div class="line">	$contentStr = <span class="string">"Hello World"</span>;</div><div class="line">	$resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">	<span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"Input something..."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶å½“ç”¨æˆ·å‘é€newsæ—¶ï¼Œå°±ä¼šæ”¶åˆ°ä¸€æ¡æ— å›¾çš„å›¾æ–‡æ¶ˆæ¯ã€‚</p>
<h2 id="æ¥æ”¶ä¸åŒç±»å‹æ¶ˆæ¯"><a href="#æ¥æ”¶ä¸åŒç±»å‹æ¶ˆæ¯" class="headerlink" title="æ¥æ”¶ä¸åŒç±»å‹æ¶ˆæ¯"></a>æ¥æ”¶ä¸åŒç±»å‹æ¶ˆæ¯</h2><p>å¦‚æœè¦æ¥æ”¶å¤„ç†ä¸åŒç±»å‹çš„æ¶ˆæ¯ï¼Œé¦–å…ˆè¦è·å–ç”¨æˆ·å‘é€çš„æ¶ˆæ¯ç±»å‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$msgType = $postObj-&gt;MsgType;</div></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¯é’ˆå¯¹ç”¨æˆ·å‘é€çš„ä¸åŒç±»å‹çš„æ¶ˆæ¯ï¼Œè¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($msgType == <span class="string">"image"</span>) &#123;</div><div class="line">    $msgType = <span class="string">"text"</span>;</div><div class="line">    $contentStr = <span class="string">"æ‚¨å‘é€äº†imageç±»å‹çš„æ¶ˆæ¯,æœåŠ¡å™¨è¿”å›textç±»å‹æ¶ˆæ¯"</span>;</div><div class="line">    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span> ($msgType == <span class="string">"voice"</span>) &#123;</div><div class="line">    $msgType = <span class="string">"text"</span>;</div><div class="line">    $contentStr = <span class="string">"æ‚¨å‘é€äº†voiceç±»å‹çš„æ¶ˆæ¯,æœåŠ¡å™¨è¿”å›textç±»å‹æ¶ˆæ¯"</span>;</div><div class="line">    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span> ($msgType == <span class="string">"video"</span>) &#123;</div><div class="line">    $msgType = <span class="string">"text"</span>;</div><div class="line">    $contentStr = <span class="string">"æ‚¨å‘é€äº†videoç±»å‹çš„æ¶ˆæ¯,æœåŠ¡å™¨è¿”å›textç±»å‹æ¶ˆæ¯"</span>;</div><div class="line">    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span> ($msgType == <span class="string">"music"</span>) &#123;</div><div class="line">    $msgType = <span class="string">"text"</span>;</div><div class="line">    $contentStr = <span class="string">"æ‚¨å‘é€äº†musicç±»å‹çš„æ¶ˆæ¯,æœåŠ¡å™¨è¿”å›textç±»å‹æ¶ˆæ¯"</span>;</div><div class="line">    $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr);</div><div class="line">    <span class="keyword">echo</span> $resultStr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"><a href="#Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ" class="headerlink" title="Demoä¸‹è½½è¯·ç‚¹å‡»è¿™é‡Œ"></a>Demoä¸‹è½½è¯·<a href="https://github.com/tianziyao/demo" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a></h2>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å¾®ä¿¡æ˜¯ä¸€ä¸ªç”Ÿæ´»æ–¹å¼ï¼Œå¼ å°é¾™æå‡ºçš„è¿™ä¸ªæ„¿æ™¯å·²ç»å¾—åˆ°äº†è¶Šæ¥è¶Šæ¸…æ™°çš„ä½“ç°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¾¤èŠã€è¯­éŸ³ã€è§†é¢‘ï¼Œç…§ç‰‡/è§†é¢‘/ä½ç½®å…±äº«ï¼Œæ”¯ä»˜å’Œå•†åº—éƒ½æœ‰äº†ï¼Œè¿˜èƒ½é€šè¿‡å…¬ä¼—è´¦å·æ¥è·å–å„ç§èµ„æºâ€¦â€¦&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šçš„å¾®ä¿¡å°±æ˜¯åœ¨æ—¥ä¸­å¤©çš„çŠ¶æ€ï¼Œå…¬ä¼—å¹³å°å¸¦æ¥çš„å½±å“æœ‰ç›®å…±ç¹ï¼Œæ‰€ä»¥å¾ˆå¤šå…¬å¸å’Œä¸ªäººéƒ½å¸Œæœ›æœ‰è‡ªå·±çš„å…¬ä¼—å·ï¼Œæƒ³å……åˆ†åˆ©ç”¨å´æ— å¤„ä¸‹æ‰‹ï¼Œä¸‹é¢æˆ‘ä»¬åˆ†ä¸ºå‡ ç¯‡æ–‡ç« ï¼Œç”±æµ…å…¥æ·±çš„äº†è§£å¾®ä¿¡å¼€å‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­ï¼Œéœ€è¦ä½ å…·æœ‰PHPè¯­è¨€çš„åŸºç¡€ï¼Œå¹¶æ‹¥æœ‰ä¸€å°å…·æœ‰PHPè¿è¡Œç¯å¢ƒçš„ä¸»æœºï¼Œå¦‚æœè¿˜æ²¡æœ‰å¯ä»¥é€šè¿‡æ–°æµªSAEï¼Œé˜¿é‡Œäº‘ECSç­‰è¿›è¡Œæ­å»ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿›å…¥æ­£é¢˜ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/categories/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="å¾®ä¿¡å¼€å‘" scheme="http://yoursite.com/tags/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¤šçº¿ç¨‹ - åŒæ­¥çº¿ç¨‹</title>
    <link href="http://yoursite.com/2016/08/24/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20%E5%90%8C%E6%AD%A5%E7%BA%BF%E7%A8%8B/"/>
    <id>http://yoursite.com/2016/08/24/iOSå¤šçº¿ç¨‹ä¹‹ åŒæ­¥çº¿ç¨‹/</id>
    <published>2016-08-23T21:09:00.000Z</published>
    <updated>2017-01-24T15:48:35.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ¯”å¦‚ä½ å»é“¶è¡Œå­˜10Kï¼Œåœ¨ç”¨ATMå­˜çš„åŒæ—¶ï¼Œåˆä½¿ç”¨ç½‘é“¶å–äº†10Kï¼Œå¦‚æœçº¿ç¨‹åŒæ­¥åšçš„ä¸å¥½çš„è¯ï¼Œ è™½ç„¶å–10Kå…ƒçš„æ“ä½œä¼šæœ‰è®°å½•ï¼Œä½†æ˜¯å¯èƒ½ä¸ä¼šåæ˜ åœ¨ä½™é¢ä¸Šã€‚å¦‚æœè¦è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œå°±éœ€è¦ç”¨åˆ°çº¿ç¨‹åŒæ­¥ï¼Œçº¿ç¨‹åŒæ­¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ˜¯éå¸¸å¸¸è§çš„ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥12306ä¸ºä¾‹ï¼Œå°è¯•è§£å†³å¦‚ä½•ä¿è¯ä¸€å¼ ç¥¨ä¸ä¼šè¢«ä¸åŒçª—å£ï¼Œä¸åŒå®¢æˆ·ç«¯é‡å¤è´­ä¹°ã€‚</p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬æ¥è®¤è¯†ä¸€ä¸‹äº’æ–¥é”çš„æ¦‚å¿µï¼š</p>
<blockquote>
<p><strong>äº’æ–¥é”</strong>ï¼ˆè‹±è¯­ï¼šMutual exclusionï¼Œç¼©å†™ Mutexï¼‰æ˜¯ä¸€ç§ç”¨äº<a href="https://zh.wikipedia.org/wiki/%E5%A4%9A%E7%BA%BF%E7%A8%8B" target="_blank" rel="external">å¤šçº¿ç¨‹</a><a href="https://zh.wikipedia.org/wiki/%E7%BC%96%E7%A8%8B" target="_blank" rel="external">ç¼–ç¨‹</a>ä¸­ï¼Œé˜²æ­¢ä¸¤æ¡<a href="https://zh.wikipedia.org/wiki/%E7%BA%BF%E7%A8%8B" target="_blank" rel="external">çº¿ç¨‹</a>åŒæ—¶å¯¹åŒä¸€å…¬å…±èµ„æºï¼ˆæ¯”å¦‚<a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F" target="_blank" rel="external">å…¨å±€å˜é‡</a>ï¼‰è¿›è¡Œè¯»å†™çš„æœºåˆ¶ã€‚è¯¥ç›®çš„é€šè¿‡å°†ä»£ç åˆ‡ç‰‡æˆä¸€ä¸ªä¸€ä¸ªçš„<a href="https://zh.wikipedia.org/wiki/%E4%B8%B4%E7%95%8C%E5%8C%BA%E5%9F%9F" target="_blank" rel="external">ä¸´ç•ŒåŒºåŸŸ</a>ï¼ˆcritical sectionï¼‰è¾¾æˆã€‚ä¸´ç•ŒåŒºåŸŸæŒ‡çš„æ˜¯ä¸€å—å¯¹å…¬å…±èµ„æºè¿›è¡Œè®¿é—®çš„ä»£ç ï¼Œå¹¶éä¸€ç§æœºåˆ¶æˆ–æ˜¯ç®—æ³•ã€‚ä¸€ä¸ªç¨‹åºã€è¿›ç¨‹ã€çº¿ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªä¸´ç•ŒåŒºåŸŸï¼Œä½†æ˜¯å¹¶ä¸ä¸€å®šä¼šåº”ç”¨äº’æ–¥é”ã€‚</p>
</blockquote>
<p>ä»¥ä¸Šæ˜¯ç»´åŸºç™¾ç§‘ç»™å‡ºçš„è§£é‡Šï¼Œå¦‚éœ€äº†è§£æ›´å¤šè¯· <a href="https://zh.wikipedia.org/wiki/%E4%BA%92%E6%96%A5%E9%94%81" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a>ã€‚</p>
<p>ç®€å•æ¥è®²ï¼Œäº’æ–¥é”æ˜¯ä¸ºäº†é˜²æ­¢å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ã€æ–¹æ³•ã€å˜é‡ã€æ–‡ä»¶ç­‰å¼•èµ·çš„æ•°æ®é”™è¯¯ã€‚</p>
<a id="more"></a>
<p>å½“ä¸Šä¸€ä¸ªçº¿ç¨‹çš„ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ï¼ˆè¢«é”ä½ï¼‰ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªçº¿ç¨‹ä¼šè¿›å…¥ç¡çœ çŠ¶æ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œ å½“ä¸Šä¸€ä¸ªçº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ç„¶åæ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>äº’æ–¥é”æ˜¯åŒæ­¥é”çš„ä¸€ç§ï¼Œä¸å®ƒåŒçº§çš„è¿˜æœ‰é€’å½’é”ã€æ¡ä»¶é”ã€è‡ªæ—‹é”ã€‚å…¶ä½™å‡ ç§ä½œè€…è®¤è¯†å¹¶ä¸æ˜¯å¾ˆæ·±å…¥ï¼Œå…ˆç®€å•æä¸€ä¸‹ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ä»£ç æ¥äº†è§£äº’æ–¥é”ï¼š</p>
<h4 id="objc-sync-enter-å’Œ-objc-sync-exit"><a href="#objc-sync-enter-å’Œ-objc-sync-exit" class="headerlink" title="objc_sync_enter å’Œ objc_sync_exit"></a>objc_sync_enter å’Œ objc_sync_exit</h4><p>è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">objc_sync_enter(<span class="keyword">self</span>)</div><div class="line"><span class="comment">//éœ€è¦æ‰§è¡Œçš„ä»£ç å—</span></div><div class="line">objc_sync_exit(<span class="keyword">self</span>)</div></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„ <code>self</code> ä»£è¡¨ä¸€æŠŠé”ï¼Œå®ƒçš„ä¼ å…¥å€¼æ˜¯ä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœå¤šçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªèµ„æºï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨åŒä¸€æŠŠé”æ‰èƒ½é”ä½ã€‚å› ä¸ºå¿…é¡»ä½¿ç”¨åŒä¸€æŠŠé”ï¼Œå¼€å‘ä¸­å¦‚æœéœ€è¦åŠ é”ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>self</code> å³å¯ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥è¿ç”¨ <code>objc_sync_enter</code> å’Œ <code>objc_sync_exit</code>ã€‚</p>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œä»£è¡¨å½“å‰è½¦ç¥¨çš„æ•°é‡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> iTicketCount: <span class="type">Int</span> = <span class="number">10</span></div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>NSBlockOperation</code> å®ä¾‹å¹¶æ·»åŠ ä»»åŠ¡ï¼Œå½“ç¥¨æ•°å¤§äº 0 æ—¶ï¼Œç¥¨æ•°å°±å¯ä»¥è‡ªå‡ 1ï¼Œç›´åˆ°ç¥¨æ•°ç­‰äº 0ï¼Œ</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">let saleTicketOne = NSBlockOperation()</div><div class="line">saleTicketOne.addExecutionBlock &#123;</div><div class="line"></div><div class="line">    while self.iTicketCount &gt; 0 &#123;</div><div class="line">        objc_sync_enter(self)</div><div class="line">            self.iTicketCount -= 1</div><div class="line">            print("å½“å‰çº¿ç¨‹æ˜¯ \(NSThread.currentThread()) å‰©ä½™ç¥¨æ•°\</div><div class="line">            objc_sync_exit(self)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>NSBlockOperation</code> æœ¬èº«æ˜¯ä¸å…·å¤‡å¼€çº¿ç¨‹çš„èƒ½åŠ›çš„ï¼Œ<code>NSBlockOperationQueue</code>æ‰å¯ä»¥å¼€çº¿ç¨‹ï¼Œè€Œ <code>NSBlockOperationQueue</code> æ˜¯å¦å¯ä»¥å¼€çº¿ç¨‹ï¼Œåˆå–å†³äºä»»åŠ¡çš„æ•°é‡ï¼Œç°åœ¨æˆ‘ä»¬çš„ä»»åŠ¡æ•°åªæœ‰ä¸€ä¸ªï¼Œå¦‚æœè¦ä½¿ç”¨çº¿ç¨‹åŒæ­¥ï¼Œå¿…é¡»æ˜¯ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ª <code>NSBlockOperation</code>ã€‚å°†ä¸¤ä¸ªä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> saleTicketTwo = <span class="type">NSBlockOperation</span>()</div><div class="line">saleTicketTwo.addExecutionBlock &#123;</div><div class="line">    <span class="keyword">while</span> <span class="keyword">self</span>.iTicketCount &gt; <span class="number">0</span> &#123;</div><div class="line">        objc_sync_enter(<span class="keyword">self</span>)</div><div class="line">        <span class="keyword">self</span>.iTicketCount -= <span class="number">1</span></div><div class="line">            <span class="built_in">print</span>(<span class="string">"å½“å‰çº¿ç¨‹æ˜¯ <span class="subst">\(NSThread.currentThread()</span>) å‰©ä½™ç¥¨æ•°<span class="subst">\(<span class="keyword">self</span>.iTicketCount)</span>"</span> )</div><div class="line">        objc_sync_exit(<span class="keyword">self</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> queue = <span class="type">NSOperationQueue</span>()</div><div class="line">queue.addOperation(saleTicketOne)</div><div class="line">queue.addOperation(saleTicketTwo)</div></pre></td></tr></table></figure>
<p>æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">9</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6653c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">8</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">7</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6653c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">6</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">5</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6653c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">4</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">3</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6653c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">2</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">1</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6653c0</span>&gt;&#123;number = <span class="number">4</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">0</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b6635d0</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°-<span class="number">1</span></div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºæˆ‘ä»¬å¼€å¯äº†ä¸¤æ¡çº¿ç¨‹ï¼Œä½¿ç”¨äº’æ–¥é”æ‰§è¡ŒåŒä¸€ä¸ªä»»åŠ¡ï¼Œç»“æœæ˜¯ä¸¤æ¡çº¿ç¨‹äº¤å‰æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œç»“æœåŸºæœ¬ç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯åœ¨ç¥¨æ•°ä¸Šå´æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆé€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å› ä¸ºè¿™ä¸¤ä¸ªçº¿ç¨‹æ˜¯å¹¶å‘æ‰§è¡Œï¼Œåœ¨ç¥¨æ•°ç­‰äº 1 æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹é€šè¿‡ <code>while self.iTicketCount &gt; 0</code> çš„åˆ¤æ–­ï¼Œç„¶åä¸€ä¸ªçº¿ç¨‹ä¹Ÿè¿›å…¥äº†è¿™ä¸ªåˆ¤æ–­ï¼Œå‰é¢çš„è¿›ç¨‹é‡åˆ° <code>objc_sync_enter(self)</code>  ï¼Œè¿›å…¥åŠ é”æ‰§è¡Œï¼Œè¾“å‡ºäº† 0ï¼Œç„¶åè§£é”ã€‚å¦ä¸€ä¸ªè¿›ç¨‹ä¹Ÿè¿›å…¥åŠ é”æ‰§è¡Œï¼Œæ­¤æ—¶äº†ç¥¨æ•°ä¸º 0ï¼Œæ‰€ä»¥è¾“å‡ºäº† -1ã€‚</p>
<p>å¦‚æœè¯´å› ä¸ºæ¡ä»¶åˆ¤æ–­é€šè¿‡ï¼Œæ‰€ä»¥é€ æˆäº†ç»“æœçš„é”™è¯¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¡ä»¶åˆ¤æ–­ <code>while self.iTicketCount &gt; 0</code> ä¹ŸåŠ å…¥é”çš„èŒƒå›´å†…ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å°†ä»£ç æ”¹æˆè¿™æ ·ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">let saleTicketOne = NSBlockOperation()</div><div class="line">saleTicketOne.addExecutionBlock &#123;</div><div class="line">    objc_sync_enter(self)</div><div class="line">    while self.iTicketCount &gt; 0 &#123;</div><div class="line">            self.iTicketCount -= 1</div><div class="line">            print("å½“å‰çº¿ç¨‹æ˜¯ \(NSThread.currentThread()) å‰©ä½™ç¥¨æ•°\</div><div class="line">    &#125;</div><div class="line">    objc_sync_exit(self)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">9</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">8</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">7</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">6</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">5</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">4</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">3</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">2</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">1</span></div><div class="line">å½“å‰çº¿ç¨‹æ˜¯ &lt;<span class="type">NSThread</span>: <span class="number">0x7b74f560</span>&gt;&#123;number = <span class="number">3</span>, name = (null)&#125; å‰©ä½™ç¥¨æ•°<span class="number">0</span></div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ä¸€æ¡çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥è¯´æ˜ï¼Œåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ•´ä¸ªä»»åŠ¡åï¼Œå¦ä¸€ä¸ªè¿›ç¨‹æ‰ä¼šæ‰§è¡Œï¼Œä½†æ­¤æ—¶å®ƒå·²ç»æ²¡æœ‰ä»»åŠ¡å¯åšäº†ã€‚è¿™æ ·ä¹Ÿä¸å¯¹ï¼Œé‚£ä¹ˆæ­£ç¡®åšæ³•æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> saleTicketTwo = <span class="type">NSBlockOperation</span>()</div><div class="line">saleTicketTwo.addExecutionBlock &#123;</div><div class="line">    <span class="keyword">while</span> <span class="keyword">self</span>.iTicketCount &gt; <span class="number">0</span> &#123;</div><div class="line">        objc_sync_enter(<span class="keyword">self</span>)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.iTicketCount &gt; <span class="number">0</span> &#123;</div><div class="line">            <span class="keyword">self</span>.iTicketCount -= <span class="number">1</span></div><div class="line">            <span class="built_in">print</span>(<span class="string">"å½“å‰çº¿ç¨‹æ˜¯ <span class="subst">\(NSThread.currentThread()</span>) å‰©ä½™ç¥¨æ•°<span class="subst">\(<span class="keyword">self</span>.iTicketCount)</span>"</span> )</div><div class="line">            objc_sync_exit(<span class="keyword">self</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åœ¨ <code>objc_sync_enter(self)</code> å†åŠ å…¥ä¸€æ¡åˆ¤æ–­ï¼Œ<code>if self.iTicketCount &gt; 0</code> é‚£ä¹ˆè¾“å‡ºçš„ç»“æœå°±æ²¡æœ‰é—®é¢˜äº†ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒåŠ é”çš„ä½ç½®å’Œæ¡ä»¶çš„åˆ¤æ–­åœ¨åŒæ­¥è¿›ç¨‹ä¸­æ˜¯éå¸¸é‡è¦çš„ï¼Œå¦‚æœåŒæ­¥çº¿ç¨‹çš„åŠ é”ä½ç½®å’Œåˆ¤æ–­æ¡ä»¶æ²¡æœ‰åšå¥½ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™æ®µä»£ç è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸­å·²ç»æ‰§è¡Œäº†ï¼Œå› æ­¤é€ æˆæ•°æ®å­˜å–çš„ä¸ä¸€è‡´ï¼Œä¸‹é¢æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ä½¿ç”¨ <code>NSBlock</code> æ¥åšåŒæ­¥çº¿ç¨‹ï¼š</p>
<h4 id="NSLock"><a href="#NSLock" class="headerlink" title="NSLock"></a>NSLock</h4><p>é¦–å…ˆæ¥çœ‹ä¸‹ <code>NSLock</code> çš„è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NSLock</span> : <span class="title">NSObject</span>, <span class="title">NSLocking</span> </span>&#123;</div><div class="line"></div><div class="line">   	<span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">tryLock</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">   	<span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">lockBeforeDate</span><span class="params">(limit: NSDate)</span></span> -&gt; <span class="type">Bool</span></div><div class="line"></div><div class="line">   	<span class="meta">@available</span>(iOS <span class="number">2.0</span>, *)</div><div class="line">   	<span class="keyword">public</span> <span class="keyword">var</span> name: <span class="type">String</span>?</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºï¼Œ<code>NSLock</code> æ˜¯ä¸€ä¸ªç±»ï¼ŒåŒ…å«ä¸¤ä¸ªå®ä¾‹æ–¹æ³• <code>tryLock</code> å’Œ <code>lockBeforeDate</code> ä»¥åŠä¸€ä¸ªå­˜å‚¨å±æ€§ <code>name</code>ï¼Œå¹¶ä¸”ç»§æ‰¿äº† <code>NSLocking</code> ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ <code>NSLocking</code> è¿™ä¸ªçˆ¶ç±»ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">NSLocking</span> </span>&#123;</div><div class="line"></div><div class="line">   	<span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">lock</span><span class="params">()</span></span></div><div class="line">   	<span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">unlock</span><span class="params">()</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>NSLocking</code> ä¸­æœ‰ä¸¤ä¸ªå®ä¾‹æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯åŠ é”å’Œè§£é”ï¼Œå…³äº <code>NSLock</code> è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥åœ¨å¸®åŠ©æ–‡æ¡£ä¸­æ‰¾åˆ°ï¼Œåœ¨æ­¤å°±ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ <code>NSThread</code> å’Œ <code>NSBlock</code> æ¥å®ç°å’Œä¸Šé¢åŒæ ·çš„åŠŸèƒ½ï¼Œé¦–å…ˆåˆ›å»ºä¸¤ä¸ªæˆå‘˜å±æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> iTicketCount: <span class="type">Int</span> = <span class="number">10</span>  <span class="comment">//è¡¨ç¤ºå½“å‰å‰©ä½™çš„ç¥¨æ•°</span></div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myLock: <span class="type">NSLock</span>!         <span class="comment">//è¡¨ç¤ºä¸€ä¸ªé”</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å°† <code>myLock</code> è¿›è¡Œå®ä¾‹åŒ–ï¼Œåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹å¹¶æ·»åŠ ä»»åŠ¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">self.myLock = NSLock()</div><div class="line">let threadOne = NSThread(target: self, selector: #selector(ViewController.saleTicket), object: nil)</div><div class="line">let threadTwo = NSThread(target: self, selector: #selector(ViewController.saleTicket), object: nil)</div><div class="line">threadOne.start()</div><div class="line">threadTwo.start()</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¦æ‰§è¡Œçš„ä»»åŠ¡æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">func saleTicket() &#123;</div><div class="line"></div><div class="line">    while self.iTicketCount &gt; 0 &#123;</div><div class="line"></div><div class="line">        self.myLock.lock()</div><div class="line"></div><div class="line">        if self.iTicketCount &gt; 0 &#123;</div><div class="line">            self.iTicketCount -= 1</div><div class="line">            print(&quot;å½“å‰çº¿ç¨‹æ˜¯ \(NSThread.currentThread()) å‰©ä½™ç¥¨æ•°\(self.iTicketCount)&quot; )</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        self.myLock.unlock()</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åšå¥½æ¡ä»¶æ§åˆ¶ï¼Œåœ¨éœ€è¦åŒæ­¥çº¿ç¨‹çš„ä»£ç ä¸Šä¸‹åˆ†åˆ«å¯ç”¨ <code>myLock.lock()</code> å’Œ <code>myLock.unlock()</code> å°±å¯ä»¥äº†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ¯”å¦‚ä½ å»é“¶è¡Œå­˜10Kï¼Œåœ¨ç”¨ATMå­˜çš„åŒæ—¶ï¼Œåˆä½¿ç”¨ç½‘é“¶å–äº†10Kï¼Œå¦‚æœçº¿ç¨‹åŒæ­¥åšçš„ä¸å¥½çš„è¯ï¼Œ è™½ç„¶å–10Kå…ƒçš„æ“ä½œä¼šæœ‰è®°å½•ï¼Œä½†æ˜¯å¯èƒ½ä¸ä¼šåæ˜ åœ¨ä½™é¢ä¸Šã€‚å¦‚æœè¦è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œå°±éœ€è¦ç”¨åˆ°çº¿ç¨‹åŒæ­¥ï¼Œçº¿ç¨‹åŒæ­¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ˜¯éå¸¸å¸¸è§çš„ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥12306ä¸ºä¾‹ï¼Œå°è¯•è§£å†³å¦‚ä½•ä¿è¯ä¸€å¼ ç¥¨ä¸ä¼šè¢«ä¸åŒçª—å£ï¼Œä¸åŒå®¢æˆ·ç«¯é‡å¤è´­ä¹°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ¥è®¤è¯†ä¸€ä¸‹äº’æ–¥é”çš„æ¦‚å¿µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;äº’æ–¥é”&lt;/strong&gt;ï¼ˆè‹±è¯­ï¼šMutual exclusionï¼Œç¼©å†™ Mutexï¼‰æ˜¯ä¸€ç§ç”¨äº&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%A4%9A%E7%BA%BF%E7%A8%8B&quot;&gt;å¤šçº¿ç¨‹&lt;/a&gt;&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E7%BC%96%E7%A8%8B&quot;&gt;ç¼–ç¨‹&lt;/a&gt;ä¸­ï¼Œé˜²æ­¢ä¸¤æ¡&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E7%BA%BF%E7%A8%8B&quot;&gt;çº¿ç¨‹&lt;/a&gt;åŒæ—¶å¯¹åŒä¸€å…¬å…±èµ„æºï¼ˆæ¯”å¦‚&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F&quot;&gt;å…¨å±€å˜é‡&lt;/a&gt;ï¼‰è¿›è¡Œè¯»å†™çš„æœºåˆ¶ã€‚è¯¥ç›®çš„é€šè¿‡å°†ä»£ç åˆ‡ç‰‡æˆä¸€ä¸ªä¸€ä¸ªçš„&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%B8%B4%E7%95%8C%E5%8C%BA%E5%9F%9F&quot;&gt;ä¸´ç•ŒåŒºåŸŸ&lt;/a&gt;ï¼ˆcritical sectionï¼‰è¾¾æˆã€‚ä¸´ç•ŒåŒºåŸŸæŒ‡çš„æ˜¯ä¸€å—å¯¹å…¬å…±èµ„æºè¿›è¡Œè®¿é—®çš„ä»£ç ï¼Œå¹¶éä¸€ç§æœºåˆ¶æˆ–æ˜¯ç®—æ³•ã€‚ä¸€ä¸ªç¨‹åºã€è¿›ç¨‹ã€çº¿ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªä¸´ç•ŒåŒºåŸŸï¼Œä½†æ˜¯å¹¶ä¸ä¸€å®šä¼šåº”ç”¨äº’æ–¥é”ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯ç»´åŸºç™¾ç§‘ç»™å‡ºçš„è§£é‡Šï¼Œå¦‚éœ€äº†è§£æ›´å¤šè¯· &lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%BA%92%E6%96%A5%E9%94%81&quot;&gt;ç‚¹å‡»è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ¥è®²ï¼Œäº’æ–¥é”æ˜¯ä¸ºäº†é˜²æ­¢å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ã€æ–¹æ³•ã€å˜é‡ã€æ–‡ä»¶ç­‰å¼•èµ·çš„æ•°æ®é”™è¯¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="äº’æ–¥é”" scheme="http://yoursite.com/tags/%E4%BA%92%E6%96%A5%E9%94%81/"/>
    
      <category term="å¼‚æ­¥çº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="çº¿ç¨‹é”" scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B%E9%94%81/"/>
    
      <category term="åŒæ­¥çº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%90%8C%E6%AD%A5%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Xcodeé”™è¯¯ - Failed to import &amp;&amp; .h file not found</title>
    <link href="http://yoursite.com/2016/08/05/Xcode%E9%94%99%E8%AF%AF%20-%20Failed%20to%20import%20&amp;&amp;%20.h%20file%20not%20found/"/>
    <id>http://yoursite.com/2016/08/05/Xcodeé”™è¯¯ - Failed to import &amp;&amp; .h file not found/</id>
    <published>2016-08-04T21:46:00.000Z</published>
    <updated>2016-09-26T10:32:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦ç¡®ä¿ç›¸å…³çš„åº“å’Œä¾èµ–å·²ç»å¯¼å…¥åˆ°å·¥ç¨‹ï¼Œå¦‚æœè¿˜æ˜¯æœ‰æç¤ºï¼Œè¿™è¯´æ˜å‡ºé”™çš„æ–‡ä»¶ Xcode æ— æ³•è·å–åˆ°ã€‚</p>
<p>é¦–å…ˆè¿›å…¥å·¥ç¨‹çš„ Build Phases ï¼Œæ‰¾åˆ° Link Binary With Libraries ï¼Œç‚¹å‡» + å·å°†æç¤ºç¼ºå¤±çš„æ–‡ä»¶å¯¼å…¥ã€‚</p>
<p><img src="http://ob2q6r0fn.bkt.clouddn.com/buildphases.png" alt=""></p>
<p>å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨çš„è¯ï¼Œè¿›å…¥å·¥ç¨‹çš„ Build Settings ï¼Œåœ¨ TARGETS è€Œä¸æ˜¯ PROJECT ä¸‹ï¼Œæœç´¢ Search Pathsï¼Œç¡®ä¿ Frameworks Search Paths å’Œ Header Search Paths æŒ‡å‘æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ã€‚</p>
<a id="more"></a>
<p><img src="http://ob2q6r0fn.bkt.clouddn.com/buildsettings.png" alt=""></p>
<p>å¦‚æœæ­¤æ—¶è¿˜æç¤º Failed to import çš„è¯ï¼Œå°è¯•å°† <code>#import &quot;xxx.h&quot;</code> ä¿®æ”¹ä¸º <code>#import &lt;xxx/xxx.h&gt;</code>ã€‚</p>
<p>å¦‚æœæ­¤æ—¶è¿˜æç¤º file not found çš„è¯ï¼Œå°è¯• <code>âŒ˜ + alt + â‡§ + k</code> æ¸…ç†ç›®å½•ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h2><p><a href="http://stackoverflow.com/questions/19447860/xcode-file-not-found" target="_blank" rel="external">http://stackoverflow.com/questions/19447860/xcode-file-not-found</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦ç¡®ä¿ç›¸å…³çš„åº“å’Œä¾èµ–å·²ç»å¯¼å…¥åˆ°å·¥ç¨‹ï¼Œå¦‚æœè¿˜æ˜¯æœ‰æç¤ºï¼Œè¿™è¯´æ˜å‡ºé”™çš„æ–‡ä»¶ Xcode æ— æ³•è·å–åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¿›å…¥å·¥ç¨‹çš„ Build Phases ï¼Œæ‰¾åˆ° Link Binary With Libraries ï¼Œç‚¹å‡» + å·å°†æç¤ºç¼ºå¤±çš„æ–‡ä»¶å¯¼å…¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ob2q6r0fn.bkt.clouddn.com/buildphases.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨çš„è¯ï¼Œè¿›å…¥å·¥ç¨‹çš„ Build Settings ï¼Œåœ¨ TARGETS è€Œä¸æ˜¯ PROJECT ä¸‹ï¼Œæœç´¢ Search Pathsï¼Œç¡®ä¿ Frameworks Search Paths å’Œ Header Search Paths æŒ‡å‘æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/categories/Xcode%E9%94%99%E8%AF%AF/"/>
    
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/tags/Xcode%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>iOSæ•°æ®å¤„ç† - è½¬è½½Â·å­—ç¬¦ä¸²MD5åŠ å¯†</title>
    <link href="http://yoursite.com/2016/08/03/%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%91Swift%20-%20%E8%8E%B7%E5%8F%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84MD5%E5%80%BC/"/>
    <id>http://yoursite.com/2016/08/03/ã€è½¬è½½ã€‘Swift - è·å–å­—ç¬¦ä¸²çš„MD5å€¼/</id>
    <published>2016-08-02T18:46:00.000Z</published>
    <updated>2016-08-24T04:46:11.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>MD5 å³ Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ã€å“ˆå¸Œç®—æ³•ï¼‰ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰MD5å®ç°ã€‚ å…¶ä½œç”¨æ˜¯è®©å¤§å®¹é‡ä¿¡æ¯åœ¨ç”¨æ•°å­—ç­¾åè½¯ä»¶ç­¾ç½²ç§äººå¯†é’¥å‰è¢«â€å‹ç¼©â€æˆä¸€ç§ä¿å¯†çš„æ ¼å¼ï¼ˆå°±æ˜¯æŠŠä¸€ä¸ªä»»æ„é•¿åº¦çš„å­—èŠ‚ä¸²å˜æ¢æˆä¸€å®šé•¿çš„åå…­è¿›åˆ¶æ•°å­—ä¸²ï¼‰ã€‚</p>
</blockquote>
<p>é¦–å…ˆï¼Œåˆ›å»ºæ¡¥æ¥å¤´æ–‡ä»¶ <code>bridge.h</code> æ¥åŒ…å«éœ€è¦å¼•ç”¨çš„ <code>Objective-C</code> å¤´æ–‡ä»¶ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#import &lt;CommonCrypto/CommonDigest.h&gt;</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>å…¶æ¬¡ï¼Œå¯¹ <code>String</code> å¢åŠ  <code>MD5</code> æ‰©å±•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</div><div class="line">   <span class="keyword">var</span> md5 : <span class="type">String</span>&#123;</div><div class="line">       <span class="keyword">let</span> str = <span class="keyword">self</span>.cStringUsingEncoding(<span class="type">NSUTF8StringEncoding</span>)</div><div class="line">       <span class="keyword">let</span> strLen = <span class="type">CC_LONG</span>(<span class="keyword">self</span>.lengthOfBytesUsingEncoding(<span class="type">NSUTF8StringEncoding</span>))</div><div class="line">       <span class="keyword">let</span> digestLen = <span class="type">Int</span>(<span class="type">CC_MD5_DIGEST_LENGTH</span>)</div><div class="line">       <span class="keyword">let</span> result = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">CUnsignedChar</span>&gt;.alloc(digestLen);</div><div class="line"></div><div class="line">       <span class="type">CC_MD5</span>(str!, strLen, result);</div><div class="line"></div><div class="line">       <span class="keyword">let</span> hash = <span class="type">NSMutableString</span>();</div><div class="line">       <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; digestLen &#123;</div><div class="line">           hash.appendFormat(<span class="string">"%02x"</span>, result[i]);</div><div class="line">       &#125;</div><div class="line">       result.destroy();</div><div class="line"></div><div class="line">       <span class="keyword">return</span> <span class="type">String</span>(format: hash <span class="keyword">as</span> <span class="type">String</span>)</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨æ ·ä¾‹ï¼š"><a href="#ä½¿ç”¨æ ·ä¾‹ï¼š" class="headerlink" title="ä½¿ç”¨æ ·ä¾‹ï¼š"></a>ä½¿ç”¨æ ·ä¾‹ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(&quot;welcome to hangge.com&quot;.md5)		//è¾“å‡ºï¼š6ad70eb3a4a50011af9c62cc0674803a</div></pre></td></tr></table></figure>
<p>è½¬è½½è‡ªï¼š<a href="http://www.hangge.com/blog/cache/detail_650.html" target="_blank" rel="external">http://www.hangge.com/blog/cache/detail_650.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;MD5 å³ Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ã€å“ˆå¸Œç®—æ³•ï¼‰ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰MD5å®ç°ã€‚ å…¶ä½œç”¨æ˜¯è®©å¤§å®¹é‡ä¿¡æ¯åœ¨ç”¨æ•°å­—ç­¾åè½¯ä»¶ç­¾ç½²ç§äººå¯†é’¥å‰è¢«â€å‹ç¼©â€æˆä¸€ç§ä¿å¯†çš„æ ¼å¼ï¼ˆå°±æ˜¯æŠŠä¸€ä¸ªä»»æ„é•¿åº¦çš„å­—èŠ‚ä¸²å˜æ¢æˆä¸€å®šé•¿çš„åå…­è¿›åˆ¶æ•°å­—ä¸²ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¦–å…ˆï¼Œåˆ›å»ºæ¡¥æ¥å¤´æ–‡ä»¶ &lt;code&gt;bridge.h&lt;/code&gt; æ¥åŒ…å«éœ€è¦å¼•ç”¨çš„ &lt;code&gt;Objective-C&lt;/code&gt; å¤´æ–‡ä»¶ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­é…ç½®ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;#import &amp;lt;CommonCrypto/CommonDigest.h&amp;gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="MD5" scheme="http://yoursite.com/tags/MD5/"/>
    
  </entry>
  
  <entry>
    <title>iOSè‡ªå®šä¹‰æ§ä»¶ - æ—¶é—´è½´</title>
    <link href="http://yoursite.com/2016/07/22/%E5%AE%9E%E7%8E%B0%E6%97%B6%E9%97%B4%E8%BD%B4%E6%95%88%E6%9E%9C/"/>
    <id>http://yoursite.com/2016/07/22/å®ç°æ—¶é—´è½´æ•ˆæœ/</id>
    <published>2016-07-21T17:21:00.000Z</published>
    <updated>2016-08-21T18:14:12.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ—¶é—´è½´æ˜¯å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰çš„ç‰¹æ•ˆï¼Œåœ¨ç½‘ç»œä¸Šä¹Ÿæœ‰å¾ˆå¤šç°æˆçš„èµ„æºï¼Œè™½ç„¶è½®å­å·²ç»æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªå·±å°è¯•æ¥åšä¸€ä¸ªä¹Ÿä¸å¤±ä¸ºæ˜¯ä¸€ç§ä¹è¶£ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ StoryBoard å’Œä»£ç æ¥å®Œæˆä¸€ä¸ªæ—¶é—´è½´çš„ç•Œé¢ã€‚</p>
</blockquote>
<h4 id="é…ç½®-StoryBoardï¼š"><a href="#é…ç½®-StoryBoardï¼š" class="headerlink" title="é…ç½® StoryBoardï¼š"></a>é…ç½® StoryBoardï¼š</h4><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºæ–°çš„ <code>Project</code> ï¼Œåˆ æ‰é»˜è®¤çš„ <code>ViewController.swift</code>ï¼Œå’Œ <code>MainStoryBoard</code> ä¸­çš„ <code>ViewControlle r Scene</code> ï¼Œç°åœ¨æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªç©ºçš„é¡¹ç›®ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬åœ¨ <code>Main.StoryBoard</code> ä¸­æ‹–è¿›æ¥ä¸€ä¸ª <code>TableViewController</code> ç»™å®ƒå‘½åä¸º <code>NoteTableViewController</code> ï¼Œç„¶ååˆ›å»º <code>New File - File</code> ï¼Œé€‰æ‹© <code>Cocoa Touch Class</code> ï¼Œç»§æ‰¿è‡ª <code>UITableViewController</code> ï¼Œå‘½åä¸º <code>NoteTableViewController</code> ã€‚</p>
<p>ç„¶åå°† <code>NoteTableViewController</code> å’Œ <code>NoteTableViewController.Class</code> è¿›è¡Œç»‘å®šï¼Œå¹¶ç»™<code>Main.StoryBoard</code> è®¾ç½®ä¸€ä¸ª <code>Identity</code> ï¼Œå¹¶å‹¾é€‰ <code>Is Initial View Controller</code> ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼Œé€‰ä¸­ <code>NoteTableViewController</code> ä¸‹çš„ <code>TableView</code> ï¼Œå°†å®ƒçš„ <code>Row Height</code> è®¾ç½®ä¸º60ï¼Œ<code>Prototype Cells</code> è®¾ç½®ä¸º2ã€‚</p>
<p>ä¸‹é¢ï¼Œè®¾ç½®ä¸¤ä¸ª <code>Cell</code> ï¼Œåˆ†åˆ«å‘½åä¸º <code>RightCell å’Œ LeftCell</code> ï¼Œç»™æ¯ä¸ª <code>Cell</code> æ·»åŠ  <code>3ä¸ªButtonh å’Œ 1ä¸ªUIView</code>ã€‚3ä¸ªæŒ‰é’®å‘½åä¾æ¬¡ä¸ºï¼š<code>middle delete edit</code> ï¼Œå®½åº¦30ï¼Œé«˜åº¦30ï¼Œå¹¶ç»™æŒ‰é’®è®¾ç½®å¯¹åº”çš„èƒŒæ™¯å›¾ç‰‡ï¼Œå¹¶è®©3ä¸ªæŒ‰é’®å¯¹é½ï¼Œ<code>UIView</code> çš„å®½åº¦æ˜¯2ï¼Œé«˜åº¦30ï¼ŒèƒŒæ™¯é¢œè‰²ä¸ºé»‘è‰²ã€‚</p>
<p>ç»™ <code>LeftCell</code> æ·»åŠ ä¸€ä¸ª<code>Label</code>ï¼Œæ–‡æœ¬è®¾ç½®ä¸ºå³å¯¹é½ï¼Œç»™ <code>RightCell</code> æ·»åŠ ä¸€ä¸ª <code>Label</code>ï¼Œæ–‡æœ¬è®¾ç½®ä¸ºå·¦å¯¹é½ã€‚</p>
<p>æœ€åï¼Œå‹¾é€‰ <code>delete edit</code> ä¸¤ä¸ªæŒ‰é’®çš„ <code>Hidden</code> é€‰é¡¹ï¼Œç„¶ååˆ›å»º <code>New File - File</code> ï¼Œé€‰æ‹© <code>Cocoa Touch Class</code> ï¼Œç»§æ‰¿è‡ª <code>UITableViewCell</code> ï¼Œå‘½åä¸º <code>NoteTableViewCell</code> ã€‚</p>
<a id="more"></a>
<h4 id="è‡ªå®šä¹‰-TableViewCell"><a href="#è‡ªå®šä¹‰-TableViewCell" class="headerlink" title="è‡ªå®šä¹‰ TableViewCell"></a>è‡ªå®šä¹‰ TableViewCell</h4><p>åœ¨ <code>NoteTableViewCell</code> ä¸­åˆ›å»ºä¸¤ä¸ªå­ç±»ï¼Œç»§æ‰¿è‡ª  <code>NoteTableViewCell</code> ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class LeftNoteTableViewCell: NoteTableViewCell &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">class RightNoteTableViewCell: NoteTableViewCell &#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°† <code>RightCell å’Œ LeftCell</code> å’Œè¿™ä¸¤ä¸ªå­ç±»ç»‘å®šï¼Œå¹¶ç»™è¿™ä¸¤ä¸ªå­ç±»æ‹–è¿›æ¥ä¸¤ä¸ªæ§ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class LeftNoteTableViewCell: NoteTableViewCell &#123;</div><div class="line">    @IBOutlet weak var descriptionLabel: UILabel!</div><div class="line">&#125;</div><div class="line"></div><div class="line">class RightNoteTableViewCell: NoteTableViewCell &#123;</div><div class="line">    @IBOutlet weak var descriptionLabel: UILabel!</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°†ä¸‰ä¸ªé€šç”¨çš„æ§ä»¶æ‹–è¿› <code>NoteTableViewCell</code> è¿™ä¸ªåŸºç±»ä¸­ï¼Œå¹¶è®¾ç½®ä¸€ä¸ª <code>Bool</code> å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class NoteTableViewCell: UITableViewCell &#123;</div><div class="line"></div><div class="line">    @IBOutlet weak var deleteButton: UIButton!</div><div class="line">    @IBOutlet weak var editButton: UIButton!</div><div class="line">    @IBOutlet weak var middleButton: UIButton!</div><div class="line">    var isExpand = false</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºæ¨¡å‹"><a href="#åˆ›å»ºæ¨¡å‹" class="headerlink" title="åˆ›å»ºæ¨¡å‹"></a>åˆ›å»ºæ¨¡å‹</h4><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å‘½åä¸º <code>NoteItem</code> ï¼Œåˆ›å»ºç»“æ„ä½“å¹¶åµŒå…¥æšä¸¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">struct NoteItem &#123;</div><div class="line">    var cost: Float         </div><div class="line">    var content: String     </div><div class="line">    var type: NoteItemType  </div><div class="line">&#125;</div><div class="line"></div><div class="line">enum NoteItemType: Int &#123;</div><div class="line">    case income</div><div class="line">    case outcome</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨æ¨¡å‹ï¼š"><a href="#ä½¿ç”¨æ¨¡å‹ï¼š" class="headerlink" title="ä½¿ç”¨æ¨¡å‹ï¼š"></a>ä½¿ç”¨æ¨¡å‹ï¼š</h4><p>å›åˆ° <code>NoteTableViewCell</code> ä¸­ï¼Œåˆ›å»ºé…ç½®æ–¹æ³• <code>configureCell</code> å°†æ¨¡å‹ä¸­çš„æ•°æ®ä¼ ç»™ <code>Cell</code> ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">func configureCell(withItem item: NoteItem) &#123;</div><div class="line"></div><div class="line">        switch item.content &#123;</div><div class="line">        case &quot;è´­ç‰©&quot;:</div><div class="line">            middleButton.setImage(UIImage(named: &quot;shopping.png&quot;), forState: .Normal)</div><div class="line">        case &quot;æœè£…&quot;:</div><div class="line">            middleButton.setImage(UIImage(named: &quot;clothes.png&quot;), forState: .Normal)</div><div class="line">        case &quot;é£Ÿå“&quot;:</div><div class="line">            middleButton.setImage(UIImage(named: &quot;restaurant.png&quot;), forState: .Normal)</div><div class="line">        case &quot;å·¥èµ„&quot;,&quot;å¥–é‡‘&quot;:</div><div class="line">            middleButton.setImage(UIImage(named: &quot;income.png&quot;), forState: .Normal)</div><div class="line"></div><div class="line">        default:</div><div class="line">            middleButton.setImage(UIImage(named: &quot;middle_button.png&quot;), forState: .Normal)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        let lableConeten = &quot;\(item.content) \(item.cost)&quot;</div><div class="line"></div><div class="line">        setValue(lableConeten, forKeyPath: &quot;descriptionLabel.text&quot;)</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å›åˆ° <code>NoteTableViewController</code> ä¸­ï¼Œå®Œå–„æ¨¡å‹çš„æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var datas: [NoteItem] = [NoteItem(cost: 1000, content: &quot;è´­ç‰©&quot;, type: .outcome),</div><div class="line">                         NoteItem(cost: 3000, content: &quot;å® ç‰©&quot;, type: .outcome),</div><div class="line">                         NoteItem(cost: 5000, content: &quot;å·¥èµ„&quot;, type: .income),</div><div class="line">                         NoteItem(cost: 2000, content: &quot;è´­ç‰©&quot;, type: .outcome),</div><div class="line">                         NoteItem(cost: 10000, content: &quot;å¥–é‡‘&quot;, type: .income),</div><div class="line">                         NoteItem(cost: 4000, content: &quot;æœè£…&quot;, type: .outcome),</div><div class="line">                         NoteItem(cost: 8000, content: &quot;é£Ÿå“&quot;, type: .outcome),</div><div class="line">                         NoteItem(cost: 6000, content: &quot;è´­ç‰©&quot;, type: .outcome),]</div></pre></td></tr></table></figure>
<p>é…ç½® <code>tableView</code> çš„è¡Œæ•°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> datas.<span class="built_in">count</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰ <code>Cell</code> ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">override func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -&gt; UITableViewCell &#123;</div><div class="line"></div><div class="line">    let item = datas[indexPath.row]</div><div class="line">    var identifier = &quot;&quot;</div><div class="line"></div><div class="line">    switch item.type &#123;              </div><div class="line">    case .income:</div><div class="line">        identifier = &quot;LeftCell&quot;</div><div class="line">    case .outcome:</div><div class="line">        identifier = &quot;RightCell&quot;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    let cell = tableView.dequeueReusableCellWithIdentifier(identifier) as? NoteTableViewCell</div><div class="line"></div><div class="line">    return cell!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å›åˆ° <code>NoteTableViewCell</code> ä¸­åˆ›å»ºç‚¹å‡»äº‹ä»¶ï¼Œè®© <code>middleButton</code> åœ¨ç‚¹å‡»æ—¶å¼¹å‡ºéšè—çš„ <code>delete</code> å’Œ <code>edit</code> ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">middieButtonClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> !isExpand &#123;</div><div class="line">        expand()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        close()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®ç° <code>expand()</code> å’Œ <code>close()</code> æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">func expand() &#123;</div><div class="line"></div><div class="line">        editButton.hidden = false</div><div class="line">        deleteButton.hidden = false</div><div class="line"></div><div class="line">        UIView.animateWithDuration(0.5, animations: &#123;</div><div class="line"></div><div class="line">            self.deleteButton.center.x = 30</div><div class="line">            self.editButton.center.x = self.frame.size.width - 30</div><div class="line"></div><div class="line">            &#125;) &#123; (done) in</div><div class="line">                self.isExpand = true</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">func close() &#123;</div><div class="line"></div><div class="line">        UIView.animateWithDuration(0.5, animations: &#123;</div><div class="line"></div><div class="line">            self.deleteButton.center = self.middleButton.center</div><div class="line">            self.editButton.center = self.middleButton.center</div><div class="line"></div><div class="line">            &#125;) &#123; (done) in</div><div class="line">                self.deleteButton.hidden = true</div><div class="line">                self.editButton.hidden = true</div><div class="line">                self.isExpand = false</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="è®¾ç½®ä»£ç†"><a href="#è®¾ç½®ä»£ç†" class="headerlink" title="è®¾ç½®ä»£ç†"></a>è®¾ç½®ä»£ç†</h4><p>å°† <code>delete</code> å’Œ <code>edit</code> çš„ç‚¹å‡»äº‹ä»¶ä¼ é€’åˆ° <code>TableViewController</code> ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">NoteCellDelegate</span>: <span class="title">class</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">noteCellClickMiddleButtom</span><span class="params">(sender: NoteTableViewCell)</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è®¾ç½®ä»£ç†å¯¹è±¡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">NoteCellDelegate</span>?</div></pre></td></tr></table></figure>
<p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º <code>NoteTableViewContorller+NoteCellDelegate</code> ï¼Œå°†ä»£ç†æ–¹æ³•æ·»åŠ ä¸ºæ‰©å±•æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NoteTableViewController</span>: <span class="title">NoteCellDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">noteCellClickMiddleButtom</span><span class="params">(sender: NoteTableViewCell)</span></span>&#123;</div><div class="line">    <span class="keyword">let</span> indexPath = tableView.indexPathForCell(sender)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"cell <span class="subst">\(indexPath?.row)</span> clicked"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å›åˆ° <code>NoteTableViewCell</code> ä¸­ï¼Œå®Œå–„ <code>middieButtonClicked</code> æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">middieButtonClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> !isExpand &#123;</div><div class="line">        expand()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        close()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.delegate?.noteCellClickMiddleButtom(<span class="keyword">self</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å›åˆ° <code>NoteTableViewController</code> ä¸­ï¼Œå®Œå–„è‡ªå®šä¹‰ Cell çš„æ–¹æ³•ï¼Œä½¿ç”¨ä»£ç†è°ƒç”¨ <code>configureCell</code> æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> item = datas[indexPath.row]     </div><div class="line">    <span class="keyword">var</span> identifier = <span class="string">""</span></div><div class="line"></div><div class="line">    <span class="keyword">switch</span> item.type &#123;                  </div><div class="line">    <span class="keyword">case</span> .income:</div><div class="line">        identifier = <span class="string">"LeftCell"</span></div><div class="line">    <span class="keyword">case</span> .outcome:</div><div class="line">        identifier = <span class="string">"RightCell"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(identifier) <span class="keyword">as</span>? <span class="type">NoteTableViewCell</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> cell?.delegate == <span class="literal">nil</span> &#123;</div><div class="line"></div><div class="line">        cell?.delegate = <span class="keyword">self</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    cell?.configureCell(withItem: item)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> cell!</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œæ·»åŠ  <code>tableView</code> çš„ <code>tableHeaderView</code> ï¼ŒåŸå‹åŸºæœ¬ä¸Šå°±å®Œæˆäº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> frame = <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">70</span>)</div><div class="line"><span class="keyword">let</span> headerView = <span class="type">UIView</span>(frame: frame)</div><div class="line">headerView.backgroundColor = <span class="type">UIColor</span>.redColor()</div><div class="line">tableView.tableHeaderView = headerView</div></pre></td></tr></table></figure>
<p>ä¸‹é¢å°†å®Œæ•´ä»£ç è´´å‡ºæ¥æ–¹ä¾¿å¤§å®¶å‚è€ƒã€‚</p>
<h4 id="å®Œæ•´ä»£ç ï¼š"><a href="#å®Œæ•´ä»£ç ï¼š" class="headerlink" title="å®Œæ•´ä»£ç ï¼š"></a>å®Œæ•´ä»£ç ï¼š</h4><p><code>NoteTableViewController</code> æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoteTableViewController</span>: <span class="title">UITableViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> datas: [<span class="type">NoteItem</span>] = [<span class="type">NoteItem</span>(cost: <span class="number">1000</span>, content: <span class="string">"è´­ç‰©"</span>, type: .outcome),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">3000</span>, content: <span class="string">"å® ç‰©"</span>, type: .outcome),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">5000</span>, content: <span class="string">"å·¥èµ„"</span>, type: .income),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">2000</span>, content: <span class="string">"è´­ç‰©"</span>, type: .outcome),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">10000</span>, content: <span class="string">"å¥–é‡‘"</span>, type: .income),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">4000</span>, content: <span class="string">"æœè£…"</span>, type: .outcome),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">8000</span>, content: <span class="string">"é£Ÿå“"</span>, type: .outcome),</div><div class="line">                             <span class="type">NoteItem</span>(cost: <span class="number">6000</span>, content: <span class="string">"è´­ç‰©"</span>, type: .outcome),]      </div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line"></div><div class="line">        <span class="keyword">let</span> frame = <span class="type">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">70</span>)</div><div class="line">        <span class="keyword">let</span> headerView = <span class="type">UIView</span>(frame: frame)</div><div class="line">        headerView.backgroundColor = <span class="type">UIColor</span>.redColor()</div><div class="line">        tableView.tableHeaderView = headerView</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">return</span> datas.<span class="built_in">count</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> item = datas[indexPath.row]     </div><div class="line">        <span class="keyword">var</span> identifier = <span class="string">""</span></div><div class="line"></div><div class="line">        <span class="keyword">switch</span> item.type &#123;                  </div><div class="line">        <span class="keyword">case</span> .income:</div><div class="line">            identifier = <span class="string">"LeftCell"</span></div><div class="line">        <span class="keyword">case</span> .outcome:</div><div class="line">            identifier = <span class="string">"RightCell"</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(identifier) <span class="keyword">as</span>? <span class="type">NoteTableViewCell</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> cell?.delegate == <span class="literal">nil</span> &#123;</div><div class="line"></div><div class="line">            cell?.delegate = <span class="keyword">self</span></div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        cell?.configureCell(withItem: item)</div><div class="line"></div><div class="line">        <span class="keyword">return</span> cell!</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>NoteTableViewContorller+NoteCellDelegate</code> æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NoteTableViewController</span>: <span class="title">NoteCellDelegate</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">noteCellClickMiddleButtom</span><span class="params">(sender: NoteTableViewCell)</span></span>&#123;</div><div class="line">    <span class="keyword">let</span> indexPath = tableView.indexPathForCell(sender)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"cell <span class="subst">\(indexPath?.row)</span> clicked"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>NoteTableViewCell</code> æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoteTableViewCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> deleteButton: <span class="type">UIButton</span>!</div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> editButton: <span class="type">UIButton</span>!</div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> middleButton: <span class="type">UIButton</span>!</div><div class="line"></div><div class="line">    <span class="keyword">var</span> isExpand = <span class="literal">false</span>    </div><div class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">NoteCellDelegate</span>?</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">configureCell</span><span class="params">(withItem item: NoteItem)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">switch</span> item.content &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">"è´­ç‰©"</span>:</div><div class="line">            middleButton.setImage(<span class="type">UIImage</span>(named: <span class="string">"shopping.png"</span>), forState: .<span class="type">Normal</span>)</div><div class="line">        <span class="keyword">case</span> <span class="string">"æœè£…"</span>:</div><div class="line">            middleButton.setImage(<span class="type">UIImage</span>(named: <span class="string">"clothes.png"</span>), forState: .<span class="type">Normal</span>)</div><div class="line">        <span class="keyword">case</span> <span class="string">"é£Ÿå“"</span>:</div><div class="line">            middleButton.setImage(<span class="type">UIImage</span>(named: <span class="string">"restaurant.png"</span>), forState: .<span class="type">Normal</span>)</div><div class="line">        <span class="keyword">case</span> <span class="string">"å·¥èµ„"</span>,<span class="string">"å¥–é‡‘"</span>:</div><div class="line">            middleButton.setImage(<span class="type">UIImage</span>(named: <span class="string">"income.png"</span>), forState: .<span class="type">Normal</span>)</div><div class="line"></div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            middleButton.setImage(<span class="type">UIImage</span>(named: <span class="string">"middle_button.png"</span>), forState: .<span class="type">Normal</span>)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> lableConeten = <span class="string">"<span class="subst">\(item.content)</span> <span class="subst">\(item.cost)</span>"</span></div><div class="line"></div><div class="line">        setValue(lableConeten, forKeyPath: <span class="string">"descriptionLabel.text"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">setNilValueForKey</span><span class="params">(key: String)</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.setNilValueForKey(key)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"KVC çš„ä¼ å€¼ç›®æ ‡<span class="subst">\(key)</span> æ²¡æœ‰æ‰¾åˆ°"</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">middieButtonClicked</span><span class="params">(sender: AnyObject)</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> !isExpand &#123;</div><div class="line">            expand()</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            close()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.delegate?.noteCellClickMiddleButtom(<span class="keyword">self</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">expand</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        editButton.hidden = <span class="literal">false</span></div><div class="line">        deleteButton.hidden = <span class="literal">false</span></div><div class="line"></div><div class="line">        <span class="type">UIView</span>.animateWithDuration(<span class="number">0.5</span>, animations: &#123;</div><div class="line"></div><div class="line">            <span class="keyword">self</span>.deleteButton.center.x = <span class="number">30</span></div><div class="line">            <span class="keyword">self</span>.editButton.center.x = <span class="keyword">self</span>.frame.size.width - <span class="number">30</span></div><div class="line"></div><div class="line">            &#125;) &#123; (done) <span class="keyword">in</span></div><div class="line"></div><div class="line">                <span class="keyword">self</span>.isExpand = <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">close</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">        <span class="type">UIView</span>.animateWithDuration(<span class="number">0.5</span>, animations: &#123;</div><div class="line"></div><div class="line">            <span class="keyword">self</span>.deleteButton.center = <span class="keyword">self</span>.middleButton.center</div><div class="line">            <span class="keyword">self</span>.editButton.center = <span class="keyword">self</span>.middleButton.center</div><div class="line"></div><div class="line">            &#125;) &#123; (done) <span class="keyword">in</span></div><div class="line">                <span class="keyword">self</span>.deleteButton.hidden = <span class="literal">true</span></div><div class="line">                <span class="keyword">self</span>.editButton.hidden = <span class="literal">true</span></div><div class="line">                <span class="keyword">self</span>.isExpand = <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">NoteCellDelegate</span>: <span class="title">class</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">noteCellClickMiddleButtom</span><span class="params">(sender: NoteTableViewCell)</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">LeftNoteTableViewCell</span>: <span class="title">NoteTableViewCell</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> descriptionLabel: <span class="type">UILabel</span>!</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RightNoteTableViewCell</span>: <span class="title">NoteTableViewCell</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> descriptionLabel: <span class="type">UILabel</span>!</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>NoteItem</code> æ–‡ä»¶ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NoteItem</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> cost: <span class="type">Float</span>         </div><div class="line">    <span class="keyword">var</span> content: <span class="type">String</span>     </div><div class="line">    <span class="keyword">var</span> type: <span class="type">NoteItemType</span>  </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">NoteItemType</span>: <span class="title">Int</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> income</div><div class="line">    <span class="keyword">case</span> outcome</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ—¶é—´è½´æ˜¯å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰çš„ç‰¹æ•ˆï¼Œåœ¨ç½‘ç»œä¸Šä¹Ÿæœ‰å¾ˆå¤šç°æˆçš„èµ„æºï¼Œè™½ç„¶è½®å­å·²ç»æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªå·±å°è¯•æ¥åšä¸€ä¸ªä¹Ÿä¸å¤±ä¸ºæ˜¯ä¸€ç§ä¹è¶£ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ StoryBoard å’Œä»£ç æ¥å®Œæˆä¸€ä¸ªæ—¶é—´è½´çš„ç•Œé¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;é…ç½®-StoryBoardï¼š&quot;&gt;&lt;a href=&quot;#é…ç½®-StoryBoardï¼š&quot; class=&quot;headerlink&quot; title=&quot;é…ç½® StoryBoardï¼š&quot;&gt;&lt;/a&gt;é…ç½® StoryBoardï¼š&lt;/h4&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬åˆ›å»ºæ–°çš„ &lt;code&gt;Project&lt;/code&gt; ï¼Œåˆ æ‰é»˜è®¤çš„ &lt;code&gt;ViewController.swift&lt;/code&gt;ï¼Œå’Œ &lt;code&gt;MainStoryBoard&lt;/code&gt; ä¸­çš„ &lt;code&gt;ViewControlle r Scene&lt;/code&gt; ï¼Œç°åœ¨æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªç©ºçš„é¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬åœ¨ &lt;code&gt;Main.StoryBoard&lt;/code&gt; ä¸­æ‹–è¿›æ¥ä¸€ä¸ª &lt;code&gt;TableViewController&lt;/code&gt; ç»™å®ƒå‘½åä¸º &lt;code&gt;NoteTableViewController&lt;/code&gt; ï¼Œç„¶ååˆ›å»º &lt;code&gt;New File - File&lt;/code&gt; ï¼Œé€‰æ‹© &lt;code&gt;Cocoa Touch Class&lt;/code&gt; ï¼Œç»§æ‰¿è‡ª &lt;code&gt;UITableViewController&lt;/code&gt; ï¼Œå‘½åä¸º &lt;code&gt;NoteTableViewController&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°† &lt;code&gt;NoteTableViewController&lt;/code&gt; å’Œ &lt;code&gt;NoteTableViewController.Class&lt;/code&gt; è¿›è¡Œç»‘å®šï¼Œå¹¶ç»™&lt;code&gt;Main.StoryBoard&lt;/code&gt; è®¾ç½®ä¸€ä¸ª &lt;code&gt;Identity&lt;/code&gt; ï¼Œå¹¶å‹¾é€‰ &lt;code&gt;Is Initial View Controller&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹ä¸€æ­¥ï¼Œé€‰ä¸­ &lt;code&gt;NoteTableViewController&lt;/code&gt; ä¸‹çš„ &lt;code&gt;TableView&lt;/code&gt; ï¼Œå°†å®ƒçš„ &lt;code&gt;Row Height&lt;/code&gt; è®¾ç½®ä¸º60ï¼Œ&lt;code&gt;Prototype Cells&lt;/code&gt; è®¾ç½®ä¸º2ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ï¼Œè®¾ç½®ä¸¤ä¸ª &lt;code&gt;Cell&lt;/code&gt; ï¼Œåˆ†åˆ«å‘½åä¸º &lt;code&gt;RightCell å’Œ LeftCell&lt;/code&gt; ï¼Œç»™æ¯ä¸ª &lt;code&gt;Cell&lt;/code&gt; æ·»åŠ  &lt;code&gt;3ä¸ªButtonh å’Œ 1ä¸ªUIView&lt;/code&gt;ã€‚3ä¸ªæŒ‰é’®å‘½åä¾æ¬¡ä¸ºï¼š&lt;code&gt;middle delete edit&lt;/code&gt; ï¼Œå®½åº¦30ï¼Œé«˜åº¦30ï¼Œå¹¶ç»™æŒ‰é’®è®¾ç½®å¯¹åº”çš„èƒŒæ™¯å›¾ç‰‡ï¼Œå¹¶è®©3ä¸ªæŒ‰é’®å¯¹é½ï¼Œ&lt;code&gt;UIView&lt;/code&gt; çš„å®½åº¦æ˜¯2ï¼Œé«˜åº¦30ï¼ŒèƒŒæ™¯é¢œè‰²ä¸ºé»‘è‰²ã€‚&lt;/p&gt;
&lt;p&gt;ç»™ &lt;code&gt;LeftCell&lt;/code&gt; æ·»åŠ ä¸€ä¸ª&lt;code&gt;Label&lt;/code&gt;ï¼Œæ–‡æœ¬è®¾ç½®ä¸ºå³å¯¹é½ï¼Œç»™ &lt;code&gt;RightCell&lt;/code&gt; æ·»åŠ ä¸€ä¸ª &lt;code&gt;Label&lt;/code&gt;ï¼Œæ–‡æœ¬è®¾ç½®ä¸ºå·¦å¯¹é½ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå‹¾é€‰ &lt;code&gt;delete edit&lt;/code&gt; ä¸¤ä¸ªæŒ‰é’®çš„ &lt;code&gt;Hidden&lt;/code&gt; é€‰é¡¹ï¼Œç„¶ååˆ›å»º &lt;code&gt;New File - File&lt;/code&gt; ï¼Œé€‰æ‹© &lt;code&gt;Cocoa Touch Class&lt;/code&gt; ï¼Œç»§æ‰¿è‡ª &lt;code&gt;UITableViewCell&lt;/code&gt; ï¼Œå‘½åä¸º &lt;code&gt;NoteTableViewCell&lt;/code&gt; ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="ä»£ç†æ¨¡å¼" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è‡ªå®šä¹‰æ§ä»¶" scheme="http://yoursite.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6/"/>
    
      <category term="MVCè®¾è®¡æ¨¡å¼" scheme="http://yoursite.com/tags/MVC%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¤šçº¿ç¨‹ - çº¿ç¨‹é—´çš„é€šä¿¡</title>
    <link href="http://yoursite.com/2016/07/21/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/"/>
    <id>http://yoursite.com/2016/07/21/iOSå¤šçº¿ç¨‹ä¹‹ çº¿ç¨‹é—´çš„é€šä¿¡/</id>
    <published>2016-07-21T07:54:00.000Z</published>
    <updated>2016-08-21T18:12:07.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å› ä¸ºçº¿ç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¦ä¸‹è½½ä¸€ä¸ªå›¾ç‰‡ï¼Œä½¿å®ƒå‘ˆç°åœ¨ä¸€ä¸ª<code>UIImageView</code> é‡Œï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å¿…é¡»è¦ç­‰å¾…å›¾ç‰‡ä¸‹è½½å®Œæˆåï¼Œæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°å¤šçº¿ç¨‹çš„æŠ€æœ¯ï¼Œå°†ä¸‹è½½å›¾ç‰‡äº¤ç»™å­çº¿ç¨‹å®Œæˆï¼Œå°†åŠ è½½å›¾ç‰‡åˆ° <code>UIImageView</code> äº¤ç»™ä¸»çº¿ç¨‹ï¼Œè¿™å°±æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p>
</blockquote>
<h4 id="çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼"><a href="#çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼" class="headerlink" title="çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼"></a>çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼</h4><ol>
<li>ä»ä¸€ä¸ªçº¿ç¨‹ç»™å¦ä¸€ä¸ªçº¿ç¨‹ä¼ é€’æ•°æ®ã€‚</li>
<li>åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®Œç‰¹å®šä»»åŠ¡åï¼Œè½¬åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</li>
</ol>
<p>ä»¥ä¸Šé¢çš„é—®é¢˜ä¸¾ä¾‹ï¼Œæˆ‘ä»¬è¦åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä¸‹è½½å›¾ç‰‡ï¼Œç„¶åè¦å¦ä¸€ä¸ªçº¿ç¨‹å±•ç¤ºå›¾ç‰‡ï¼Œ<strong>è‹¹æœå®˜æ–¹æ¨èï¼Œåˆ·æ–°ç•Œé¢çš„æ“ä½œæœ€å¥½åœ¨ä¸»çº¿ç¨‹ä¸­å®Œæˆ</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥å®éªŒä¸€ä¸‹ï¼Œå¦‚æœå°†å±•ç¤ºå›¾ç‰‡çš„æ“ä½œäº¤ç»™å­çº¿ç¨‹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚<strong>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>UIImageView</code> å¹¶å°†å®ƒæ·»åŠ åˆ° <code>UIViewController</code></strong>ï¼Œç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> subThread = <span class="type">NSThread</span>(target: <span class="keyword">self</span>, selector: #selector(<span class="type">ViewController</span>.run(<span class="number">_</span>:)), object: <span class="string">"æˆ‘æ˜¯ä¼ å…¥å‚æ•°"</span>)</div><div class="line">    subThread.start()</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>ä¸‹é¢æˆ‘ä»¬åˆ›å»º <code>run</code> è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œæ–¹æ³•ï¼Œå†™å…¥ä»¥ä¸‹ä»£ç ä¸‹è½½å›¾ç‰‡ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">let</span> url: <span class="type">NSURL</span> = <span class="type">NSURL</span>(string: <span class="string">"http://pic.qiantucdn.com/58pic/19/40/65/17m58PICgSH_1024.jpg"</span>)!	<span class="comment">//ä½¿ç”¨ NSURL åˆ›å»ºä¸‹è½½é“¾æ¥</span></div><div class="line">    <span class="keyword">let</span> data: <span class="type">NSData</span> = <span class="type">NSData</span>(contentsOfURL: url)!	<span class="comment">//ä½¿ç”¨ NSData è·å¾—æ–‡ä»¶</span></div><div class="line">    <span class="keyword">let</span> img: <span class="type">UIImage</span> = <span class="type">UIImage</span>(data: data)!	<span class="comment">//ä½¿ç”¨ init?(data: NSData) å®ä¾‹åŒ–å›¾ç‰‡</span></div></pre></td></tr></table></figure>
<p>æœ€åå°†å›¾ç‰‡åŠ è½½åˆ° <code>UIImageView</code> é‡Œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.myImg.image = img</div></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå¦‚æœä½ çš„ XCode ç‰ˆæœ¬æ˜¯æ–°çš„è¯ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæ”¶åˆ°ä¸€æ¡æŠ¥é”™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">App</span> <span class="type">Transport</span> <span class="type">Security</span> has blocked a cleartext <span class="type">HTTP</span> (http:<span class="comment">//) resource load since it is insecure. Temporary exceptions can be configured via your app's Info.plist file.</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªåŸå› æ˜¯ iOS9 ä¸­æ–°å¢äº† <code>App Transport Security</code>ï¼ˆç®€ç§°ATSï¼‰ç‰¹æ€§ï¼Œåœ¨ iOS9 ä»¥å‰è¯·æ±‚ç½‘ç»œçš„æ—¶å€™éƒ½ç”¨åˆ°çš„<code>HTTP</code>ï¼Œç°åœ¨è½¬å‘TLS1.2åè®®è¿›è¡Œä¼ è¾“ã€‚è¿™ä¹Ÿæ„å‘³ç€æ‰€æœ‰çš„ <code>HTTP</code> åè®®éƒ½å¼ºåˆ¶ä½¿ç”¨äº† <code>HTTPS</code> åè®®è¿›è¡Œä¼ è¾“ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šå‘Šè¯‰æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨HTTPè¿›è¡Œè¯·æ±‚ï¼Œè¿™éœ€è¦åœ¨ <code>Info.plist</code> æ–°å¢ä¸€æ®µç”¨äºæ§åˆ¶ATSçš„é…ç½®ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;<span class="type">NSAppTransportSecurity</span>&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">   &lt;key&gt;<span class="type">NSAllowsArbitraryLoads</span>&lt;/key&gt;</div><div class="line">   &lt;<span class="literal">true</span>/&gt;</div><div class="line">&lt;/dict&gt;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬é‡æ–°è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œç›¸ä¿¡è¿™æ—¶å›¾ç‰‡å·²ç»æˆåŠŸåŠ è½½å‡ºæ¥äº†ï¼Œä½†æ˜¯æ§åˆ¶å°ä¼šæ”¶åˆ°è¿™æ ·ä¸€å¥æç¤ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">This</span> application <span class="keyword">is</span> modifying the autolayout engine from a background thread, which can lead to engine corruption and weird crashes.  <span class="type">This</span> will cause an exception <span class="keyword">in</span> a future release.</div></pre></td></tr></table></figure>
<p>è¿™æ˜¯è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>background thread</code> åå°è¿›ç¨‹æ›´æ”¹äº†å¸ƒå±€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å´©æºƒå’Œå…¶ä»–é—®é¢˜ï¼Œè¿™ä¹Ÿç¬¦åˆè‹¹æœå®˜æ–¹æ‰€æ¨èçš„ï¼š<strong>åˆ·æ–°ç•Œé¢çš„æ“ä½œæœ€å¥½åœ¨ä¸»çº¿ç¨‹ä¸­å®Œæˆ</strong>ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°†åˆ·æ–°ç•Œé¢çš„æ“ä½œäº¤ç»™ä¸»çº¿ç¨‹æ“ä½œï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æ„è¯†åˆ°é—®é¢˜çš„æ ¸å¿ƒï¼Œ<strong>å¦‚ä½•é€šçŸ¥ä¸»çº¿ç¨‹åˆ·æ–°ç•Œé¢</strong> ï¼Ÿæˆ‘ä»¬æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">performSelectorOnMainThread(#selector(<span class="type">ViewController</span>.showImage(<span class="number">_</span>:)), withObject: img, waitUntilDone: <span class="literal">true</span>)</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„å‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th>å½¢å‚</th>
<th>ä½œç”¨</th>
<th>å¡«å†™</th>
</tr>
</thead>
<tbody>
<tr>
<td>aSelector: Selector</td>
<td>è¿™æ˜¯ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œä»£è¡¨è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚</td>
<td>è‡ªå·±å†™çš„æ–¹æ³•</td>
</tr>
<tr>
<td>withObject arg: AnyObject?</td>
<td>è¿™æ˜¯æ‰§è¡Œæ–¹æ³•çš„ä¼ å…¥å‚æ•°ã€‚</td>
<td>å¯ä»¥æ˜¯nil</td>
</tr>
<tr>
<td>waitUntilDone wait: Bool</td>
<td>æ˜¯å¦è¦ç­‰å¾…æ‰§è¡Œæ–¹æ³•çš„å®Œæˆã€‚</td>
<td>å¯ä»¥æ˜¯false</td>
</tr>
</tbody>
</table>
<p>å‰ä¸¤ä¸ªå‚æ•°æ¯”è¾ƒå¥½ç†è§£ï¼Œå› ä¸ºæ‰§è¡Œæ–¹æ³•ä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° <code>true</code> å’Œ<code>false</code> çš„åŒºåˆ«æ˜¯ï¼šå¦‚æœæ˜¯ <code>true</code> çš„è¯ï¼Œä¸»çº¿ç¨‹ä¼šç­‰å¾…æ‰§è¡Œæ–¹æ³•å®Œæˆï¼Œä¸»çº¿ç¨‹æ‰ä¼šç»§ç»­å…¶ä»–çš„æ“ä½œï¼›å¦‚æ˜¯æ˜¯ <code>false</code> çš„è¯ï¼Œä¸»çº¿ç¨‹é©¬ä¸Šå°±ä¼šç»“æŸï¼Œå¹¶ä¸å…³å¿ƒæ‰§è¡Œæ–¹æ³•æ˜¯å¦å®Œæˆã€‚</p>
<p><strong>å¦‚æœä½ æœ‰ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚è¦ç­‰æ‰§è¡Œæ–¹æ³•å®Œæˆä¹‹åï¼Œåœ¨æ‰§è¡Œä¸€äº›å…¶ä»–çš„å·¥ä½œï¼Œè¿™æ˜¯å°±è¾“å…¥ <code>true</code>ï¼Œå¦‚æœä½ ä¸å…³å¿ƒæ‰§è¡Œçš„ç»“æœï¼Œå°±è¾“å…¥ <code>false</code>ã€‚</strong></p>
<p>ä¸‹é¢æˆ‘ä»¬å®ç°è®©ä¸»çº¿ç¨‹æ“ä½œ <code>UIImageView</code> æ˜¾ç¤ºå›¾ç‰‡çš„æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">showImage</span><span class="params">(img: UIImage)</span></span> &#123;</div><div class="line">    <span class="keyword">self</span>.myImg.image = img</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡è¿è¡Œï¼Œé£é™©æç¤ºæ²¡æœ‰äº†ï¼Œè¿™è¯´æ˜æˆ‘ä»¬å®ç°äº†ï¼Œä»å­çº¿ç¨‹ä¸­ä¸‹è½½å›¾ç‰‡ï¼Œå¹¶è°ƒç”¨ä¸»çº¿ç¨‹ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­åˆ·æ–°ç•Œé¢è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å› ä¸ºçº¿ç¨‹æ˜¯ä¸²è¡Œçš„ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¦ä¸‹è½½ä¸€ä¸ªå›¾ç‰‡ï¼Œä½¿å®ƒå‘ˆç°åœ¨ä¸€ä¸ª&lt;code&gt;UIImageView&lt;/code&gt; é‡Œï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å¿…é¡»è¦ç­‰å¾…å›¾ç‰‡ä¸‹è½½å®Œæˆåï¼Œæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°å¤šçº¿ç¨‹çš„æŠ€æœ¯ï¼Œå°†ä¸‹è½½å›¾ç‰‡äº¤ç»™å­çº¿ç¨‹å®Œæˆï¼Œå°†åŠ è½½å›¾ç‰‡åˆ° &lt;code&gt;UIImageView&lt;/code&gt; äº¤ç»™ä¸»çº¿ç¨‹ï¼Œè¿™å°±æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼&quot;&gt;&lt;a href=&quot;#çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼&quot; class=&quot;headerlink&quot; title=&quot;çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼&quot;&gt;&lt;/a&gt;çº¿ç¨‹é€šè®¯çš„ä¸¤ç§æ–¹å¼&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;ä»ä¸€ä¸ªçº¿ç¨‹ç»™å¦ä¸€ä¸ªçº¿ç¨‹ä¼ é€’æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®Œç‰¹å®šä»»åŠ¡åï¼Œè½¬åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸Šé¢çš„é—®é¢˜ä¸¾ä¾‹ï¼Œæˆ‘ä»¬è¦åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä¸‹è½½å›¾ç‰‡ï¼Œç„¶åè¦å¦ä¸€ä¸ªçº¿ç¨‹å±•ç¤ºå›¾ç‰‡ï¼Œ&lt;strong&gt;è‹¹æœå®˜æ–¹æ¨èï¼Œåˆ·æ–°ç•Œé¢çš„æ“ä½œæœ€å¥½åœ¨ä¸»çº¿ç¨‹ä¸­å®Œæˆ&lt;/strong&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥å®éªŒä¸€ä¸‹ï¼Œå¦‚æœå°†å±•ç¤ºå›¾ç‰‡çš„æ“ä½œäº¤ç»™å­çº¿ç¨‹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚&lt;strong&gt;é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª &lt;code&gt;UIImageView&lt;/code&gt; å¹¶å°†å®ƒæ·»åŠ åˆ° &lt;code&gt;UIViewController&lt;/code&gt;&lt;/strong&gt;ï¼Œç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; subThread = &lt;span class=&quot;type&quot;&gt;NSThread&lt;/span&gt;(target: &lt;span class=&quot;keyword&quot;&gt;self&lt;/span&gt;, selector: #selector(&lt;span class=&quot;type&quot;&gt;ViewController&lt;/span&gt;.run(&lt;span class=&quot;number&quot;&gt;_&lt;/span&gt;:)), object: &lt;span class=&quot;string&quot;&gt;&quot;æˆ‘æ˜¯ä¼ å…¥å‚æ•°&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    subThread.start()&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="çº¿ç¨‹é€šä¿¡" scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1/"/>
    
      <category term="ATSç‰¹æ€§" scheme="http://yoursite.com/tags/ATS%E7%89%B9%E6%80%A7/"/>
    
      <category term="çº¿ç¨‹è½¬è·³" scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B%E8%BD%AC%E8%B7%B3/"/>
    
  </entry>
  
  <entry>
    <title>Xcodeé”™è¯¯ - No Such Module</title>
    <link href="http://yoursite.com/2016/07/21/Xcode%E9%94%99%E8%AF%AF%20-%20No%20Such%20Module/"/>
    <id>http://yoursite.com/2016/07/21/Xcodeé”™è¯¯ - No Such Module/</id>
    <published>2016-07-20T20:43:00.000Z</published>
    <updated>2016-11-26T01:16:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>No.1 é¦–å…ˆç¡®ä¿å·¥ç¨‹ä¸­æœ‰è¿™ä¸ªåº“ï¼›</p>
<p>No.2 è¿›å…¥ <code>Build Phases</code> æ‰¾åˆ° <code>Link Binary With Libraries</code> ï¼Œæ·»åŠ è¿™ä¸ªåº“ï¼›</p>
<p>No.3 ç‚¹å‡» <code>Build Phases</code> é¡µé¢å·¦ä¸Šè§’åŠ å·ï¼Œç‚¹å‡» <code>New Copy Files Phase</code> ï¼Œåå­—æ”¹ä¸º <code>Copy FrameWorks</code> ï¼Œ<code>Destination</code> è®¾ç½®ä¸º <code>FrameWorks</code>ï¼Œå°†è¿™ä¸ªåº“æ·»åŠ è¿›æ¥å³å¯ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;No.1 é¦–å…ˆç¡®ä¿å·¥ç¨‹ä¸­æœ‰è¿™ä¸ªåº“ï¼›&lt;/p&gt;
&lt;p&gt;No.2 è¿›å…¥ &lt;code&gt;Build Phases&lt;/code&gt; æ‰¾åˆ° &lt;code&gt;Link Binary With Libraries&lt;/code&gt; ï¼Œæ·»åŠ è¿™ä¸ªåº“ï¼›&lt;/p&gt;
&lt;p&gt;No.3 ç‚¹å‡» &lt;code&gt;Build 
    
    </summary>
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/categories/Xcode%E9%94%99%E8%AF%AF/"/>
    
    
      <category term="Xcodeé”™è¯¯" scheme="http://yoursite.com/tags/Xcode%E9%94%99%E8%AF%AF/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¤šçº¿ç¨‹ - 3ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹</title>
    <link href="http://yoursite.com/2016/06/21/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%203%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B/"/>
    <id>http://yoursite.com/2016/06/21/iOSå¤šçº¿ç¨‹ä¹‹ 3ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹/</id>
    <published>2016-06-21T01:33:00.000Z</published>
    <updated>2017-01-24T15:48:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆæ¥çœ‹è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">detachNewThreadSelector</span>(<span class="title">selector</span>: <span class="title">Selector</span>, <span class="title">toTarget</span> <span class="title">target</span>: <span class="title">AnyObject</span>, <span class="title">withObject</span> <span class="title">argument</span>: <span class="title">AnyObject</span>?)</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿™ä¸ªæ˜¯å¸¸è§çš„ <code>init</code> åˆ›å»ºçº¿ç¨‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">convenience</span> <span class="keyword">init</span>(target: <span class="type">AnyObject</span>, selector: <span class="type">Selector</span>, object argument: <span class="type">AnyObject</span>?)</div></pre></td></tr></table></figure>
<p>è¿™ä¸¤ç§åˆ›å»ºæ–¹å¼æœ‰å“ªäº›ä¸åŒå‘¢ï¼Ÿæˆ‘ä»¬å¯¹æ¯”æ¥çœ‹ä¸‹ï¼š</p>
<blockquote>
<p><code>init</code> æ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼Œ<code>detachNewThreadSelector</code> æ˜¯ä¸€ä¸ªç±»å‹æ–¹æ³•ã€‚<code>detachNewThreadSelector</code> è¿”å›å€¼æ˜¯ <code>void</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰è¿”å›å€¼ã€‚<code>detachNewThreadSelector</code> åœ¨è°ƒç”¨åç«‹å³å¯åŠ¨ï¼Œä¸éœ€è¦ <code>start</code> æ–¹æ³•ã€‚</p>
</blockquote>
<a id="more"></a>
<p>ä¸‹é¢æˆ‘ä»¬æ¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨ <code>TouchesBegan</code> æ–¹æ³•ä¸­å†™å…¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">NSThread</span>.detachNewThreadSelector(#selector(<span class="type">ViewController</span>.run), toTarget: <span class="keyword">self</span>, withObject: <span class="string">"detachNewThreadSelector"</span>)</div></pre></td></tr></table></figure>
<p>åˆ›å»º <code>run</code> æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">(str: NSString)</span></span> &#123;</div><div class="line">    <span class="built_in">print</span>(str)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªçº¿ç¨‹äº†ã€‚</p>
<p><code>detachNewThread</code> è¿™ä¸ªç±»å‹æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½åƒä½¿ç”¨ <code>init</code> æ„é€ å™¨åˆ›å»ºé‚£æ ·ï¼Œä½¿ç”¨<code>start</code> <code>exit</code> <code>name</code> <code>stackSize</code> é‚£æ ·æ§åˆ¶çº¿ç¨‹å¯åŠ¨ã€å…³é—­ã€å‘½åã€è·å–æ ˆå¤§å°ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ <code>currentThread</code>  <code>mainThread</code>  <code>isMainThread</code>  <code>threadPriority</code> è¿›è¡Œè·å–å½“å‰çº¿ç¨‹ã€è·å–ä¸»çº¿ç¨‹ã€æŒ‡å®šä¼˜å…ˆçº§ç­‰æ“ä½œã€‚</p>
<p>æœ€åä¸€ç§æ–¹æ³•æ˜¯ <code>selectorInBackground</code> ï¼Œä»åå­—å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™æ˜¯åœ¨åœ¨åå°æ‰§è¡Œä¸€ä¸ªç›¸åº”å‡½æ•°ï¼Œä¸ <code>deathNewThread</code> å’Œ <code>init</code> ä¸åŒï¼Œ<code>selectorInbackground</code> æ˜¯ <code>Object</code> çš„å®ä¾‹æ–¹æ³•ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œå› æ­¤å®ƒåŒæ ·ä¸èƒ½å¯¹çº¿ç¨‹è¿›è¡Œæ§åˆ¶ã€‚è¿™ä¸ªæ–¹æ³•çš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">performSelectorInBackground(#selector(<span class="type">ViewController</span>.run(<span class="number">_</span>:)), withObject: <span class="string">"SelectorInBackground"</span>)</div></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šé¢çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒåŒ <code>init</code> è¿™ç§æ–¹å¼å¯¹æ¯”ï¼Œ<code>detachNewThread</code> å’Œ <code>performSelectorBackgroud</code> æ— æ³•å¯¹åˆ›å»ºçš„çº¿ç¨‹è¿›è¡Œå‘½åã€æ¯”è¾ƒã€è®¾å®šä¼˜å…ˆçº§ç­‰æ“ä½œã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆæ¥çœ‹è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;detachNewThreadSelector&lt;/span&gt;(&lt;span class=&quot;title&quot;&gt;selector&lt;/span&gt;: &lt;span class=&quot;title&quot;&gt;Selector&lt;/span&gt;, &lt;span class=&quot;title&quot;&gt;toTarget&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;target&lt;/span&gt;: &lt;span class=&quot;title&quot;&gt;AnyObject&lt;/span&gt;, &lt;span class=&quot;title&quot;&gt;withObject&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;argument&lt;/span&gt;: &lt;span class=&quot;title&quot;&gt;AnyObject&lt;/span&gt;?)&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªæ˜¯å¸¸è§çš„ &lt;code&gt;init&lt;/code&gt; åˆ›å»ºçº¿ç¨‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight swift&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;convenience&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;init&lt;/span&gt;(target: &lt;span class=&quot;type&quot;&gt;AnyObject&lt;/span&gt;, selector: &lt;span class=&quot;type&quot;&gt;Selector&lt;/span&gt;, object argument: &lt;span class=&quot;type&quot;&gt;AnyObject&lt;/span&gt;?)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™ä¸¤ç§åˆ›å»ºæ–¹å¼æœ‰å“ªäº›ä¸åŒå‘¢ï¼Ÿæˆ‘ä»¬å¯¹æ¯”æ¥çœ‹ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;init&lt;/code&gt; æ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼Œ&lt;code&gt;detachNewThreadSelector&lt;/code&gt; æ˜¯ä¸€ä¸ªç±»å‹æ–¹æ³•ã€‚&lt;code&gt;detachNewThreadSelector&lt;/code&gt; è¿”å›å€¼æ˜¯ &lt;code&gt;void&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰è¿”å›å€¼ã€‚&lt;code&gt;detachNewThreadSelector&lt;/code&gt; åœ¨è°ƒç”¨åç«‹å³å¯åŠ¨ï¼Œä¸éœ€è¦ &lt;code&gt;start&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="å¼€çº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%BC%80%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="åå°è¿›ç¨‹" scheme="http://yoursite.com/tags/%E5%90%8E%E5%8F%B0%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>iOSå¤šçº¿ç¨‹ - GCDçº¿ç¨‹ç®¡ç†</title>
    <link href="http://yoursite.com/2016/05/22/iOS%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B9%8B%20GCD%E7%BA%BF%E7%A8%8B%E7%AE%A1%E7%90%86%EF%BC%88%E4%B8%8A%EF%BC%89/"/>
    <id>http://yoursite.com/2016/05/22/iOSå¤šçº¿ç¨‹ä¹‹ GCDçº¿ç¨‹ç®¡ç†ï¼ˆä¸Šï¼‰/</id>
    <published>2016-05-21T20:55:00.000Z</published>
    <updated>2017-01-24T15:48:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>GCDå…¨ç§°æ˜¯ Grand Central Dispatchï¼Œå®ƒæ˜¯åŸºäº C è¯­è¨€å¼€å‘çš„ä¸€å¥—å¤šçº¿ç¨‹å¼€å‘æœºåˆ¶ï¼Œä¹Ÿæ˜¯ç›®å‰è‹¹æœå®˜æ–¹æ¨èçš„å¤šçº¿ç¨‹å¼€å‘æ–¹æ³•ã€‚</p>
</blockquote>
<h4 id="GCDçš„ä¼˜åŠ¿"><a href="#GCDçš„ä¼˜åŠ¿" class="headerlink" title="GCDçš„ä¼˜åŠ¿"></a>GCDçš„ä¼˜åŠ¿</h4><ol>
<li>GCD æ˜¯è‹¹æœå…¬å¸ä¸º<strong>å¤šæ ¸çš„å¹¶è¡Œè¿ç®—</strong>æä¾›çš„è§£å†³æ–¹æ¡ˆï¼›</li>
<li>GCD ä¼šè‡ªåŠ¨åˆ©ç”¨æ›´å¤šçš„CPUå†…æ ¸ï¼ˆæ¯”å¦‚åŒæ ¸ã€å››æ ¸ï¼‰ï¼›</li>
<li>GCD ä¼šè‡ªåŠ¨ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºä»»åŠ¡ã€è°ƒåº¦ä»»åŠ¡ã€é”€æ¯ä»»åŠ¡ï¼‰ï¼›</li>
</ol>
<p>å› æ­¤ï¼Œç¨‹åºå‘˜åªéœ€è¦å‘Šè¯‰ GCD æƒ³è¦æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ï¼ŒæŠŠä»»åŠ¡æ”¾åœ¨å¯¹åº”çš„ <code>block</code> é‡Œé¢ã€‚ä¸éœ€è¦ç¼–å†™ä»»ä½•çº¿ç¨‹ç®¡ç†ä»£ç ã€‚</p>
<a id="more"></a>
<h4 id="GCDåœ¨å·¥ç¨‹ä¸­çš„ä½ç½®"><a href="#GCDåœ¨å·¥ç¨‹ä¸­çš„ä½ç½®" class="headerlink" title="GCDåœ¨å·¥ç¨‹ä¸­çš„ä½ç½®"></a>GCDåœ¨å·¥ç¨‹ä¸­çš„ä½ç½®</h4><p>GCD å­˜åœ¨äº <code>libdispatch.dylib</code> è¿™ä¸ªåº“é‡Œé¢ï¼Œè¿™ä¸ªè°ƒåº¦åº“åŒ…å«äº† GCD çš„æ‰€æœ‰çš„ä¸œè¥¿ï¼Œä»»ä½• iOS ç¨‹åºé»˜è®¤å°±åŠ è½½äº†è¿™ä¸ªåº“ï¼Œå› æ­¤ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¯¼å…¥ã€‚</p>
<h4 id="åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ"><a href="#åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ" class="headerlink" title="åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ"></a>åŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ</h4><p>åŒæ­¥ï¼šå°±æ˜¯åœ¨æ‰§è¡Œä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œè¯¥è°ƒç”¨å°±ä¸è¿”å›ã€‚<strong>ä¹Ÿå°±æ˜¯å¿…é¡»ä¸€ä»¶ä¸€ä»¶äº‹åšï¼Œç­‰å‰ä¸€ä»¶åšå®Œäº†æ‰èƒ½åšä¸‹ä¸€ä»¶äº‹</strong>ã€‚</p>
<p>å¼‚æ­¥ï¼šå¼‚æ­¥çš„æ¦‚å¿µå’ŒåŒæ­¥ç›¸å¯¹ã€‚å½“ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹è°ƒç”¨å‘å‡ºåï¼Œè°ƒç”¨è€…ä¸èƒ½ç«‹åˆ»å¾—åˆ°ç»“æœã€‚å®é™…å¤„ç†è¿™ä¸ªè°ƒç”¨çš„éƒ¨ä»¶åœ¨å®Œæˆåï¼Œé€šè¿‡çŠ¶æ€ã€é€šçŸ¥å’Œå›è°ƒæ¥é€šçŸ¥è°ƒç”¨è€…ã€‚</p>
<p>åŒæ­¥å°±æ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œå¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›ï¼Œçº¿ç¨‹å°±ä¸€ç›´ç­‰ã€‚å¼‚æ­¥æ˜¯å¦èµ·ä¸€æ¡çº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªå·¥ä½œã€‚</p>
<h4 id="åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°"><a href="#åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°" class="headerlink" title="åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°"></a>åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°</h4><p>ä¸‹é¢æ˜¯åŒæ­¥å‡½æ•°çš„è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">dispatch_sync</span><span class="params">(queue: dispatch_queue_t, <span class="number">_</span> block: dispatch_block_t)</span></span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¼‚æ­¥å‡½æ•°çš„è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">dispatch_async</span><span class="params">(queue: dispatch_queue_t, <span class="number">_</span> block: dispatch_block_t)</span></span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸¤ä¸ªå‡½æ•°çš„ä¼ å…¥å‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
<th>ä¼ å…¥å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>queue: dispatch_queue_t</td>
<td>è¿™æ˜¯ä¸€ä¸ªé˜Ÿåˆ—</td>
<td>é˜Ÿåˆ—</td>
</tr>
<tr>
<td>_ block: dispatch_block_t</td>
<td>è¿™æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„ä¸€ä¸ªä»»åŠ¡</td>
<td>block</td>
</tr>
</tbody>
</table>
<p>åŒæ­¥å‡½æ•°ä¸ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ <code>dispatch_sync</code>è¿™ä¸ªå‡½æ•°æ—¶ å®ƒä¼šä¸€ç›´ç­‰å¾… <code>block</code> çš„å®Œæˆï¼Œ<code>block</code>  æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°æ‰è¿”å›ã€‚</p>
<p>å½“æ‰§è¡Œ <code>dispatch_async</code> æ—¶ï¼Œä¸è®º block æ˜¯å¦æ‰§è¡Œå®Œï¼Œåªè¦è°ƒç”¨äº†å‡½æ•°å°±è¿”å›äº†ã€‚</p>
<p>ä¸‹é¢è®²å‡ ä¸ªä¾‹å­æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£åŒæ­¥å’Œå¼‚æ­¥ï¼š</p>
<blockquote>
<p>åŒæ­¥ï¼šå‘é€æ–¹å‘å‡ºæ•°æ®åï¼Œç­‰æ¥æ”¶æ–¹å‘å›å“åº”ä»¥åæ‰å‘ä¸‹ä¸€ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚<br>å¼‚æ­¥ï¼šå‘é€æ–¹å‘å‡ºæ•°æ®åï¼Œä¸ç­‰æ¥æ”¶æ–¹å‘å›å“åº”ï¼Œæ¥ç€å‘é€ä¸‹ä¸ªæ•°æ®åŒ…çš„é€šè®¯æ–¹å¼ã€‚  </p>
<p>åŒæ­¥ï¼šæäº¤è¯·æ±‚-&gt;ç­‰å¾…æœåŠ¡å™¨å¤„ç†-&gt;å¤„ç†å®Œæ¯•è¿”å› è¿™ä¸ªæœŸé—´å®¢æˆ·ç«¯ä¸èƒ½å¹²ä»»ä½•äº‹<br>å¼‚æ­¥ï¼šè¯·æ±‚é€šè¿‡äº‹ä»¶è§¦å‘-&gt;æœåŠ¡å™¨å¤„ç†ï¼ˆè¿™æ—¶å®¢æˆ·ç«¯ä»ç„¶å¯ä»¥åšå…¶ä»–äº‹æƒ…ï¼‰-&gt;å¤„ç†å®Œæ¯•</p>
<p>åŒæ­¥ï¼šå°±æ˜¯ä½ å«æˆ‘å»åƒé¥­ï¼Œæˆ‘å¬åˆ°äº†å°±å’Œä½ å»åƒé¥­ï¼›å¦‚æœæ²¡æœ‰å¬åˆ°ï¼Œä½ å°±ä¸åœçš„å«ï¼Œç›´åˆ°æˆ‘å‘Šè¯‰ä½ æˆ‘å¬åˆ°äº†ï¼Œæ‰ä¸€èµ·å»åƒé¥­ã€‚<br>å¼‚æ­¥å°±æ˜¯ä½ å«æˆ‘ï¼Œç„¶åè‡ªå·±å»åƒé¥­ï¼Œæˆ‘å¾—åˆ°æ¶ˆæ¯åå¯èƒ½ç«‹å³èµ°ï¼Œä¹Ÿå¯èƒ½ç­‰åˆ°ä¸‹ç­æ‰å»åƒé¥­ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¦æˆ‘è¯·ä½ åƒé¥­å°±ç”¨åŒæ­¥çš„æ–¹æ³•ï¼Œè¦è¯·æˆ‘åƒé¥­å°±ç”¨å¼‚æ­¥çš„æ–¹æ³•ã€‚</p>
</blockquote>
<h4 id="åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°çš„ä½¿ç”¨åœºæ™¯"><a href="#åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°çš„ä½¿ç”¨åœºæ™¯"></a>åŒæ­¥å‡½æ•°å’Œå¼‚æ­¥å‡½æ•°çš„ä½¿ç”¨åœºæ™¯</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dispatch_async(concutentQueue, ^&#123;</div><div class="line">    	<span class="comment">//é•¿æ—¶é—´å¤„ç†</span></div><div class="line">    	<span class="comment">//ä¾‹å¦‚ARç”¨åŠ¨ç”»è¯†åˆ«</span></div><div class="line">    	<span class="comment">//ä¾‹å¦‚æ•°æ®åº“è®¿é—®</span></div><div class="line">    	<span class="comment">//é•¿æ—¶é—´å¤„ç†ç»“æŸï¼Œä¸»çº¿ç¨‹ä½¿ç”¨è¯¥å¤„ç†ç»“æœ</span></div><div class="line">   	 dispatch_async(mainQueue, ^&#123;</div><div class="line">   	 <span class="comment">//åªåœ¨ä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œçš„å¤„ç†</span></div><div class="line">   	 <span class="comment">//ä¾‹å¦‚ç”¨æˆ·ç•Œé¢æ›´æ–°</span></div><div class="line">  	  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="CGDçš„-3-ç§é˜Ÿåˆ—"><a href="#CGDçš„-3-ç§é˜Ÿåˆ—" class="headerlink" title="CGDçš„ 3 ç§é˜Ÿåˆ—"></a>CGDçš„ 3 ç§é˜Ÿåˆ—</h4><p>ä½¿ç”¨ GCD å¼€å‘åŸºæœ¬çœ‹ä¸åˆ°çº¿ç¨‹ï¼Œçº¿ç¨‹çš„ç»†èŠ‚éƒ½è¢«å°è£…èµ·æ¥äº†ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠè¦æ‰§è¡Œçš„ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—é‡Œå°±å¯ä»¥äº†ï¼ŒGCD ä¼šæ ¹æ®æŒ‡å®šçš„é˜Ÿåˆ— ï¼Œå°†é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å–å‡ºæ¥æ”¾åœ¨å¯¹åº”çš„çº¿ç¨‹æ‰§è¡Œã€‚ä»»åŠ¡çš„å–å‡ºéµå¾ªé˜Ÿåˆ—çš„ FIFO åŸåˆ™ï¼šå…ˆè¿›å…ˆå‡ºï¼Œåè¿›åå‡ºã€‚</p>
<p>é˜Ÿåˆ—åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸²è¡Œé˜Ÿåˆ—ï¼Œä¸€ç§æ˜¯å¹¶è¡Œé˜Ÿåˆ—ã€‚ä½†æ˜¯å…·ä½“åˆ°GCDé‡Œé¢ï¼Œé˜Ÿåˆ—å°±åˆ†ä¸ºäº† 3 ç§ã€‚</p>
<ol>
<li><p>ä¸»é˜Ÿåˆ—</p>
<p>ä¸»é˜Ÿåˆ—æ˜¯æŒ‡è¿è¡Œåœ¨ä¸»çº¿ç¨‹é‡Œçš„ <code>Main Queue</code> ï¼Œ ä¸»é˜Ÿåˆ—ä¸éœ€è¦åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡ <code>dispatch_get_main_queue</code> è·å–åˆ°ä¸»é˜Ÿåˆ—ã€‚</p>
</li>
<li><p>å¹¶è¡Œé˜Ÿåˆ—</p>
<p>å¹¶è¡Œé˜Ÿåˆ—æ˜¯ä¸€ç§å…¨å±€å¹¶è¡Œé˜Ÿåˆ—ï¼ŒåŒæ ·ä¸éœ€è¦è‡ªå·±åˆ›å»ºï¼Œé€šè¿‡ <code>dispatch_get_global_queue</code> å¯ä»¥è·å–åˆ°å…¨å±€çš„å¹¶è¡Œé˜Ÿåˆ—ï¼Œè€Œä¸”è¿™ä¸ªå…¨å±€çš„å¹¶è¡Œé˜Ÿåˆ—æœ‰3ä¸ªï¼Œå› ä¸ºæœ‰ 3ä¸ªä¸åŒçš„ä¼˜å…ˆçº§ ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>dispatch_get_main_queue</code> è·å–å…¨å±€å¹¶è¡Œé˜Ÿåˆ—ï¼Œåœ¨è·å–æ—¶å¯ä»¥é€šè¿‡æŒ‡å®šå®ƒçš„ä¼˜å…ˆçº§ï¼Œæ¥è·å–ä¸åŒä¼˜å…ˆçº§çš„å¹¶è¡Œé˜Ÿåˆ—ã€‚å¹¶è¡Œé˜Ÿåˆ—çš„æ‰§è¡Œé¡ºåºå’ŒåŠ å…¥é˜Ÿåˆ—çš„é¡ºåºç›¸åŒï¼Œä¹Ÿå°±æ˜¯å…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚</p>
</li>
<li><p>è‡ªå®šä¹‰é˜Ÿåˆ—</p>
<p>è‡ªå®šä¹‰é˜Ÿåˆ—å°±æ˜¯æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>dispatch_queue_creat</code> è¿›è¡Œåˆ›å»ºï¼Œåˆ›å»ºè‡ªå®šä¹‰é˜Ÿåˆ—æ—¶å¯ä»¥å£°æ˜å…¶æ˜¯ä¸²è¡Œé˜Ÿåˆ—è¿˜æ˜¯å¹¶è¡Œé˜Ÿåˆ—ã€‚</p>
</li>
</ol>
<h4 id="åŒæ­¥ã€å¼‚æ­¥ã€å¹¶è¡Œã€ä¸²è¡Œçš„æ¦‚å¿µæ¯”è¾ƒ"><a href="#åŒæ­¥ã€å¼‚æ­¥ã€å¹¶è¡Œã€ä¸²è¡Œçš„æ¦‚å¿µæ¯”è¾ƒ" class="headerlink" title="åŒæ­¥ã€å¼‚æ­¥ã€å¹¶è¡Œã€ä¸²è¡Œçš„æ¦‚å¿µæ¯”è¾ƒ"></a>åŒæ­¥ã€å¼‚æ­¥ã€å¹¶è¡Œã€ä¸²è¡Œçš„æ¦‚å¿µæ¯”è¾ƒ</h4><ol>
<li><p>åŒæ­¥å’Œå¼‚æ­¥å†³å®šäº†è¦ä¸è¦å¼€å¯æ–°çš„çº¿ç¨‹ï¼š</p>
<p>åŒæ­¥ï¼šåœ¨å½“å‰è¿›è¡Œä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼›</p>
<p>å¼‚æ­¥ï¼šåœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œå…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ï¼›</p>
</li>
<li><p>å¹¶è¡Œå’Œä¸²è¡Œå†³å®šäº†ä»»åŠ¡æ‰§è¡Œçš„æ–¹å¼</p>
<p>å¹¶è¡Œï¼šå¤šä¸ªä»»åŠ¡å¹¶å‘ï¼ˆåŒæ—¶ï¼‰æ‰§è¡Œï¼›</p>
<p>ä¸²è¡Œï¼šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼›</p>
</li>
</ol>
<h4 id="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸»é˜Ÿåˆ—"><a href="#ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸»é˜Ÿåˆ—" class="headerlink" title="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸»é˜Ÿåˆ—"></a>ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸»é˜Ÿåˆ—</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> mainQueue: dispatch_queue_t =  dispatch_get_main_queue()  <span class="comment">//è·å–ä¸»é˜Ÿåˆ—</span></div><div class="line">       dispatch_async(mainQueue) &#123;</div><div class="line">           <span class="built_in">print</span>(<span class="string">"ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸»é˜Ÿåˆ—ï¼Œæ‰€åœ¨çš„çº¿ç¨‹æ˜¯<span class="subst">\(NSThread.currentThread()</span>)"</span>)</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ‰“å°æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸»é˜Ÿåˆ—æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p>
<h4 id="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—"><a href="#ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—" class="headerlink" title="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—"></a>ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—</h4><p><strong>è·å–å¹¶è¡Œé˜Ÿåˆ—</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">dispatch_get_global_queue</span><span class="params">(identifier: Int, <span class="number">_</span> flags: UInt)</span></span> -&gt; dispatch_queue_t!</div></pre></td></tr></table></figure>
<p>ä¼ å…¥å‚æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å½¢å‚</th>
<th>ä½œç”¨</th>
<th>ä¼ å…¥å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>identifier: Int</td>
<td>è¡¨ç¤ºé˜Ÿåˆ—çš„ä¼˜å…ˆçº§ã€‚</td>
<td>è§ä¸‹ä¸€ä¸ªè¡¨æ ¼</td>
</tr>
<tr>
<td>_ flags: UInt</td>
<td>ä¸ºä»¥åä½¿ç”¨çš„æ ‡è®°ï¼Œä¼ å…¥0ä»¥å¤–çš„å€¼å¯èƒ½ä¼šè¿”å›ç©ºå€¼ã€‚</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong><code>identifier: Int</code> åœ¨ <code>iOS7</code> ä»¥åå¯ä»¥ä½¿ç”¨çš„å€¼ï¼š</strong></p>
<table>
<thead>
<tr>
<th>å€¼çš„åç§°</th>
<th>å«ä¹‰ï¼šä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>QOS_CLASS_USER_INTERACTIVE</td>
<td><strong>ç”¨æˆ·äº¤äº’ï¼šå°½å¿«å®Œæˆï¼Œç”¨æˆ·åœ¨æœŸå¾…ç»“æœï¼Œä¸è¦æ”¾å¤ªè€—æ—¶æ“ä½œ</strong>ã€‚</td>
</tr>
<tr>
<td>QOS_CLASS_USER_INITIATED</td>
<td><strong>ç”¨æˆ·æœŸæœ›ï¼šä¸è¦æ”¾å¤ªè€—æ—¶æ“ä½œã€‚</strong></td>
</tr>
<tr>
<td>QOS_CLASS_DEFAULT</td>
<td><strong>é»˜è®¤ï¼šä¸æ˜¯ç»™ç¨‹åºå‘˜ä½¿ç”¨çš„ï¼Œç”¨æ¥é‡ç½®å¯¹åˆ—ä½¿ç”¨çš„ã€‚</strong></td>
</tr>
<tr>
<td>QOS_CLASS_UTILITY</td>
<td><strong>å®ç”¨å·¥å…·ï¼šè€—æ—¶æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚</strong></td>
</tr>
<tr>
<td>QOS_CLASS_BACKGROUND</td>
<td><strong>åå°</strong></td>
</tr>
</tbody>
</table>
<p><strong><code>identifier: Int</code> åœ¨ <code>iOS7</code> ä»¥å‰ä½¿ç”¨çš„å€¼ï¼š</strong></p>
<table>
<thead>
<tr>
<th>å€¼çš„åç§°</th>
<th>å¯¹åº”å…³ç³»</th>
<th>ä¼˜å…ˆçº§</th>
</tr>
</thead>
<tbody>
<tr>
<td>DISPATCH_QUEUE_PRIORITY_HIGH</td>
<td>QOS_CLASS_USER_INITIATED</td>
<td>é«˜ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td>DISPATCH_QUEUE_PRIORITY_DEFAULT</td>
<td>QOS_CLASS_DEFAULT</td>
<td>é»˜è®¤ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td>DISPATCH_QUEUE_PRIORITY_LOW</td>
<td>QOS_CLASS_UTILITY</td>
<td>ä½ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td>DISPATCH_QUEUE_PRIORITY_BACKGROUND</td>
<td>QOS_CLASS_BACKGROUND</td>
<td>åå°ä¼˜å…ˆçº§</td>
</tr>
</tbody>
</table>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š<code>BACKGROUND</code> è¡¨ç¤ºç”¨æˆ·ä¸éœ€è¦çŸ¥é“ä»»åŠ¡ä»€ä¹ˆæ—¶å€™å®Œæˆï¼Œå¦‚æœé€‰æ‹©è¿™ä¸ªé€‰é¡¹é€Ÿåº¦æ…¢å¾—ä»¤äººå‘æŒ‡ï¼Œéå¸¸ä¸åˆ©äºè°ƒè¯•ï¼å¯¹äºä¼˜å…ˆçº§æ¨èä¸è¦æå¾—å¤ªè´Ÿè´£ï¼Œå°±ç”¨æœ€ç®€å•ï¼Œä»¥å…å‘ç”Ÿä¼˜å…ˆçº§åè½¬ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬åˆ›å»º 2 ä¸ªå¼‚æ­¥å‡½æ•°å¹¶æ‰§è¡Œä¸€ä¸ªå¹¶è¡Œé˜Ÿåˆ—ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> concurentQueue =  dispatch_get_global_queue(<span class="type">QOS_CLASS_DEFAULT</span>, <span class="number">0</span>)</div><div class="line"></div><div class="line">    dispatch_async(concurentQueue) &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œç¬¬1ä¸ªå…¨å±€å¹¶è¡Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ˜¯<span class="subst">\(NSThread.currentThread()</span>)"</span>)</div><div class="line">    &#125;</div><div class="line">    dispatch_async(concurentQueue) &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œç¬¬2ä¸ªå…¨å±€å¹¶è¡Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ˜¯<span class="subst">\(NSThread.currentThread()</span>)"</span>)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ‰“å°æ—¥å¿—æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šå¦‚æœä½¿ç”¨å…¨å±€å¹¶è¡Œé˜Ÿåˆ—ï¼Œå¹¶ä¸”ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œæ—¶ï¼Œå¼‚æ­¥å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¹¶è¡Œçº¿ç¨‹ï¼Œå¹¶è¡Œçº¿ç¨‹å’Œä¸»çº¿ç¨‹æ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œæ‰€ä»¥å“ªä¸ªå…ˆæ‰§è¡Œå¹¶ä¸èƒ½æŒæ¡ã€‚</p>
<p>æ¯å½“æœ‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­çº¿ç¨‹ï¼Œå¹¶åœ¨è¿™ä¸ªæ–°çš„çº¿ç¨‹ä¸­è¿è¡Œã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ä½ ä½¿ç”¨å¾ˆå¤šå¼‚æ­¥å‡½æ•°æ‰§è¡Œå¹¶è¡Œé˜Ÿåˆ—ï¼Œå°±ä¼šæœ‰å¾ˆå¤šä¸ªå­çº¿ç¨‹ï¼Œå½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿä¼šå°†ä½ åœ¨ block çš„æ“ä½œå°è£…ç»™å…¶ä»–çš„å­çº¿ç¨‹è¿è¡Œã€‚</p>
<h4 id="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œè‡ªå®šä¹‰é˜Ÿåˆ—"><a href="#ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œè‡ªå®šä¹‰é˜Ÿåˆ—" class="headerlink" title="ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œè‡ªå®šä¹‰é˜Ÿåˆ—"></a>ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œè‡ªå®šä¹‰é˜Ÿåˆ—</h4><p><strong>åˆ›å»ºè‡ªå®šä¹‰é˜Ÿåˆ—</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">dispatch_queue_create</span><span class="params">(label: UnsafePointer&lt;Int8&gt;, <span class="number">_</span> attr: dispatch_queue_attr_t!)</span></span> -&gt; dispatch_queue_t!</div></pre></td></tr></table></figure>
<p>ä¼ å…¥å‚æ•°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å½¢å‚</th>
<th>ä½œç”¨</th>
<th>ä¼ å…¥å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>label: UnsafePointer<int8></int8></td>
<td>é˜Ÿåˆ—çš„åç§°</td>
<td>å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬æ˜¯è¯·æ±‚çš„æ“ä½œï¼Œå¯ä»¥æ˜¯nilã€‚</td>
</tr>
<tr>
<td>_ attr: dispatch_queue_attr_t!</td>
<td>é˜Ÿåˆ—çš„ç±»å‹</td>
<td>ä¸²è¡Œé˜Ÿåˆ—ï¼šDISPATCH_QUEUE_SERIAL<br>å¹¶è¡Œé˜Ÿåˆ—ï¼šDISPATCH_QUEUE_CONCURRENT</td>
</tr>
</tbody>
</table>
<p>ä¸‹é¢æˆ‘ä»¬åˆ›å»º 2 ä¸ªå¼‚æ­¥å‡½æ•°å¹¶æ‰§è¡Œä¸€ä¸ªä¸²è¡Œè¡Œé˜Ÿåˆ—ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myQueue = dispatch_queue_create(<span class="string">"è¯·æ±‚çš„æ“ä½œ"</span>, <span class="type">DISPATCH_QUEUE_SERIAL</span>)</div><div class="line">dispatch_async(myQueue) &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œç¬¬1ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ˜¯<span class="subst">\(NSThread.currentThread()</span>)"</span>)</div><div class="line">&#125;</div><div class="line">dispatch_async(myQueue) &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"ä½¿ç”¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œç¬¬2ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ˜¯<span class="subst">\(NSThread.currentThread()</span>)"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ‰“å°ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šå¦‚æœä½¿ç”¨ä¸²è¡Œé˜Ÿåˆ—ï¼Œå¹¶ä¸”æ˜¯å¼‚æ­¥å‡½æ•°æ—¶ï¼Œä¸è®ºæœ‰å¤šå°‘å¼‚æ­¥å‡½æ•°ï¼Œåªä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚</p>
<h4 id="å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸åŒé˜Ÿåˆ—çš„å¯¹æ¯”"><a href="#å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸åŒé˜Ÿåˆ—çš„å¯¹æ¯”" class="headerlink" title="å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸åŒé˜Ÿåˆ—çš„å¯¹æ¯”"></a>å¼‚æ­¥å‡½æ•°æ‰§è¡Œä¸åŒé˜Ÿåˆ—çš„å¯¹æ¯”</h4><table>
<thead>
<tr>
<th></th>
<th>å¼‚æ­¥å‡½æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>è·å–çš„ä¸»é˜Ÿåˆ—</td>
<td>æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹ï¼Œä¸²è¡Œæ‰§è¡Œä»»åŠ¡ã€‚</td>
</tr>
<tr>
<td>è·å–çš„å¹¶è¡Œé˜Ÿåˆ—</td>
<td>æœ‰å¼€å¯æ–°çº¿ç¨‹ä¸”å¯å¤šå¼€çº¿ç¨‹ï¼Œå¹¶è¡Œæ‰§è¡Œä»»åŠ¡ã€‚</td>
</tr>
<tr>
<td>åˆ›å»ºçš„å¹¶è¡Œé˜Ÿåˆ—</td>
<td>æœ‰å¼€å¯æ–°çº¿ç¨‹ä½†åªå¯å¼€ä¸€æ¡ï¼Œä¸²è¡Œæ‰§è¡Œä»»åŠ¡ã€‚</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;GCDå…¨ç§°æ˜¯ Grand Central Dispatchï¼Œå®ƒæ˜¯åŸºäº C è¯­è¨€å¼€å‘çš„ä¸€å¥—å¤šçº¿ç¨‹å¼€å‘æœºåˆ¶ï¼Œä¹Ÿæ˜¯ç›®å‰è‹¹æœå®˜æ–¹æ¨èçš„å¤šçº¿ç¨‹å¼€å‘æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;GCDçš„ä¼˜åŠ¿&quot;&gt;&lt;a href=&quot;#GCDçš„ä¼˜åŠ¿&quot; class=&quot;headerlink&quot; title=&quot;GCDçš„ä¼˜åŠ¿&quot;&gt;&lt;/a&gt;GCDçš„ä¼˜åŠ¿&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;GCD æ˜¯è‹¹æœå…¬å¸ä¸º&lt;strong&gt;å¤šæ ¸çš„å¹¶è¡Œè¿ç®—&lt;/strong&gt;æä¾›çš„è§£å†³æ–¹æ¡ˆï¼›&lt;/li&gt;
&lt;li&gt;GCD ä¼šè‡ªåŠ¨åˆ©ç”¨æ›´å¤šçš„CPUå†…æ ¸ï¼ˆæ¯”å¦‚åŒæ ¸ã€å››æ ¸ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;GCD ä¼šè‡ªåŠ¨ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºä»»åŠ¡ã€è°ƒåº¦ä»»åŠ¡ã€é”€æ¯ä»»åŠ¡ï¼‰ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› æ­¤ï¼Œç¨‹åºå‘˜åªéœ€è¦å‘Šè¯‰ GCD æƒ³è¦æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ï¼ŒæŠŠä»»åŠ¡æ”¾åœ¨å¯¹åº”çš„ &lt;code&gt;block&lt;/code&gt; é‡Œé¢ã€‚ä¸éœ€è¦ç¼–å†™ä»»ä½•çº¿ç¨‹ç®¡ç†ä»£ç ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://yoursite.com/categories/iOS/"/>
    
    
      <category term="å¤šçº¿ç¨‹" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="GCD" scheme="http://yoursite.com/tags/GCD/"/>
    
      <category term="å¼‚æ­¥å‡½æ•°" scheme="http://yoursite.com/tags/%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0/"/>
    
      <category term="ä¸²è¡Œ" scheme="http://yoursite.com/tags/%E4%B8%B2%E8%A1%8C/"/>
    
      <category term="å¹¶è¡Œ" scheme="http://yoursite.com/tags/%E5%B9%B6%E8%A1%8C/"/>
    
  </entry>
  
</feed>
